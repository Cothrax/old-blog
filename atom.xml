<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Cothrax</title>
  <subtitle>I don&#39;t need a subtitle.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://cothrax.github.io/"/>
  <updated>2016-09-16T07:58:42.405Z</updated>
  <id>https://cothrax.github.io/</id>
  
  <author>
    <name>Cothrax</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Hexo用原生html伪装复制源码的feature</title>
    <link href="https://cothrax.github.io/2016/09/16/hexo-ways-to-copy-code/"/>
    <id>https://cothrax.github.io/2016/09/16/hexo-ways-to-copy-code/</id>
    <published>2016-09-16T05:39:30.000Z</published>
    <updated>2016-09-16T07:58:42.405Z</updated>
    
    <content type="html"><![CDATA[<h2 id="优化源码复制"><a href="#优化源码复制" class="headerlink" title="优化源码复制"></a>优化源码复制</h2><p>之前在【<a href="/2016/08/12/Hexo初体验/" title="Hexo初体验">Hexo初体验</a>】中提到过<strong>代码复制到剪切板</strong>的替代方案，就是用一个link链接到源码文件，这样做对于一个OIer来说，好处有三：</p>
<ol>
<li>便于管理源码</li>
<li>方便复习模板题</li>
<li><del>显示逼格</del>（雾）<a id="more"></a>
</li>
</ol>
<p>但在代码块外面显示一个蓝色链接实在太丑太直接：</p>
<blockquote>
<img src="/2016/09/16/hexo-ways-to-copy-code/codeblock.jpg" alt="codeblock.jpg" title="">
</blockquote>
<p>于是今天我拿css伪装一下，代码如下：<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&lt;style&gt;</div><div class="line"><span class="code">    .copy&#123;</span></div><div class="line"><span class="code">        position:relative;</span></div><div class="line"><span class="code">        z-index:10;</span></div><div class="line"><span class="code">        color:#000;</span></div><div class="line"><span class="code">        font-size:13px;</span></div><div class="line"><span class="code">        margin:0px 11px -98px 0px;</span></div><div class="line"><span class="code">        text-align:right;</span></div><div class="line"><span class="code">    &#125;</span></div><div class="line"><span class="code">    .copy a&#123;</span></div><div class="line"><span class="code">        color:rgb(153,153,153);</span></div><div class="line"><span class="code">    &#125;</span></div><div class="line">&lt;/style&gt;</div><div class="line">&lt;div&gt;</div><div class="line">&lt;div class="copy"&gt;</div><div class="line"><span class="code">    &#123;% asset_link *.pas &#123;Plain Text&#125; %&#125;</span></div><div class="line">&lt;/div&gt;</div><div class="line">&lt;div&gt;</div><div class="line">&#123;% codeblock lang:delphi *.pas %&#125;</div><div class="line">//code here</div><div class="line">&#123;% endcodeblock %&#125;</div><div class="line">&lt;/div&gt;&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>效果如下：</p>
<blockquote>
<img src="/2016/09/16/hexo-ways-to-copy-code/new.png" alt="new.png" title="">
</blockquote>
<p>写可以把这段css写进<strong>主题的css</strong>里，jacman下就是<code>/home/wd/Hexo/themes/jacman/source/css/_partial/article.styl</code></p>
<p>其实照着这个思路，可以通过直接<strong>插入js</strong>来实现copy to clipboard的函数，有时间再试一试。</p>
<h2 id="我的prob模板"><a href="#我的prob模板" class="headerlink" title="我的prob模板"></a>我的prob模板</h2><p>附一份用来写题解的scaffold以供参考。<br><figure class="highlight markdown"><figcaption><span>prob.md</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line">title: &#123;&#123; title &#125;&#125;</div><div class="line">date: &#123;&#123; date &#125;&#125;</div><div class="line">tags: [OI]</div><div class="line"><span class="section">categories: Problem Set</span></div><div class="line">---</div><div class="line">&lt;style&gt;</div><div class="line"><span class="code">    .copy&#123;</span></div><div class="line"><span class="code">        position:relative;</span></div><div class="line"><span class="code">        z-index:10;</span></div><div class="line"><span class="code">        color:#000;</span></div><div class="line"><span class="code">        font-size:13px;</span></div><div class="line"><span class="code">        margin:0px 11px -98px 0px;</span></div><div class="line"><span class="code">        text-align:right;</span></div><div class="line"><span class="code">    &#125;</span></div><div class="line"><span class="code">    .copy a&#123;</span></div><div class="line"><span class="code">        color:rgb(153,153,153);</span></div><div class="line"><span class="code">    &#125;</span></div><div class="line">&lt;/style&gt;</div><div class="line"><span class="section">## 描述</span></div><div class="line">&lt;!--more--&gt;</div><div class="line"><span class="section">## 格式</span></div><div class="line"><span class="section">### 输入格式</span></div><div class="line"><span class="section">### 输出格式</span></div><div class="line"><span class="section">## 样例</span></div><div class="line"><span class="section">### 样例输入</span></div><div class="line"><span class="quote">&gt;</span></div><div class="line">### 样例输出</div><div class="line"><span class="quote">&gt;</span></div><div class="line">## 提示​</div><div class="line"><span class="section">## 题解</span></div><div class="line">&lt;div&gt;</div><div class="line">&lt;div class="copy"&gt;</div><div class="line"><span class="code">    &#123;% asset_link *.pas &#123;Plain Text&#125; %&#125;</span></div><div class="line">&lt;/div&gt;</div><div class="line">&lt;div&gt;</div><div class="line">&#123;% codeblock lang:delphi *.pas %&#125;</div><div class="line">//code here</div><div class="line">&#123;% endcodeblock %&#125;</div><div class="line">&lt;/div&gt;&lt;/div&gt;</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;优化源码复制&quot;&gt;&lt;a href=&quot;#优化源码复制&quot; class=&quot;headerlink&quot; title=&quot;优化源码复制&quot;&gt;&lt;/a&gt;优化源码复制&lt;/h2&gt;&lt;p&gt;之前在【&lt;a href=&quot;/2016/08/12/Hexo初体验/&quot; title=&quot;Hexo初体验&quot;&gt;Hexo初体验&lt;/a&gt;】中提到过&lt;strong&gt;代码复制到剪切板&lt;/strong&gt;的替代方案，就是用一个link链接到源码文件，这样做对于一个OIer来说，好处有三：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;便于管理源码&lt;/li&gt;
&lt;li&gt;方便复习模板题&lt;/li&gt;
&lt;li&gt;&lt;del&gt;显示逼格&lt;/del&gt;（雾）
    
    </summary>
    
      <category term="Tinkering Note" scheme="https://cothrax.github.io/categories/Tinkering-Note/"/>
    
    
      <category term="Hexo" scheme="https://cothrax.github.io/tags/Hexo/"/>
    
      <category term="Css" scheme="https://cothrax.github.io/tags/Css/"/>
    
      <category term="Html" scheme="https://cothrax.github.io/tags/Html/"/>
    
  </entry>
  
  <entry>
    <title>NOIP模拟赛 打地鼠游戏</title>
    <link href="https://cothrax.github.io/2016/09/15/noip-2014-8-2-mouse/"/>
    <id>https://cothrax.github.io/2016/09/15/noip-2014-8-2-mouse/</id>
    <published>2016-09-15T14:42:22.000Z</published>
    <updated>2016-09-16T05:33:57.518Z</updated>
    
    <content type="html"><![CDATA[<style>
    .copy{
        position:relative;
        z-index:10;
        color:#000;
        font-size:13px;
        margin:0px 11px -98px 0px;
        text-align:right;
    }
    .copy a{
        color:rgb(153,153,153);
    }
</style>

<h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>伟大的2320学长特别喜欢打地鼠游戏，这个游戏开始后，会在地板上冒出一些地鼠来，你可以用榔头去敲击这些地鼠，每个地鼠被敲击后，将会增加相应的游戏分值。可是，所有地鼠只会在地上出现一段时间（而且消失后再也不会出现），每个地鼠都在0时刻冒出，但停留的时间可能是不同的，而且每个地鼠被敲击后增加的游戏分值也可能是不同。<br>最近2320学长经常玩这个游戏，以至于敲击每个地鼠只要1秒。他在想如何敲击能使总分最大。<br><a id="more"></a></p>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p>输入包含3行，第一行包含一个整数n（1&lt;=n&lt;=100000）表示有n个地鼠从地上冒出来，第二行n个用空格分隔的整数表示每个地鼠冒出后停留的时间（Maxt&lt;=50000），第三行n个用空格分隔的整数表示每个地鼠被敲击后会增加的分值v（v&lt;=1000）。每行中第i个数都表示第i个地鼠的信息。</p>
<h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p>一个整数，最大分值。</p>
<h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>5<br>5 3 6 1 4<br>7 9 2 1 5</p>
</blockquote>
<h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>24</p>
</blockquote>
<h2 id="提示​"><a href="#提示​" class="headerlink" title="提示​"></a>提示​</h2><p>30%的数据保证n&lt;=100, t&lt;=500,v&lt;=50<br>60%的数据保证 n&lt;=10000,t&lt;=3000,v&lt;=500<br>100%的数据保证 n&lt;=100000,t&lt;=5000,v&lt;=1000</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>以前在codevs上做过这道题，因为数据小写了背包</p>
<div><br><div class="copy"><br>    <a href="/2016/09/15/noip-2014-8-2-mouse/7166.pas" title="{Plain Text}">{Plain Text}</a><br></div><br><div><br><figure class="highlight delphi"><figcaption><span>7166.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    n,m,i,j,ans:longint;</div><div class="line">    t,w:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">101</span>] <span class="keyword">of</span> longint;</div><div class="line">    f:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">1010</span>] <span class="keyword">of</span> longint;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">qsort</span><span class="params">(b,e:longint)</span>;</span></div><div class="line"><span class="keyword">var</span> i,j,x,tmp:longint;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    i:=b;j:=e;x:=t[random(e-b)+b];</div><div class="line">    <span class="keyword">repeat</span></div><div class="line">        <span class="keyword">while</span> t[i]&lt;x <span class="keyword">do</span> inc(i);</div><div class="line">        <span class="keyword">while</span> t[j]&gt;x <span class="keyword">do</span> dec(j);</div><div class="line">        <span class="keyword">if</span> i&lt;=j <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            tmp:=t[i];t[i]:=t[j];t[j]:=tmp;</div><div class="line">            tmp:=w[i];w[i]:=w[j];w[j]:=tmp;</div><div class="line">            inc(i);dec(j);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">until</span> i&gt;j;</div><div class="line">    <span class="keyword">if</span> i&lt;e <span class="keyword">then</span> qsort(i,e);</div><div class="line">    <span class="keyword">if</span> b&lt;j <span class="keyword">then</span> qsort(b,j);</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">read</span>(n);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">read</span>(t[i]);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">read</span>(w[i]);</div><div class="line">    qsort(<span class="number">1</span>,n);m:=t[n];</div><div class="line">    fillchar(f,sizeof(f),<span class="number">0</span>);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span></div><div class="line">        <span class="keyword">for</span> j:=t[i] <span class="keyword">downto</span> <span class="number">1</span> <span class="keyword">do</span></div><div class="line">            f[j]:=max(f[j],f[j-<span class="number">1</span>]+w[i]);</div><div class="line">    ans:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> m <span class="keyword">do</span> ans:=max(ans,f[i]);</div><div class="line">    <span class="keyword">write</span>(ans);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure><br><br></div></div>

<p>但这次数据比较大，于是有两种贪心的思路</p>
<ul>
<li>按价值降序排列，1..n遍历，对于一个地鼠i，从t[i]..1遍历一遍，如果找到没有用过的1秒，用这1秒打这只地鼠。<br>但最坏复杂度为$O(maxT\cdot n)$，与dp相同</li>
</ul>
<div><br><div class="copy"><br>    <a href="/2016/09/15/noip-2014-8-2-mouse/mouse_che.pas" title="{Plain Text}">{Plain Text}</a><br></div><br><div><br><figure class="highlight delphi"><figcaption><span>mouse_che.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    a,t:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">100010</span>] <span class="keyword">of</span> int;</div><div class="line">    used:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">50010</span>] <span class="keyword">of</span> boolean;</div><div class="line">    n,i,j:int;ans:int64;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">swap</span><span class="params">(<span class="keyword">var</span> a,b:int)</span>;</span></div><div class="line"><span class="keyword">var</span> tmp:int;</div><div class="line"><span class="keyword">begin</span> tmp:=a;a:=b;b:=tmp <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">qsort</span><span class="params">(l,r:int)</span>;</span></div><div class="line"><span class="keyword">var</span> i,j,x:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    i:=l;j:=r;x:=a[random(r-l)+r];</div><div class="line">    <span class="keyword">repeat</span></div><div class="line">        <span class="keyword">while</span> a[i]&gt;x <span class="keyword">do</span> inc(i);</div><div class="line">        <span class="keyword">while</span> a[j]&lt;x <span class="keyword">do</span> dec(j);</div><div class="line">        <span class="keyword">if</span> i&lt;=j <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            swap(t[i],t[j]);swap(a[i],a[j]);</div><div class="line">            inc(i);dec(j);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">until</span> i&gt;j;</div><div class="line">    <span class="keyword">if</span> i&lt;r <span class="keyword">then</span> qsort(i,r);</div><div class="line">    <span class="keyword">if</span> l&lt;j <span class="keyword">then</span> qsort(l,j);</div><div class="line"><span class="keyword">end</span>;</div><div class="line">    </div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'mouse.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'mouse.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">read</span>(t[i]);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">read</span>(a[i]);</div><div class="line">    qsort(<span class="number">1</span>,n);ans:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        j:=t[i];</div><div class="line">        <span class="keyword">while</span> (j&gt;<span class="number">0</span>) <span class="keyword">and</span> used[j] <span class="keyword">do</span> dec(j);</div><div class="line">        <span class="keyword">if</span> j&lt;&gt;<span class="number">0</span> <span class="keyword">then</span> <span class="keyword">begin</span> </div><div class="line">            inc(ans,a[i]);used[j]:=true;</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">write</span>(ans);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure><br><br></div></div>

<ul>
<li>按时间升序排列地鼠，1..n遍历，打地鼠并统计个数，如果个数超过当前时间，删除已打的地鼠中价值最小的，可以用堆维护。<br>复杂度为$O(NlogN)$</li>
</ul>
<div><br><div class="copy"><br>    <a href="/2016/09/15/noip-2014-8-2-mouse/mouse.pas" title="{Plain Text}">{Plain Text}</a><br></div><br><div><br><figure class="highlight delphi"><figcaption><span>mouse.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">var</span></div><div class="line">    n,sz,i,cnt:int;ans:int64;</div><div class="line">    a,t:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">100010</span>] <span class="keyword">of</span> int;</div><div class="line">    h:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">200010</span>] <span class="keyword">of</span> int;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">swap</span><span class="params">(<span class="keyword">var</span> a,b:int)</span>;</span></div><div class="line"><span class="keyword">var</span> tmp:int;</div><div class="line"><span class="keyword">begin</span> tmp:=a;a:=b;b:=tmp <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">heapify</span><span class="params">(i:int)</span>;</span></div><div class="line"><span class="keyword">var</span> l,r,s:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    l:=i*<span class="number">2</span>;r:=i*<span class="number">2</span>+<span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span> (l&lt;=sz) <span class="keyword">and</span> (h[l]&lt;h[i]) <span class="keyword">then</span> s:=l <span class="keyword">else</span> s:=i;</div><div class="line">    <span class="keyword">if</span> (r&lt;=sz) <span class="keyword">and</span> (h[r]&lt;h[s]) <span class="keyword">then</span> s:=r;</div><div class="line">    <span class="keyword">if</span> i&lt;&gt;s <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">        swap(h[i],h[s]);heapify(s);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">extract</span><span class="params">()</span>:</span>int;</div><div class="line"><span class="keyword">begin</span> extract:=h[<span class="number">1</span>];h[<span class="number">1</span>]:=h[sz];dec(sz);heapify(<span class="number">1</span>) <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">insert</span><span class="params">(x:int)</span>;</span></div><div class="line"><span class="keyword">var</span> i:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    inc(sz);h[sz]:=x;i:=sz;</div><div class="line">    <span class="keyword">while</span> (i&gt;<span class="number">1</span>) <span class="keyword">and</span> (h[i]&lt;h[i <span class="keyword">shr</span> <span class="number">1</span>]) <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        swap(h[i],h[i <span class="keyword">shr</span> <span class="number">1</span>]);i:=i <span class="keyword">shr</span> <span class="number">1</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">qsort</span><span class="params">(l,r:int)</span>;</span></div><div class="line"><span class="keyword">var</span> i,j,x:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    i:=l;j:=r;x:=t[random(r-l)+l];</div><div class="line">    <span class="keyword">repeat</span></div><div class="line">        <span class="keyword">while</span> t[i]&lt;x <span class="keyword">do</span> inc(i);</div><div class="line">        <span class="keyword">while</span> t[j]&gt;x <span class="keyword">do</span> dec(j);</div><div class="line">        <span class="keyword">if</span> i&lt;=j <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            swap(t[i],t[j]);swap(a[i],a[j]);</div><div class="line">            inc(i);dec(j);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">until</span> i&gt;j;</div><div class="line">    <span class="keyword">if</span> i&lt;r <span class="keyword">then</span> qsort(i,r);</div><div class="line">    <span class="keyword">if</span> l&lt;j <span class="keyword">then</span> qsort(l,j);</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'mouse.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'mouse.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">read</span>(t[i]);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">read</span>(a[i]);</div><div class="line">    qsort(<span class="number">1</span>,n);</div><div class="line">    sz:=<span class="number">0</span>;cnt:=<span class="number">0</span>;ans:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        inc(cnt);inc(ans,a[i]);insert(a[i]);</div><div class="line">        <span class="keyword">while</span> cnt&gt;t[i] <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">            dec(cnt);dec(ans,extract);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">write</span>(ans);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure><br><br></div></div>
]]></content>
    
    <summary type="html">
    
      &lt;style&gt;
    .copy{
        position:relative;
        z-index:10;
        color:#000;
        font-size:13px;
        margin:0px 11px -98px 0px;
        text-align:right;
    }
    .copy a{
        color:rgb(153,153,153);
    }
&lt;/style&gt;

&lt;h2 id=&quot;描述&quot;&gt;&lt;a href=&quot;#描述&quot; class=&quot;headerlink&quot; title=&quot;描述&quot;&gt;&lt;/a&gt;描述&lt;/h2&gt;&lt;p&gt;伟大的2320学长特别喜欢打地鼠游戏，这个游戏开始后，会在地板上冒出一些地鼠来，你可以用榔头去敲击这些地鼠，每个地鼠被敲击后，将会增加相应的游戏分值。可是，所有地鼠只会在地上出现一段时间（而且消失后再也不会出现），每个地鼠都在0时刻冒出，但停留的时间可能是不同的，而且每个地鼠被敲击后增加的游戏分值也可能是不同。&lt;br&gt;最近2320学长经常玩这个游戏，以至于敲击每个地鼠只要1秒。他在想如何敲击能使总分最大。&lt;br&gt;
    
    </summary>
    
      <category term="Problem Set" scheme="https://cothrax.github.io/categories/Problem-Set/"/>
    
    
      <category term="OI" scheme="https://cothrax.github.io/tags/OI/"/>
    
      <category term="数据结构" scheme="https://cothrax.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="DP" scheme="https://cothrax.github.io/tags/DP/"/>
    
      <category term="堆" scheme="https://cothrax.github.io/tags/%E5%A0%86/"/>
    
      <category term="贪心" scheme="https://cothrax.github.io/tags/%E8%B4%AA%E5%BF%83/"/>
    
  </entry>
  
  <entry>
    <title>NOIP模拟赛 交通</title>
    <link href="https://cothrax.github.io/2016/09/15/noip-2014-9-27-traffic/"/>
    <id>https://cothrax.github.io/2016/09/15/noip-2014-9-27-traffic/</id>
    <published>2016-09-15T12:55:31.000Z</published>
    <updated>2016-09-16T05:30:19.825Z</updated>
    
    <content type="html"><![CDATA[<style>
    .copy{
        position:relative;
        z-index:10;
        color:#000;
        font-size:13px;
        margin:0px 11px -98px 0px;
        text-align:right;
    }
    .copy a{
        color:rgb(153,153,153);
    }
</style>


<h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>黄金大神国的首都位于hzwer河中的一座岛屿。一道上班的时候，成千上万辆汽车通过岛屿从西岸的住宅区（由桥连接岛的西部）到东岸的工业区（由桥连接岛的东部）。<br>该岛类似于矩形，它的边平行于主方向。故可将它看作是笛卡尔坐标系中的一个A*B的矩形，它的对角分别为（0, 0）和（A, B）。<br>岛上有n个交通节点（后宫建筑），编号为1…n，第i个节点坐标为(xi, yi)。如果一个节点的坐标为(0, y)，它就位于岛的西岸。类似的，坐标为(A, y)的节点位于岛的东岸。各个节点由街道连接，每条街道用线段连接两个节点。街道有单向行驶或双向行驶之分。除端点外任意两条街道都没有公共点。也没有桥梁或者隧道。<br>你不能对道路网络形状做任何其他假设。沿河岸的街道或节点可能没有入口或者出口街道。由于交通堵塞日趋严重，黄金大神想快速治理好他的国家，于是聘请你测试岛上当前的道路网是否足够。要求你写一个程序确定从岛的西岸的每个节点能够到达东岸的多少个节点。<br><a id="more"></a></p>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p>第1行包含4个整数n, m, A, B，分别表示hzwer市中心的节点数，街道数和岛屿的尺寸。<br>接下来的n行，每行包含两个整数xi，yi (0≤xi≤A,0≤yi≤B)，表示第i个节点的坐标。任意两个节点的坐标都不相同。<br>再往下的m行表示街道，每条街道用3个整数ci, di, ki（1≤ci, di≤n, ci≠di, ki∈{1,2}），表示节点ci、di有街道连接，如果ki=1,表示从ci到di的街道是单向的，否则，这条街道可以双向行驶。每个无序对{ci, di}最多出现1次。<br>你可以假设西岸节点中至少有1个能够到达东岸的一些节点。</p>
<h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p>为每个西岸节点输出1行，表示这个节点出发能够到达东岸的节点数目</p>
<h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>12 13 7 9<br>0 1<br>0 3<br>2 2<br>5 2<br>7 1<br>7 4<br>7 6<br>7 7<br>3 5<br>0 5<br>0 9<br>3 9<br>1 3 2<br>3 2 1<br>3 4 1<br>4 5 1<br>5 6 1<br>9 3 1<br>9 4 1<br>9 7 1<br>9 12 2<br>10 9 1<br>11 12 1<br>12 8 1<br>12 10 1</p>
</blockquote>
<h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>4<br>4<br>0<br>2</p>
</blockquote>
<h2 id="提示​"><a href="#提示​" class="headerlink" title="提示​"></a>提示​</h2><p>对于30%的数据，n, m≤6000<br>对于100%的数据，1≤n≤300000, 0≤m≤900000,1≤A,B≤10^9<br><img src="/2016/09/15/noip-2014-9-27-traffic/illu.png" alt="illu.png" title=""></p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>第一遍看题目，发现除了两边的点以外的坐标毫无用处，然后yy缩点+各种数据结构的启发式合并，然后果断看了标程。<br>其实这个图的形式正是本题的关键所在：</p>
<blockquote>
<p>除端点外任意两条街道都没有公共点。也没有桥梁或者隧道。</p>
</blockquote>
<p>这是一个<strong>平面图</strong>：</p>
<blockquote>
<p>在图论中，平面图是可以画在平面上并且使得不同的边可以互不交叠的图。–Wikipedia</p>
</blockquote>
<p>先从西岸正向bfs，标记所有从西岸可达的点；对于可达点i，d[i]=1<br>考虑西岸的一个点i，记它能到达的东岸上最北边的点为u[i]，最南边的点为d[i]，那么，那么点i能够到达<strong>东岸上$y_j\in[y_{d[i]},y_{u[i]}]\ and\ d[j]=1$的所有点j</strong>：</p>
<blockquote>
<p>由于图上的边不能相交，<em>边i-&gt;u[i]</em>,<em>边i-&gt;d[i]</em>和<em>东岸</em>构成了一个封闭的三角形，位于其中的点j想与外界联通，必然要经过<span>$\{i,(a,d[i]),(a,u[i])\}$</span><!-- Has MathJax -->中的点，即与i连通<br>所以将东岸的点排序后，反向bfs，做两次标记算出d[i]和u[i]即可。</p>
</blockquote>
<p>平面图还有一些奇怪的性质，详见<a href="https://en.wikipedia.org/wiki/Planar_graph" target="_blank" rel="external">Wikipedia</a></p>
<div><br><div class="copy"><br>    <a href="/2016/09/15/noip-2014-9-27-traffic/traffic0.pas" title="{Plain Text}">{Plain Text}</a><br></div><br><div><br><figure class="highlight delphi"><figcaption><span>traffic0.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> </div><div class="line">    int=longint;</div><div class="line">    edge=<span class="keyword">record</span> f,t,next:int <span class="keyword">end</span>;</div><div class="line">    arr=<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">300010</span>] <span class="keyword">of</span> int;</div><div class="line"><span class="keyword">var</span></div><div class="line">    g:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">2000010</span>] <span class="keyword">of</span> edge;</div><div class="line">    l,r,u,d,x,y,head,q:arr;</div><div class="line">    n,m,i,j,f,t,a,b:int;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">add</span><span class="params">(f,t:int)</span>;</span></div><div class="line"><span class="keyword">var</span> m:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    inc(head[<span class="number">0</span>]);m:=head[<span class="number">0</span>];</div><div class="line">    g[m].f:=f;g[m].t:=t;</div><div class="line">    g[m].next:=head[f];head[f]:=m;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">swap</span><span class="params">(<span class="keyword">var</span> a,b:int)</span>;</span></div><div class="line"><span class="keyword">var</span> tmp:int;</div><div class="line"><span class="keyword">begin</span> tmp:=a;a:=b;b:=tmp <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">com</span><span class="params">(a,b,s:int)</span>:</span>boolean;</div><div class="line"><span class="keyword">begin</span> com:=((s=<span class="number">0</span>) <span class="keyword">and</span> (a&lt;b)) <span class="keyword">or</span> ((s=<span class="number">1</span>) <span class="keyword">and</span> (a&gt;b)) <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">qsort</span><span class="params">(<span class="keyword">var</span> a:arr;l,r,s:int)</span>;</span></div><div class="line"><span class="keyword">var</span> i,j,x:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    i:=l;j:=r;x:=y[a[random(r-l)+l]];</div><div class="line">    <span class="keyword">repeat</span></div><div class="line">        <span class="keyword">while</span> com(y[a[i]],x,s) <span class="keyword">do</span> inc(i);</div><div class="line">        <span class="keyword">while</span> com(x,y[a[j]],s) <span class="keyword">do</span> dec(j);</div><div class="line">        <span class="keyword">if</span> i&lt;=j <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            swap(a[i],a[j]);</div><div class="line">            inc(i);dec(j);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">until</span> i&gt;j;</div><div class="line">    <span class="keyword">if</span> i&lt;r <span class="keyword">then</span> qsort(a,i,r,s);</div><div class="line">    <span class="keyword">if</span> l&lt;j <span class="keyword">then</span> qsort(a,l,j,s);</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">bfs</span><span class="params">(<span class="keyword">var</span> d:arr;s,k:int)</span>;</span></div><div class="line"><span class="keyword">var</span> i,v,u,h,t:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    h:=<span class="number">1</span>;t:=<span class="number">2</span>;q[h]:=s;d[s]:=k;</div><div class="line">    <span class="keyword">while</span> h&lt;&gt;t <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        v:=q[h];inc(h);i:=head[v];</div><div class="line">        <span class="keyword">while</span> i&lt;&gt;<span class="number">0</span> <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">            u:=g[i].t;</div><div class="line">            <span class="keyword">if</span> d[u]=-<span class="number">1</span> <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">                d[u]:=k;</div><div class="line">                q[t]:=u;inc(t);</div><div class="line">            <span class="keyword">end</span>;</div><div class="line">            i:=g[i].next;</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">cal</span><span class="params">(<span class="keyword">var</span> d:arr)</span>;</span></div><div class="line"><span class="keyword">var</span> j:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    fillchar(d,sizeof(d),<span class="number">255</span>);</div><div class="line">    <span class="keyword">for</span> j:=<span class="number">1</span> <span class="keyword">to</span> r[<span class="number">0</span>] <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">if</span> d[r[j]]&lt;&gt;-<span class="number">1</span> <span class="keyword">then</span> continue;</div><div class="line">        bfs(d,r[j],j);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'traffic.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'traffic.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n,m,a,b);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">read</span>(x[i],y[i]);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> m <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(f,t,j);</div><div class="line">        add(f,t);<span class="keyword">if</span> j=<span class="number">2</span> <span class="keyword">then</span> add(t,f);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span></div><div class="line">        <span class="keyword">if</span> x[i]=<span class="number">0</span> <span class="keyword">then</span> <span class="keyword">begin</span> inc(l[<span class="number">0</span>]);l[l[<span class="number">0</span>]]:=i <span class="keyword">end</span>;</div><div class="line">    qsort(l,<span class="number">1</span>,l[<span class="number">0</span>],<span class="number">1</span>);</div><div class="line">    fillchar(d,sizeof(d),<span class="number">255</span>);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> l[<span class="number">0</span>] <span class="keyword">do</span> </div><div class="line">        <span class="keyword">if</span> d[l[i]]=-<span class="number">1</span> <span class="keyword">then</span> bfs(d,l[i],<span class="number">1</span>);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span></div><div class="line">        <span class="keyword">if</span> (x[i]=a) <span class="keyword">and</span> (d[i]=<span class="number">1</span>) <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            inc(r[<span class="number">0</span>]);r[r[<span class="number">0</span>]]:=i;</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    m:=head[<span class="number">0</span>];</div><div class="line">    fillchar(head,sizeof(head),<span class="number">0</span>);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> m <span class="keyword">do</span> add(g[i].t,g[i].f);</div><div class="line">    qsort(r,<span class="number">1</span>,r[<span class="number">0</span>],<span class="number">0</span>);cal(d);</div><div class="line">    qsort(r,<span class="number">1</span>,r[<span class="number">0</span>],<span class="number">1</span>);cal(u);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> l[<span class="number">0</span>] <span class="keyword">do</span></div><div class="line">        <span class="keyword">if</span> u[l[i]]=-<span class="number">1</span> <span class="keyword">then</span> writeln(<span class="number">0</span>)</div><div class="line">        <span class="keyword">else</span> writeln(r[<span class="number">0</span>]-u[l[i]]+<span class="number">2</span>-d[l[i]]);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure><br><br></div></div>
]]></content>
    
    <summary type="html">
    
      &lt;style&gt;
    .copy{
        position:relative;
        z-index:10;
        color:#000;
        font-size:13px;
        margin:0px 11px -98px 0px;
        text-align:right;
    }
    .copy a{
        color:rgb(153,153,153);
    }
&lt;/style&gt;


&lt;h2 id=&quot;描述&quot;&gt;&lt;a href=&quot;#描述&quot; class=&quot;headerlink&quot; title=&quot;描述&quot;&gt;&lt;/a&gt;描述&lt;/h2&gt;&lt;p&gt;黄金大神国的首都位于hzwer河中的一座岛屿。一道上班的时候，成千上万辆汽车通过岛屿从西岸的住宅区（由桥连接岛的西部）到东岸的工业区（由桥连接岛的东部）。&lt;br&gt;该岛类似于矩形，它的边平行于主方向。故可将它看作是笛卡尔坐标系中的一个A*B的矩形，它的对角分别为（0, 0）和（A, B）。&lt;br&gt;岛上有n个交通节点（后宫建筑），编号为1…n，第i个节点坐标为(xi, yi)。如果一个节点的坐标为(0, y)，它就位于岛的西岸。类似的，坐标为(A, y)的节点位于岛的东岸。各个节点由街道连接，每条街道用线段连接两个节点。街道有单向行驶或双向行驶之分。除端点外任意两条街道都没有公共点。也没有桥梁或者隧道。&lt;br&gt;你不能对道路网络形状做任何其他假设。沿河岸的街道或节点可能没有入口或者出口街道。由于交通堵塞日趋严重，黄金大神想快速治理好他的国家，于是聘请你测试岛上当前的道路网是否足够。要求你写一个程序确定从岛的西岸的每个节点能够到达东岸的多少个节点。&lt;br&gt;
    
    </summary>
    
      <category term="Problem Set" scheme="https://cothrax.github.io/categories/Problem-Set/"/>
    
    
      <category term="OI" scheme="https://cothrax.github.io/tags/OI/"/>
    
      <category term="BFS" scheme="https://cothrax.github.io/tags/BFS/"/>
    
      <category term="图论" scheme="https://cothrax.github.io/tags/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="平面图" scheme="https://cothrax.github.io/tags/%E5%B9%B3%E9%9D%A2%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>NOIP模拟赛 人偶师</title>
    <link href="https://cothrax.github.io/2016/09/15/noip-2014-9-27-alice/"/>
    <id>https://cothrax.github.io/2016/09/15/noip-2014-9-27-alice/</id>
    <published>2016-09-15T09:18:05.000Z</published>
    <updated>2016-09-15T09:46:02.356Z</updated>
    
    <content type="html"><![CDATA[<h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>n点m双向边的图，每个点有2个状态：开和关。每次操作改变一个点的状态，以及与其有边直接相连的点的状态。问开启所有点至少需要多少次操作。<br><a id="more"></a></p>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p>第一行2个整数n,m。<br>第二行n个整数，第i个数表示第i点的状态，0为关，1为开。<br>第3..m+2行，每行2个整数a,b，表示a和b直接相连，同一条边不会出现多次。</p>
<h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p>第一行一个整数k表示最少的操作次数，所有数据保证至少有一组可行解。<br>第二行k个整数，表示操作的点的编号。</p>
<h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>4 3<br>1 1 0 0<br>2 3<br>1 3<br>2 4</p>
</blockquote>
<h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>3<br>1 2 3</p>
</blockquote>
<h2 id="提示​"><a href="#提示​" class="headerlink" title="提示​"></a>提示​</h2><p>对于30%的数据，1&lt;=n&lt;=10，0&lt;=m&lt;=40<br>对于60%的数据，1&lt;=n&lt;=30，0&lt;=m&lt;=100<br>对于100%的数据，1&lt;=n&lt;=40，0&lt;=m&lt;=500</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>图上的反转问题，可以联想到如下题目：</p>
<ol>
<li>最小权匹配（状压dp）：<a href="/2016/09/04/欢乐赛-2014-5-31/" title="P3密码锁">P3密码锁</a></li>
<li>部分枚举+贪心：<a href="/2016/08/25/POJ-P3279-Fliptile/" title="关灯游戏">关灯游戏</a></li>
<li>状压dp：<a href="/2016/08/17/JSOI2016-提高2班-位运算/" title="P4黑客的攻击">P4黑客的攻击</a></li>
<li><del>这是线段树：<a href="/2016/08/22/JSOI2016-提高1班-Day6/" title="P3小W开关灯">P3小W开关灯</a></del></li>
</ol>
<p>关于本题，由n≤40<del>很容易</del>是<strong>折半枚举</strong>。<br>方案和状态可以压成int64，于是可以用位运算优化。<br>用hash拉链存第一次dfs的结果，然后第二次反过来dfs。<br>还有就是pascal的一个坑，下面程序的输出结果是-2147483648<br><figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">var</span> i,a:int64;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    i:=<span class="number">31</span>;a:=<span class="number">1</span> <span class="keyword">shl</span> i;</div><div class="line">    <span class="keyword">write</span>(a);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure></p>
<p>原因是shl操作时默认参数1为longint，所以会发生溢出，要强转<code>a:=int64(1) shl int64(i)</code>，参考了<a href="https://stackoverflow.com/questions/8127693/how-can-i-get-a-result-larger-than-232-from-shl" target="_blank" rel="external">stackoverflow</a></p>
<dir style="text-align:right"><a href="/2016/09/15/noip-2014-9-27-alice/alice.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>alice.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">const</span> z=<span class="number">500009</span>;</div><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">var</span></div><div class="line">    h,f:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">1500010</span>] <span class="keyword">of</span> int64;</div><div class="line">    c,next:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">1500010</span>] <span class="keyword">of</span> int;</div><div class="line">    head:<span class="keyword">array</span>[<span class="number">0</span>..z] <span class="keyword">of</span> int;</div><div class="line">    g:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">41</span>] <span class="keyword">of</span> int64;</div><div class="line">    i,j,k,n,m,sz,cnt,mn:int;lb,h0,f0,ans:int64;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">lsh</span><span class="params">(a,b:int64)</span>:</span>int64;</div><div class="line"><span class="keyword">begin</span> lsh:=int64(a) <span class="keyword">shl</span> int64(b) <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">insert</span><span class="params">(h0,f0:int64;cnt:int)</span>;</span></div><div class="line"><span class="keyword">var</span> i:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    i:=h0 <span class="keyword">mod</span> z;</div><div class="line">    inc(sz);h[sz]:=h0;f[sz]:=f0;c[sz]:=cnt;</div><div class="line">    next[sz]:=head[i];head[i]:=sz;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">query</span><span class="params">(h0:int64)</span>:</span>int;</div><div class="line"><span class="keyword">var</span> i:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    i:=h0 <span class="keyword">mod</span> z;i:=head[i];</div><div class="line">    <span class="keyword">while</span> i&lt;&gt;<span class="number">0</span> <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">if</span> h0=h[i] <span class="keyword">then</span> <span class="keyword">exit</span>(i);</div><div class="line">        i:=next[i];</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    query:=-<span class="number">1</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">print</span><span class="params">(ans:int64)</span>;</span></div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">while</span> ans&lt;&gt;<span class="number">0</span> <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        lb:=ans <span class="keyword">and</span> (-ans);</div><div class="line">        <span class="keyword">write</span>(round(ln(lb)/ln(<span class="number">2</span>))+<span class="number">1</span>,<span class="string">' '</span>);</div><div class="line">        dec(ans,lb);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">dfs</span><span class="params">(v,x:int)</span>;</span></div><div class="line"><span class="keyword">var</span> i:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">if</span> (x=<span class="number">0</span>) <span class="keyword">and</span> (v=k+<span class="number">1</span>) <span class="keyword">then</span> <span class="keyword">begin</span> insert(h0,f0,cnt);<span class="keyword">exit</span> <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">if</span> (x=<span class="number">1</span>) <span class="keyword">and</span> (v=n+<span class="number">1</span>) <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">        i:=query(h0);</div><div class="line">        <span class="keyword">if</span> (i&lt;&gt;-<span class="number">1</span>) <span class="keyword">and</span> (c[i]+cnt&lt;mn) <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            mn:=c[i]+cnt;</div><div class="line">            ans:=f[i] <span class="keyword">or</span> f0;</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">        <span class="keyword">exit</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    h0:=h0 xor g[v];f0:=f0 <span class="keyword">or</span> lsh(<span class="number">1</span>,v-<span class="number">1</span>);inc(cnt);</div><div class="line">    dfs(v+<span class="number">1</span>,x);</div><div class="line">    h0:=h0 xor g[v];f0:=f0-lsh(<span class="number">1</span>,v-<span class="number">1</span>);dec(cnt);</div><div class="line">    dfs(v+<span class="number">1</span>,x);</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span> <span class="comment">&#123;main&#125;</span></div><div class="line">    assign(input,<span class="string">'alice.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'alice.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n,m);h0:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(j);inc(h0,lsh(<span class="number">1</span>,i-<span class="number">1</span>)*j);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> g[i]:=lsh(<span class="number">1</span>,i-<span class="number">1</span>);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> m <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(j,k);</div><div class="line">        inc(g[j],lsh(<span class="number">1</span>,k-<span class="number">1</span>));</div><div class="line">        inc(g[k],lsh(<span class="number">1</span>,j-<span class="number">1</span>));</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    k:=n <span class="keyword">shr</span> <span class="number">1</span>;f0:=<span class="number">0</span>;cnt:=<span class="number">0</span>;sz:=<span class="number">0</span>;</div><div class="line">    dfs(<span class="number">1</span>,<span class="number">0</span>);</div><div class="line">    h0:=lsh(<span class="number">1</span>,n)-<span class="number">1</span>;f0:=<span class="number">0</span>;cnt:=<span class="number">0</span>;mn:=maxlongint;</div><div class="line">    dfs(k+<span class="number">1</span>,<span class="number">1</span>);</div><div class="line">    </div><div class="line">    writeln(mn);print(ans);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;描述&quot;&gt;&lt;a href=&quot;#描述&quot; class=&quot;headerlink&quot; title=&quot;描述&quot;&gt;&lt;/a&gt;描述&lt;/h2&gt;&lt;p&gt;n点m双向边的图，每个点有2个状态：开和关。每次操作改变一个点的状态，以及与其有边直接相连的点的状态。问开启所有点至少需要多少次操作。&lt;br&gt;
    
    </summary>
    
      <category term="Problem Set" scheme="https://cothrax.github.io/categories/Problem-Set/"/>
    
    
      <category term="OI" scheme="https://cothrax.github.io/tags/OI/"/>
    
      <category term="数据结构" scheme="https://cothrax.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="折半枚举" scheme="https://cothrax.github.io/tags/%E6%8A%98%E5%8D%8A%E6%9E%9A%E4%B8%BE/"/>
    
      <category term="Hash" scheme="https://cothrax.github.io/tags/Hash/"/>
    
      <category term="位运算" scheme="https://cothrax.github.io/tags/%E4%BD%8D%E8%BF%90%E7%AE%97/"/>
    
  </entry>
  
  <entry>
    <title>NOIP模拟赛 舞蹈课</title>
    <link href="https://cothrax.github.io/2016/09/15/noip-2014-9-13-dancingLessons/"/>
    <id>https://cothrax.github.io/2016/09/15/noip-2014-9-13-dancingLessons/</id>
    <published>2016-09-15T02:18:52.000Z</published>
    <updated>2016-09-15T02:46:17.580Z</updated>
    
    <content type="html"><![CDATA[<h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>有 n 个人参加一个舞蹈课。每个人的舞蹈技术由整数 来决定。在舞蹈课的开始,他们从左到右站成一排。当这一排中至少有一对相邻的异性时,舞蹈技术相差最小的那一对会出列并开始跳舞。如果相差最小的不止一对,那么最左边的那一对出列。一对异性出列之后,队伍中的空白按原顺序补上(即:若队伍为 ABCD,那么 BC 出列之后队伍变为 AD)。舞蹈技术相差最小即是 的绝对值最小。<br>你的任务是,模拟以上过程,确定跳舞的配对及顺序。<br><a id="more"></a></p>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p>第一行为正整数n(1≤n≤2*10e5):队伍中的人数。下一行包含 n 个字<br>符 B 或者 G,B 代表男,G 代表女。下一行为 n 个整数ai(ai≤10e7)有信息按照从左到右的顺序给出。</p>
<h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p>第一行:出列的总对数 k。接下来输出 k 行,每行是两个整数。按跳舞顺序输出,两个整数代表这一对舞伴的编号(按输入顺序从左往右 1 至 n 编号)。请先输出较小的整数,再输出较大的整数。</p>
<h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>4<br>BGBG<br>4 2 4 3</p>
</blockquote>
<h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>2<br>3 4<br>1 2</p>
</blockquote>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>用堆维护最小值，元素的删除用链表维护。<br>关于最小堆中任意元素的删除：</p>
<ol>
<li>将该元素的值设成inf，然后heapify</li>
<li>注意在维护下标映射时，不考虑值为inf的元素</li>
<li>如果堆的size=0或堆顶元素为inf，则已经为空</li>
</ol>
<dir style="text-align:right"><a href="/2016/09/15/noip-2014-9-13-dancingLessons/dancingLessons.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>classroomLessons.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">const</span> inf=maxlongint <span class="keyword">shr</span> <span class="number">2</span>;</div><div class="line"><span class="keyword">type</span> </div><div class="line">    int=longint;</div><div class="line">    nh=<span class="keyword">record</span> l,r,d:int <span class="keyword">end</span>;</div><div class="line">    nl=<span class="keyword">record</span> l,r:int <span class="keyword">end</span>;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    hp:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">200010</span>] <span class="keyword">of</span> nh;</div><div class="line">    lk:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">200010</span>] <span class="keyword">of</span> nl;</div><div class="line">    lh,a:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">200010</span>] <span class="keyword">of</span> int;</div><div class="line">    g:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">200010</span>] <span class="keyword">of</span> char;</div><div class="line">    ans:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">100010</span>,<span class="number">0</span>..<span class="number">1</span>] <span class="keyword">of</span> int;</div><div class="line">    n,i,sh,cnt,l1,r1,l2,r2:int;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">swap</span><span class="params">(i,j:int)</span>;</span></div><div class="line"><span class="keyword">var</span> tmp:nh;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">if</span> hp[i].d&lt;&gt;inf <span class="keyword">then</span> lh[hp[i].l]:=j;</div><div class="line">    <span class="keyword">if</span> hp[j].d&lt;&gt;inf <span class="keyword">then</span> lh[hp[j].l]:=i;</div><div class="line">    tmp:=hp[i];hp[i]:=hp[j];hp[j]:=tmp;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">com</span><span class="params">(p,c:int)</span>:</span>boolean;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    com:=(hp[p].d&lt;hp[c].d) <span class="keyword">or</span> </div><div class="line">        ((hp[p].d=hp[c].d) <span class="keyword">and</span> (hp[p].l&lt;hp[c].l));</div><div class="line"><span class="keyword">end</span>;</div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">heapify</span><span class="params">(i:int)</span>;</span></div><div class="line"><span class="keyword">var</span> l,r,s:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    l:=i <span class="keyword">shl</span> <span class="number">1</span>;r:=l <span class="keyword">or</span> <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span> (l&lt;=sh) <span class="keyword">and</span> com(l,i) <span class="keyword">then</span> s:=l <span class="keyword">else</span> s:=i;</div><div class="line">    <span class="keyword">if</span> (r&lt;=sh) <span class="keyword">and</span> com(r,s) <span class="keyword">then</span> s:=r;</div><div class="line">    <span class="keyword">if</span> s&lt;&gt;i <span class="keyword">then</span> <span class="keyword">begin</span> swap(s,i);heapify(s) <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">extract</span><span class="params">()</span>;</span></div><div class="line"><span class="keyword">begin</span> swap(<span class="number">1</span>,sh);dec(sh);heapify(<span class="number">1</span>) <span class="keyword">end</span>;</div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">delete</span><span class="params">(x:int)</span>;</span></div><div class="line"><span class="keyword">var</span> i:int;</div><div class="line"><span class="keyword">begin</span> i:=lh[x];hp[i].d:=inf;heapify(i) <span class="keyword">end</span>;</div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">insert</span><span class="params">(x,y:int)</span>;</span></div><div class="line"><span class="keyword">var</span> i:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    inc(sh);lh[x]:=sh;</div><div class="line">    hp[sh].l:=x;hp[sh].r:=y;</div><div class="line">    hp[sh].d:=abs(a[x]-a[y]);</div><div class="line">    i:=sh;</div><div class="line">    <span class="keyword">while</span> (i&gt;<span class="number">1</span>) <span class="keyword">and</span> com(i,i <span class="keyword">shr</span> <span class="number">1</span>) <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        swap(i,i <span class="keyword">shr</span> <span class="number">1</span>);i:=i <span class="keyword">shr</span> <span class="number">1</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'dancingLessons.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'dancingLessons.out'</span>);rewrite(output);</div><div class="line">    readln(n);sh:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">read</span>(g[i]);readln;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(a[i]);</div><div class="line">        lk[i].l:=i-<span class="number">1</span>;lk[i].r:=i+<span class="number">1</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    lk[n].r:=<span class="number">0</span>;lk[<span class="number">0</span>].r:=<span class="number">1</span>;lk[<span class="number">0</span>].l:=n;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">2</span> <span class="keyword">to</span> n <span class="keyword">do</span></div><div class="line">        <span class="keyword">if</span> g[i]&lt;&gt;g[i-<span class="number">1</span>] <span class="keyword">then</span> insert(i-<span class="number">1</span>,i);</div><div class="line">    cnt:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (hp[<span class="number">1</span>].d&lt;&gt;inf) <span class="keyword">and</span> (sh&lt;&gt;<span class="number">0</span>) <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        inc(cnt);</div><div class="line">        l1:=hp[<span class="number">1</span>].l;r1:=hp[<span class="number">1</span>].r;extract;</div><div class="line">        l2:=lk[l1].l;r2:=lk[r1].r;</div><div class="line">        <span class="keyword">if</span> (l2&lt;&gt;<span class="number">0</span>) <span class="keyword">and</span> (g[l1]&lt;&gt;g[l2]) <span class="keyword">then</span> delete(l2);</div><div class="line">        <span class="keyword">if</span> (r2&lt;&gt;<span class="number">0</span>) <span class="keyword">and</span> (g[r1]&lt;&gt;g[r2]) <span class="keyword">then</span> delete(r1);</div><div class="line">        <span class="keyword">if</span> (min(l2,r2)&lt;&gt;<span class="number">0</span>) <span class="keyword">and</span> (g[l2]&lt;&gt;g[r2]) <span class="keyword">then</span></div><div class="line">            insert(l2,r2);</div><div class="line">        ans[cnt,<span class="number">0</span>]:=l1;ans[cnt,<span class="number">1</span>]:=r1;</div><div class="line">        lk[l2].r:=r2;lk[r2].l:=l2;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    writeln(cnt);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> cnt <span class="keyword">do</span> writeln(ans[i,<span class="number">0</span>],<span class="string">' '</span>,ans[i,<span class="number">1</span>]);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;描述&quot;&gt;&lt;a href=&quot;#描述&quot; class=&quot;headerlink&quot; title=&quot;描述&quot;&gt;&lt;/a&gt;描述&lt;/h2&gt;&lt;p&gt;有 n 个人参加一个舞蹈课。每个人的舞蹈技术由整数 来决定。在舞蹈课的开始,他们从左到右站成一排。当这一排中至少有一对相邻的异性时,舞蹈技术相差最小的那一对会出列并开始跳舞。如果相差最小的不止一对,那么最左边的那一对出列。一对异性出列之后,队伍中的空白按原顺序补上(即:若队伍为 ABCD,那么 BC 出列之后队伍变为 AD)。舞蹈技术相差最小即是 的绝对值最小。&lt;br&gt;你的任务是,模拟以上过程,确定跳舞的配对及顺序。&lt;br&gt;
    
    </summary>
    
      <category term="Problem Set" scheme="https://cothrax.github.io/categories/Problem-Set/"/>
    
    
      <category term="OI" scheme="https://cothrax.github.io/tags/OI/"/>
    
      <category term="数据结构" scheme="https://cothrax.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="堆" scheme="https://cothrax.github.io/tags/%E5%A0%86/"/>
    
      <category term="链表" scheme="https://cothrax.github.io/tags/%E9%93%BE%E8%A1%A8/"/>
    
  </entry>
  
  <entry>
    <title>NOIP模拟赛 皇帝的烦恼</title>
    <link href="https://cothrax.github.io/2016/09/14/NOIP%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E7%9A%87%E5%B8%9D%E7%9A%84%E7%83%A6%E6%81%BC/"/>
    <id>https://cothrax.github.io/2016/09/14/NOIP模拟赛-皇帝的烦恼/</id>
    <published>2016-09-14T14:11:22.000Z</published>
    <updated>2016-09-14T14:20:09.807Z</updated>
    
    <content type="html"><![CDATA[<h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>经过多年的杀戮，秦皇终于统一了中国。为了抵御外来的侵略，他准备在国土边境安置n名将军。不幸的是这n名将军羽翼渐丰，开始展露他们的狼子野心了。他们拒绝述职、拒绝接受皇帝的圣旨。秦皇已经准备好了秘密处决这些无礼的边防大将。不过为防兵变，他决定先授予这些将军一些勋章，为自己赢得战略时间。将军们听说他们即将被授予勋章都很开心，他们纷纷上书表示感谢。第i个将军要求得到ai枚不同颜色的勋章。但是这些将军都很傲气，如果两个相邻的将军拥有颜色相同的勋章他们就会认为皇帝不尊重他们，会立即造反（编号为i的将军和编号为i+1的将军相邻；因为他们驻扎的边境可以类似看成一个圆形，所以编号1和编号n的将军也相邻）。皇帝不得不满足每个将军的要求，但对他们的飞扬跋扈感到很气愤。于是皇帝决定铸造尽量少种类的勋章来满足这些狂妄者的要求。请问他至少要铸造多少种颜色的勋章？<br><a id="more"></a></p>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p>第一行有一个整数n(1&lt;=n&lt;=20000)。接下来n行每行一个整数ai，表示第i个将军要求得到多少种勋章。(1&lt;=ai&lt;=100000) </p>
<h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p>输出一个整数，即最少需要多少种勋章。</p>
<h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>4 2 2 1 1</p>
</blockquote>
<h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>4</p>
</blockquote>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>首先容易想出答案=相邻两数和的最大值<br>但对于<strong>奇数个数</strong>的情况，由于是一个环，是不满足上述贪心性质的。<br><del>（这样能得60分）</del><br>最小化合法解，很容易想到<strong>二分答案</strong>，但判定解的<strong>dp</strong>很坑：</p>
<ol>
<li>lb[i]：第i个人与第1个人重复徽章数的最小值</li>
<li>ub[i]：…的最大值</li>
</ol>
<p>$O(1)$转移，方程看代码好了<br>注意二分的下界为相邻两数和的最大值。</p>
<dir style="text-align:right"><a href="/2016/09/14/NOIP模拟赛-皇帝的烦恼/trouble0.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>trouble0.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    a,lb,ub:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">100010</span>] <span class="keyword">of</span> int;</div><div class="line">    n,i,l,r,mid,ans:int;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">jud</span><span class="params">(x:int)</span>:</span>boolean;</div><div class="line"><span class="keyword">var</span> i:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    lb[<span class="number">1</span>]:=a[<span class="number">1</span>];ub[<span class="number">1</span>]:=a[<span class="number">1</span>];</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">2</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        ub[i]:=min(a[i],a[<span class="number">1</span>]-lb[i-<span class="number">1</span>]);</div><div class="line">        lb[i]:=max(<span class="number">0</span>,a[i]-(x-a[<span class="number">1</span>]+(a[i-<span class="number">1</span>]-ub[i-<span class="number">1</span>])));</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    jud:=lb[n]=<span class="number">0</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'trouble.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'trouble.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n);ans:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(a[i]);</div><div class="line">        ans:=max(ans,a[i-<span class="number">1</span>]+a[i]);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    l:=ans;r:=ans*<span class="number">2</span>;</div><div class="line">    <span class="keyword">while</span> l&lt;=r <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        mid:=(l+r) <span class="keyword">shr</span> <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span> jud(mid) <span class="keyword">then</span> <span class="keyword">begin</span> ans:=mid;r:=mid-<span class="number">1</span> <span class="keyword">end</span></div><div class="line">        <span class="keyword">else</span> l:=mid+<span class="number">1</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">write</span>(ans);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;描述&quot;&gt;&lt;a href=&quot;#描述&quot; class=&quot;headerlink&quot; title=&quot;描述&quot;&gt;&lt;/a&gt;描述&lt;/h2&gt;&lt;p&gt;经过多年的杀戮，秦皇终于统一了中国。为了抵御外来的侵略，他准备在国土边境安置n名将军。不幸的是这n名将军羽翼渐丰，开始展露他们的狼子野心了。他们拒绝述职、拒绝接受皇帝的圣旨。秦皇已经准备好了秘密处决这些无礼的边防大将。不过为防兵变，他决定先授予这些将军一些勋章，为自己赢得战略时间。将军们听说他们即将被授予勋章都很开心，他们纷纷上书表示感谢。第i个将军要求得到ai枚不同颜色的勋章。但是这些将军都很傲气，如果两个相邻的将军拥有颜色相同的勋章他们就会认为皇帝不尊重他们，会立即造反（编号为i的将军和编号为i+1的将军相邻；因为他们驻扎的边境可以类似看成一个圆形，所以编号1和编号n的将军也相邻）。皇帝不得不满足每个将军的要求，但对他们的飞扬跋扈感到很气愤。于是皇帝决定铸造尽量少种类的勋章来满足这些狂妄者的要求。请问他至少要铸造多少种颜色的勋章？&lt;br&gt;
    
    </summary>
    
      <category term="Problem Set" scheme="https://cothrax.github.io/categories/Problem-Set/"/>
    
    
      <category term="OI" scheme="https://cothrax.github.io/tags/OI/"/>
    
      <category term="DP" scheme="https://cothrax.github.io/tags/DP/"/>
    
      <category term="二分答案" scheme="https://cothrax.github.io/tags/%E4%BA%8C%E5%88%86%E7%AD%94%E6%A1%88/"/>
    
  </entry>
  
  <entry>
    <title>NOIP模拟赛 西行寺幽幽子</title>
    <link href="https://cothrax.github.io/2016/09/14/NOIP%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E8%A5%BF%E8%A1%8C%E5%AF%BA%E5%B9%BD%E5%B9%BD%E5%AD%90/"/>
    <id>https://cothrax.github.io/2016/09/14/NOIP模拟赛-西行寺幽幽子/</id>
    <published>2016-09-14T14:07:14.000Z</published>
    <updated>2016-09-14T15:26:23.073Z</updated>
    
    <content type="html"><![CDATA[<h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>在幻想乡,西行寺幽幽子是以贪吃闻名的亡灵。不过幽幽子可不是只会吃,至少她还管理着亡灵界。话说在幽幽子居住的白玉楼有一颗常年不开花的樱树——西行妖。幽幽子决定去收集人间的春度,聚集起来让西行妖开花。很快,作为幽幽子家园艺师的魂魄妖梦收集到了 M 个单位的春度。并且在这段时间里,幽幽子计算出要让西行妖开出一朵花需要 N 个单位的春度。<br>现在幽幽子想要知道,使用所有的春度,能够让西行妖开出多少朵花。<br><a id="more"></a></p>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p>第 1 行:一个正整数 M<br>第 2 行:一个正整数 N<br>N,M 的位数不超过 L,L 的范围在题目后面给出</p>
<h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p>第 1 行:一个整数 ans,表示能开出花的朵数</p>
<h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>73861758<br>12471</p>
</blockquote>
<h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>5922</p>
</blockquote>
<h2 id="提示​"><a href="#提示​" class="headerlink" title="提示​"></a>提示​</h2><p>对于 60%的数据:L &lt;= 2,000 且 ans &lt;= 2,000<br>对于 100%的数据:L &lt;= 20,000 且 ans &lt;= 2,000,000,000</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>双精度除法，但答案在int内，可以用二分+乘法做。<br>题解告诉我还可以用二进制拆分做（就是倍增枚举的思想）</p>
<dir style="text-align:right"><a href="/2016/09/14/NOIP模拟赛-西行寺幽幽子/spring.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>spring.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">const</span> bs=<span class="number">100000000</span>;p=<span class="number">8</span>;</div><div class="line"><span class="keyword">type</span> </div><div class="line">    int=longint;</div><div class="line">    big=<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">5010</span>] <span class="keyword">of</span> int64;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    n,m:big;</div><div class="line">    l,r,mid,ans:int64;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">com</span><span class="params">(a,b:big)</span>:</span>int64;</div><div class="line"><span class="keyword">var</span> i:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    i:=max(a[<span class="number">0</span>],b[<span class="number">0</span>]);</div><div class="line">    <span class="keyword">while</span> (a[i]=b[i]) <span class="keyword">and</span> (i&gt;<span class="number">0</span>) <span class="keyword">do</span> dec(i);</div><div class="line">    com:=a[i]-b[i];</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">rd</span><span class="params">()</span>:</span>big;</div><div class="line"><span class="keyword">var</span> s:ansistring;f,b:int64;i:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    fillchar(rd,sizeof(rd),<span class="number">0</span>);</div><div class="line">    readln(s);f:=<span class="number">0</span>;b:=<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> i:=length(s) <span class="keyword">downto</span> <span class="number">1</span> <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        inc(f,(ord(s[i])-ord(<span class="string">'0'</span>))*b);b:=b*<span class="number">10</span>;</div><div class="line">        <span class="keyword">if</span> b=bs <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            inc(rd[<span class="number">0</span>]);rd[rd[<span class="number">0</span>]]:=f;f:=<span class="number">0</span>;b:=<span class="number">1</span>;</div><div class="line">        <span class="keyword">end</span>; </div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">if</span> f&lt;&gt;<span class="number">0</span> <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">        inc(rd[<span class="number">0</span>]);rd[rd[<span class="number">0</span>]]:=f;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mul</span><span class="params">(a:big;b:int64)</span>:</span>big;</div><div class="line"><span class="keyword">var</span> i:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    fillchar(mul,sizeof(mul),<span class="number">0</span>);</div><div class="line">    mul[<span class="number">0</span>]:=a[<span class="number">0</span>];</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> a[<span class="number">0</span>] <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        inc(mul[i],a[i]*b);</div><div class="line">        inc(mul[i+<span class="number">1</span>],mul[i] <span class="keyword">div</span> bs);</div><div class="line">        mul[i]:=mul[i] <span class="keyword">mod</span> bs;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">while</span> mul[mul[<span class="number">0</span>]+<span class="number">1</span>]&gt;<span class="number">0</span> <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        inc(mul[<span class="number">0</span>]);</div><div class="line">        inc(mul[mul[<span class="number">0</span>]+<span class="number">1</span>],mul[mul[<span class="number">0</span>]] <span class="keyword">div</span> bs);</div><div class="line">        mul[mul[<span class="number">0</span>]]:=mul[mul[<span class="number">0</span>]] <span class="keyword">mod</span> bs;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'spring.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'spring.out'</span>);rewrite(output);</div><div class="line">    m:=rd();n:=rd();</div><div class="line">    l:=<span class="number">1</span>;r:=<span class="number">2000000000</span>;</div><div class="line">    <span class="keyword">if</span> com(m,n)&lt;<span class="number">0</span> <span class="keyword">then</span> <span class="keyword">begin</span> <span class="keyword">write</span>(<span class="number">0</span>);halt <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">while</span> l&lt;=r <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        mid:=(l+r) <span class="keyword">shr</span> <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span> com(m,mul(n,mid))&gt;=<span class="number">0</span> <span class="keyword">then</span> <span class="keyword">begin</span> ans:=mid;l:=mid+<span class="number">1</span> <span class="keyword">end</span></div><div class="line">        <span class="keyword">else</span> r:=mid-<span class="number">1</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">write</span>(ans);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;描述&quot;&gt;&lt;a href=&quot;#描述&quot; class=&quot;headerlink&quot; title=&quot;描述&quot;&gt;&lt;/a&gt;描述&lt;/h2&gt;&lt;p&gt;在幻想乡,西行寺幽幽子是以贪吃闻名的亡灵。不过幽幽子可不是只会吃,至少她还管理着亡灵界。话说在幽幽子居住的白玉楼有一颗常年不开花的樱树——西行妖。幽幽子决定去收集人间的春度,聚集起来让西行妖开花。很快,作为幽幽子家园艺师的魂魄妖梦收集到了 M 个单位的春度。并且在这段时间里,幽幽子计算出要让西行妖开出一朵花需要 N 个单位的春度。&lt;br&gt;现在幽幽子想要知道,使用所有的春度,能够让西行妖开出多少朵花。&lt;br&gt;
    
    </summary>
    
      <category term="Problem Set" scheme="https://cothrax.github.io/categories/Problem-Set/"/>
    
    
      <category term="OI" scheme="https://cothrax.github.io/tags/OI/"/>
    
      <category term="二分答案" scheme="https://cothrax.github.io/tags/%E4%BA%8C%E5%88%86%E7%AD%94%E6%A1%88/"/>
    
      <category term="高精度" scheme="https://cothrax.github.io/tags/%E9%AB%98%E7%B2%BE%E5%BA%A6/"/>
    
  </entry>
  
  <entry>
    <title>NOIP模拟赛 藏妹子之处</title>
    <link href="https://cothrax.github.io/2016/09/14/NOIP%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E8%97%8F%E5%A6%B9%E5%AD%90%E4%B9%8B%E5%A4%84/"/>
    <id>https://cothrax.github.io/2016/09/14/NOIP模拟赛-藏妹子之处/</id>
    <published>2016-09-14T13:53:17.000Z</published>
    <updated>2016-09-14T14:23:23.729Z</updated>
    
    <content type="html"><![CDATA[<h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>今天CZY又找到了三个妹子，有着收藏爱好的他想要找三个地方将妹子们藏起来，将一片空地抽象成一个R行C列的表格，CZY要选出3个单元格。但要满足如下的两个条件：<br>（1）任意两个单元格都不在同一行。<br>（2）任意两个单元格都不在同一列。<br>选取格子存在一个花费，而这个花费是三个格子两两之间曼哈顿距离的和（如(x1,y1)和(x,y2)的曼哈顿距离为|x1-x2|+|y1-y2|）。狗狗想知道的是，花费在minT到maxT之间的方案数有多少。<br>答案模1000000007。所谓的两种不同方案是指：只要它选中的单元格有一个不同，就认为是不同的方案。<br><a id="more"></a></p>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p>一行，4个整数，R、C、minT、maxT。3≤R,C≤4000, 1≤minT≤maxT≤20000。<br>对于30%的数据,  3 ≤ R, C ≤ 70。    </p>
<h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p> 一个整数，表示不同的选择方案数量模1000000007后的结果。</p>
<h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><table>
<thead>
<tr>
<th>输入样例</th>
<th>3 3 1 20000</th>
<th>3 3 4 7</th>
<th>4 6 9 12</th>
<th>7 5 13 18</th>
<th>4000 4000 4000  14000</th>
</tr>
</thead>
<tbody>
<tr>
<td>输出样例</td>
<td>6</td>
<td>0</td>
<td>264</td>
<td>1212</td>
<td>859690013</td>
</tr>
</tbody>
</table>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>拿到手DP想了好久。。。结果正解是乱搞<br>考虑曼哈顿距离的数学含义：</p>
<ol>
<li>对于(x1,y1),(x2,y2),(x3,y3)来说（$x_i&lt;x_{i+1}$,y同理），三点的距离和为$2(x3-x1)(y3-y1)$</li>
<li>因此，对于一个矩形r*c，取左上角为(x1,y1)，取右下角为(x3,y3)，在中间（与前两个点行列不同）取点(x2,y2)，那么这三个点的费用是一定的，这个矩形对答案的贡献=(x2,y2)的个数$\cdot P^3_3$</li>
<li>而这样的矩形在整个网格中的位置共有$(n-r+1)(m-c+1)$种</li>
<li>综上，r*c的矩形对答案的总贡献为$6(r-2)(c-2)(n-r+1)(m-c+1)$；这样枚举合法矩形（即曼哈顿距离在[minT,maxT]中）的r和c就能统计出答案。</li>
</ol>
<dir style="text-align:right"><a href="/2016/09/14/NOIP模拟赛-藏妹子之处/excel.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>excel.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">const</span> inf=<span class="number">1000000007</span>;</div><div class="line"><span class="keyword">var</span> n,m,i,j,mi,mx:int;ans:qword;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'excel.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'excel.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n,m,mi,mx);</div><div class="line">    ans:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">3</span> <span class="keyword">to</span> n <span class="keyword">do</span></div><div class="line">        <span class="keyword">for</span> j:=<span class="number">3</span> <span class="keyword">to</span> m <span class="keyword">do</span></div><div class="line">            <span class="keyword">if</span> (<span class="number">2</span>*(i+j-<span class="number">2</span>)&gt;=mi) <span class="keyword">and</span> (<span class="number">2</span>*(i+j-<span class="number">2</span>)&lt;=mx) <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">                ans:=ans+<span class="number">6</span>*(i-<span class="number">2</span>)*(j-<span class="number">2</span>)*(n-i+<span class="number">1</span>)*(m-j+<span class="number">1</span>);</div><div class="line">                <span class="keyword">if</span> ans&gt;inf <span class="keyword">then</span> ans:=ans <span class="keyword">mod</span> inf;</div><div class="line">            <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">write</span>(ans);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;描述&quot;&gt;&lt;a href=&quot;#描述&quot; class=&quot;headerlink&quot; title=&quot;描述&quot;&gt;&lt;/a&gt;描述&lt;/h2&gt;&lt;p&gt;今天CZY又找到了三个妹子，有着收藏爱好的他想要找三个地方将妹子们藏起来，将一片空地抽象成一个R行C列的表格，CZY要选出3个单元格。但要满足如下的两个条件：&lt;br&gt;（1）任意两个单元格都不在同一行。&lt;br&gt;（2）任意两个单元格都不在同一列。&lt;br&gt;选取格子存在一个花费，而这个花费是三个格子两两之间曼哈顿距离的和（如(x1,y1)和(x,y2)的曼哈顿距离为|x1-x2|+|y1-y2|）。狗狗想知道的是，花费在minT到maxT之间的方案数有多少。&lt;br&gt;答案模1000000007。所谓的两种不同方案是指：只要它选中的单元格有一个不同，就认为是不同的方案。&lt;br&gt;
    
    </summary>
    
      <category term="Problem Set" scheme="https://cothrax.github.io/categories/Problem-Set/"/>
    
    
      <category term="OI" scheme="https://cothrax.github.io/tags/OI/"/>
    
      <category term="枚举" scheme="https://cothrax.github.io/tags/%E6%9E%9A%E4%B8%BE/"/>
    
      <category term="数学" scheme="https://cothrax.github.io/tags/%E6%95%B0%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>NOIP模拟赛 还教室</title>
    <link href="https://cothrax.github.io/2016/09/12/NOIP%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E8%BF%98%E6%95%99%E5%AE%A4/"/>
    <id>https://cothrax.github.io/2016/09/12/NOIP模拟赛-还教室/</id>
    <published>2016-09-12T15:27:18.000Z</published>
    <updated>2016-09-14T14:41:41.890Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><img src="/2016/09/12/NOIP模拟赛-还教室/desc.png" alt="desc.png" title="">
<a id="more"></a>
<img src="/2016/09/12/NOIP模拟赛-还教室/samp.png" alt="samp.png" title="">
<img src="/2016/09/12/NOIP模拟赛-还教室/expl.png" alt="expl.png" title="">
<img src="/2016/09/12/NOIP模拟赛-还教室/data.png" alt="data.png" title="">
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>裸的线段树操作，维护区间和sum和平方和squ<br>平均数显然是<span>$\dfrac{\sum_{i=l}^ra[i]}{r-l+1}$</span><!-- Has MathJax --><br>方差可以变形：<br>记<span>$n=r-l+1,su=\sum_{i=l}^ra[i],sq=\sum_{i=l}^ra[i]^2,M=su/n$</span><!-- Has MathJax --><br><span>$V[l,r]=\dfrac{\sum_{i=l}^r(a[i]-M)^2}{n}$</span><!-- Has MathJax --><br><span>$=\dfrac{\sum_{i=l}^ra[i]^2-2\sum_{i=l}^ra[i]M+nM^2}{n}$</span><!-- Has MathJax --><br><span>$=\dfrac{sq-2su\cdot M+n^2M^2}{n}$</span><!-- Has MathJax --><br><span>$=\dfrac{n\cdot sq-su^2}{n^2}$</span><!-- Has MathJax --><br>方差=平方的平均数-平均数的平方</p>
<ol>
<li>开始错用了一个int做中间量结果wa</li>
<li>第二次被int64坑，大量mod和div千万不要用int64，说不准就会出现精度误差，开始int64+gcd最后一个点wa，换成qword就好。</li>
</ol>
<dir style="text-align:right"><a href="/2016/09/12/NOIP模拟赛-还教室/classroom.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>classroom.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    tag:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">400010</span>] <span class="keyword">of</span> qword;</div><div class="line">    seg:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">400010</span>,<span class="number">0</span>..<span class="number">1</span>] <span class="keyword">of</span> qword;</div><div class="line">    a:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">100010</span>] <span class="keyword">of</span> int;</div><div class="line">    n,m,i,c,l,r:int;d,su,sq,g,k:qword;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">min</span><span class="params">(a,b:qword)</span>:</span>qword;</div><div class="line"><span class="keyword">begin</span> <span class="keyword">if</span> a&lt;b <span class="keyword">then</span> min:=a <span class="keyword">else</span> min:=b <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">build</span><span class="params">(i,b,e:int)</span>;</span></div><div class="line"><span class="keyword">var</span> mid:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">if</span> b=e <span class="keyword">then</span> <span class="keyword">begin</span> seg[i,<span class="number">0</span>]:=a[b];seg[i,<span class="number">1</span>]:=sqr(a[b]);<span class="keyword">exit</span> <span class="keyword">end</span>;</div><div class="line">    mid:=(b+e) <span class="keyword">shr</span> <span class="number">1</span>;</div><div class="line">    build(i <span class="keyword">shl</span> <span class="number">1</span>,b,mid);</div><div class="line">    build(i <span class="keyword">shl</span> <span class="number">1</span> <span class="keyword">or</span> <span class="number">1</span>,mid+<span class="number">1</span>,e);</div><div class="line">    seg[i,<span class="number">0</span>]:=seg[i <span class="keyword">shl</span> <span class="number">1</span>,<span class="number">0</span>]+seg[i <span class="keyword">shl</span> <span class="number">1</span> <span class="keyword">or</span> <span class="number">1</span>,<span class="number">0</span>];</div><div class="line">    seg[i,<span class="number">1</span>]:=seg[i <span class="keyword">shl</span> <span class="number">1</span>,<span class="number">1</span>]+seg[i <span class="keyword">shl</span> <span class="number">1</span> <span class="keyword">or</span> <span class="number">1</span>,<span class="number">1</span>];</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">pushdown</span><span class="params">(i,b,e:int)</span>;</span></div><div class="line"><span class="keyword">var</span> mid:int;</div><div class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">deal</span><span class="params">(j,b,e:int)</span>;</span></div><div class="line">    <span class="keyword">begin</span></div><div class="line">        inc(tag[j],tag[i]);</div><div class="line">        inc(seg[j,<span class="number">1</span>],<span class="number">2</span>*tag[i]*seg[j,<span class="number">0</span>]+(e-b+<span class="number">1</span>)*sqr(tag[i]));</div><div class="line">        inc(seg[j,<span class="number">0</span>],(e-b+<span class="number">1</span>)*tag[i]);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    mid:=(b+e) <span class="keyword">shr</span> <span class="number">1</span>;</div><div class="line">    deal(i <span class="keyword">shl</span> <span class="number">1</span>,b,mid);</div><div class="line">    deal(i <span class="keyword">shl</span> <span class="number">1</span> <span class="keyword">or</span> <span class="number">1</span>,mid+<span class="number">1</span>,e);</div><div class="line">    tag[i]:=<span class="number">0</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">query</span><span class="params">(i,b,e,l,r,x:int)</span>:</span>qword;</div><div class="line"><span class="keyword">var</span> mid:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">if</span> (r&lt;b) <span class="keyword">or</span> (e&lt;l) <span class="keyword">then</span> <span class="keyword">exit</span>(<span class="number">0</span>);</div><div class="line">    <span class="keyword">if</span> (l&lt;=b) <span class="keyword">and</span> (e&lt;=r) <span class="keyword">then</span> <span class="keyword">exit</span>(seg[i,x]);</div><div class="line">    mid:=(b+e) <span class="keyword">shr</span> <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span> tag[i]&lt;&gt;<span class="number">0</span> <span class="keyword">then</span> pushdown(i,b,e);</div><div class="line">    query:=query(i <span class="keyword">shl</span> <span class="number">1</span>,b,mid,l,r,x);</div><div class="line">    inc(query,query(i <span class="keyword">shl</span> <span class="number">1</span> <span class="keyword">or</span> <span class="number">1</span>,mid+<span class="number">1</span>,e,l,r,x));</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">modify</span><span class="params">(i,b,e,l,r,x:int)</span>;</span></div><div class="line"><span class="keyword">var</span> mid:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">if</span> (r&lt;b) <span class="keyword">or</span> (e&lt;l) <span class="keyword">then</span> <span class="keyword">exit</span>;</div><div class="line">    <span class="keyword">if</span> (l&lt;=b) <span class="keyword">and</span> (e&lt;=r) <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">        inc(tag[i],x);</div><div class="line">        inc(seg[i,<span class="number">1</span>],<span class="number">2</span>*x*seg[i,<span class="number">0</span>]+(e-b+<span class="number">1</span>)*sqr(x));</div><div class="line">        inc(seg[i,<span class="number">0</span>],(e-b+<span class="number">1</span>)*x);</div><div class="line">        <span class="keyword">exit</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    mid:=(b+e) <span class="keyword">shr</span> <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span> tag[i]&lt;&gt;<span class="number">0</span> <span class="keyword">then</span> pushdown(i,b,e);</div><div class="line">    modify(i <span class="keyword">shl</span> <span class="number">1</span>,b,mid,l,r,x);</div><div class="line">    modify(i <span class="keyword">shl</span> <span class="number">1</span> <span class="keyword">or</span> <span class="number">1</span>,mid+<span class="number">1</span>,e,l,r,x);</div><div class="line">    seg[i,<span class="number">0</span>]:=seg[i <span class="keyword">shl</span> <span class="number">1</span>,<span class="number">0</span>]+seg[i <span class="keyword">shl</span> <span class="number">1</span> <span class="keyword">or</span> <span class="number">1</span>,<span class="number">0</span>];</div><div class="line">    seg[i,<span class="number">1</span>]:=seg[i <span class="keyword">shl</span> <span class="number">1</span>,<span class="number">1</span>]+seg[i <span class="keyword">shl</span> <span class="number">1</span> <span class="keyword">or</span> <span class="number">1</span>,<span class="number">1</span>];</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">gcd</span><span class="params">(a,b:qword)</span>:</span>qword;</div><div class="line"><span class="keyword">begin</span> <span class="keyword">if</span> b=<span class="number">0</span> <span class="keyword">then</span> gcd:=a <span class="keyword">else</span> gcd:=gcd(b,a <span class="keyword">mod</span> b) <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'classroom.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'classroom.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n,m);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">read</span>(a[i]);</div><div class="line">    build(<span class="number">1</span>,<span class="number">1</span>,n);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> m <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(c,l,r);</div><div class="line">        <span class="keyword">case</span> c <span class="keyword">of</span></div><div class="line">            <span class="number">1</span>:<span class="keyword">begin</span> <span class="keyword">read</span>(d);modify(<span class="number">1</span>,<span class="number">1</span>,n,l,r,d) <span class="keyword">end</span>;</div><div class="line">            <span class="number">2</span>:<span class="keyword">begin</span> </div><div class="line">                su:=query(<span class="number">1</span>,<span class="number">1</span>,n,l,r,<span class="number">0</span>);k:=r-l+<span class="number">1</span>;</div><div class="line">                <span class="keyword">if</span> min(su,k)=<span class="number">0</span> <span class="keyword">then</span> writeln(<span class="string">'0/1'</span>)</div><div class="line">                <span class="keyword">else</span> <span class="keyword">begin</span></div><div class="line">                    g:=gcd(su,k);</div><div class="line">                    writeln(su <span class="keyword">div</span> g,<span class="string">'/'</span>,k <span class="keyword">div</span> g);</div><div class="line">                <span class="keyword">end</span>;</div><div class="line">            <span class="keyword">end</span>;</div><div class="line">            <span class="number">3</span>:<span class="keyword">begin</span></div><div class="line">                su:=query(<span class="number">1</span>,<span class="number">1</span>,n,l,r,<span class="number">0</span>);k:=r-l+<span class="number">1</span>;</div><div class="line">                sq:=query(<span class="number">1</span>,<span class="number">1</span>,n,l,r,<span class="number">1</span>);d:=k*sq-sqr(su);</div><div class="line">                <span class="keyword">if</span> min(d,sqr(k))=<span class="number">0</span> <span class="keyword">then</span> writeln(<span class="string">'0/1'</span>)</div><div class="line">                <span class="keyword">else</span> <span class="keyword">begin</span></div><div class="line">                    g:=gcd(d,sqr(k));</div><div class="line">                    writeln(d <span class="keyword">div</span> g,<span class="string">'/'</span>,sqr(k) <span class="keyword">div</span> g);</div><div class="line">                <span class="keyword">end</span>;</div><div class="line">            <span class="keyword">end</span>;</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;题目&quot;&gt;&lt;a href=&quot;#题目&quot; class=&quot;headerlink&quot; title=&quot;题目&quot;&gt;&lt;/a&gt;题目&lt;/h2&gt;&lt;img src=&quot;/2016/09/12/NOIP模拟赛-还教室/desc.png&quot; alt=&quot;desc.png&quot; title=&quot;&quot;&gt;
    
    </summary>
    
      <category term="Problem Set" scheme="https://cothrax.github.io/categories/Problem-Set/"/>
    
    
      <category term="OI" scheme="https://cothrax.github.io/tags/OI/"/>
    
      <category term="数据结构" scheme="https://cothrax.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="线段树" scheme="https://cothrax.github.io/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>NOIP模拟赛 穿越七色虹</title>
    <link href="https://cothrax.github.io/2016/09/11/NOIP%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E7%A9%BF%E8%B6%8A%E4%B8%83%E8%89%B2%E8%99%B9/"/>
    <id>https://cothrax.github.io/2016/09/11/NOIP模拟赛-穿越七色虹/</id>
    <published>2016-09-11T15:20:02.000Z</published>
    <updated>2016-09-14T13:46:20.780Z</updated>
    
    <content type="html"><![CDATA[<h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><img src="/2016/09/11/NOIP模拟赛-穿越七色虹/desc.png" alt="desc.png" title="">
<a id="more"></a>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p>第一行两个实数 h、x0,表示身高和目的地横坐标。 接下来七行每行两个实数 xi、ri,表示七座半圆形彩虹的圆心和半径。</p>
<h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p>输出最小的 r,四舍五入保留 2 位小数。</p>
<h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>4.0 36.0<br>0.0 4.0<br>6.0 4.0<br>12.0 4.0<br>18.0 4.0<br>24.0 4.0<br>30.0 4.0<br>36.0 4.0</p>
</blockquote>
<h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>1.00</p>
</blockquote>
<h2 id="提示​"><a href="#提示​" class="headerlink" title="提示​"></a>提示​</h2><p>数据范围与约定<br>对于 100% 的数据,满足 0&lt;=xi,x0&lt;=10000,0&lt;h&lt;100。</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>二分r+初中几何题<br>确定r后，每个半圆能覆盖的区域都是一个线段，然后排序+扫一边判断，注意终点的判断。<br>另外，用sqrt(n)时要保证n&gt;0</p>
<dir style="text-align:right"><a href="/2016/09/11/NOIP模拟赛-穿越七色虹/rainbow.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>rainbow.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">const</span> n=<span class="number">7</span>;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    p,a,b,e:<span class="keyword">array</span>[<span class="number">0</span>..n] <span class="keyword">of</span> double;</div><div class="line">    h,t,l,r,mid:double;</div><div class="line">    i:int;</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">com</span><span class="params">(i,j:int)</span>:</span>boolean;</div><div class="line"><span class="keyword">begin</span> com:=(b[i]&lt;b[j]) <span class="keyword">or</span> ((b[i]=b[j]) <span class="keyword">and</span> (e[i]&lt;e[j])) <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">swap</span><span class="params">(i,j:int)</span>;</span></div><div class="line"><span class="keyword">var</span> tmp:double;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    tmp:=b[i];b[i]:=b[j];b[j]:=tmp;</div><div class="line">    tmp:=e[i];e[i]:=e[j];e[j]:=tmp;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">(x:double)</span>:</span>boolean;</div><div class="line"><span class="keyword">var</span> i,j:int;last:double;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        b[i]:=p[i]-sqrt(max(<span class="number">0</span>,sqr(a[i]+x)-sqr(h)));</div><div class="line">        e[i]:=p[i]+sqrt(max(<span class="number">0</span>,sqr(a[i]+x)-sqr(h)));</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> </div><div class="line">        <span class="keyword">for</span> j:=i+<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span></div><div class="line">            <span class="keyword">if</span> com(j,i) <span class="keyword">then</span> swap(i,j);</div><div class="line">    j:=n+<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">if</span> e[i]&gt;=t <span class="keyword">then</span> <span class="keyword">begin</span> j:=i;break <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">if</span> j=n+<span class="number">1</span> <span class="keyword">then</span> <span class="keyword">exit</span>(false);</div><div class="line">    last:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> j <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">if</span> b[i]&gt;last <span class="keyword">then</span> <span class="keyword">exit</span>(false);</div><div class="line">        last:=max(last,e[i]);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    check:=true;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'rainbow.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'rainbow.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(h,t);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">read</span>(p[i],a[i]);</div><div class="line">    l:=<span class="number">0</span>;r:=<span class="number">1000000</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> <span class="number">100</span> <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        mid:=(l+r)/<span class="number">2</span>;</div><div class="line">        <span class="keyword">if</span> check(mid) <span class="keyword">then</span> r:=mid <span class="keyword">else</span> l:=mid;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">write</span>(r:<span class="number">0</span>:<span class="number">2</span>);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;描述&quot;&gt;&lt;a href=&quot;#描述&quot; class=&quot;headerlink&quot; title=&quot;描述&quot;&gt;&lt;/a&gt;描述&lt;/h2&gt;&lt;img src=&quot;/2016/09/11/NOIP模拟赛-穿越七色虹/desc.png&quot; alt=&quot;desc.png&quot; title=&quot;&quot;&gt;
    
    </summary>
    
      <category term="Problem Set" scheme="https://cothrax.github.io/categories/Problem-Set/"/>
    
    
      <category term="OI" scheme="https://cothrax.github.io/tags/OI/"/>
    
      <category term="二分答案" scheme="https://cothrax.github.io/tags/%E4%BA%8C%E5%88%86%E7%AD%94%E6%A1%88/"/>
    
  </entry>
  
  <entry>
    <title>NOIP模拟赛 梦幻布丁</title>
    <link href="https://cothrax.github.io/2016/09/11/NOIP%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E6%A2%A6%E5%B9%BB%E5%B8%83%E4%B8%81/"/>
    <id>https://cothrax.github.io/2016/09/11/NOIP模拟赛-梦幻布丁/</id>
    <published>2016-09-11T03:48:48.000Z</published>
    <updated>2016-09-11T04:01:53.091Z</updated>
    
    <content type="html"><![CDATA[<h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>N个布丁摆成一行,进行M次操作.每次将某个颜色的布丁全部变成另一种颜色的,然后再询问当前一共有多少段颜色.例如颜色分别为1,2,2,1的四个布丁一共有3段颜色.</p>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p>第一行给出N,M表示布丁的个数和好友的操作次数. 第二行N个数A1,A2…An表示第i个布丁的颜色从第三行起有M行,对于每个操作,若第一个数字是1表示要对颜色进行改变，其后的两个整数X,Y表示将所有颜色为X的变为Y，X可能等于Y. 若第一个数字为2表示要进行询问当前有多少段颜色，这时你应该输出一个整数. 0</p>
<h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p>针对第二类操作即询问，依次输出当前有多少段颜色.<br><a id="more"></a></p>
<h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>4 3<br>1 2 2 1<br>2<br>1 2 1<br>2</p>
</blockquote>
<h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>3<br>1</p>
</blockquote>
<h2 id="提示​"><a href="#提示​" class="headerlink" title="提示​"></a>提示​</h2><p>n,m&lt;=100000 x,y&lt;=1000000</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p><strong>链表+启发式合并</strong><br>启发式合并就是将size小的链表中的元素一个个取出来插进size大的链表，由于每次操作size小的链表，合并后的size至少为原来的两倍。<br>因此，考虑一个元素，它被从一个链表插进另一个链表的次数最多为$O(logN)$次，所以总的复杂度为$O(NlogN)$<br>树、set、并查集等都可以启发式合并。<br>关于本题：<br>将颜色相同的串成链表，记当前的段数为ans；每次把颜色a改成b相当于合并两个链表。<br>暴力修改a和b中size小的那个链表，把它接到大的上面去，检查相邻颜色维护ans。<br>当size[a]&gt;size[b]的时候，会把颜色b修改成a，这与题意不符，因此要用f[i]记录颜色i当前是多少，如在这种情况下f[b]=a,f[a]=b</p>
<dir style="text-align:right"><a href="/2016/09/11/NOIP模拟赛-梦幻布丁/pudding.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>pudding.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    h,t,s,f:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">1000010</span>] <span class="keyword">of</span> int;</div><div class="line">    c,next:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">100010</span>] <span class="keyword">of</span> int;</div><div class="line">    n,m,i,x,a,b,ans:int;</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">swap</span><span class="params">(<span class="keyword">var</span> a,b:int)</span>;</span></div><div class="line"><span class="keyword">var</span> tmp:int;</div><div class="line"><span class="keyword">begin</span> tmp:=a;a:=b;b:=tmp <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">merge</span><span class="params">(a,b:int)</span>;</span></div><div class="line"><span class="keyword">var</span> i:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    i:=h[a];</div><div class="line">    <span class="keyword">while</span> i&lt;&gt;<span class="number">0</span> <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">if</span> c[i-<span class="number">1</span>]=b <span class="keyword">then</span> dec(ans);</div><div class="line">        <span class="keyword">if</span> c[i+<span class="number">1</span>]=b <span class="keyword">then</span> dec(ans);</div><div class="line">        i:=next[i];</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    i:=h[a];</div><div class="line">    <span class="keyword">while</span> i&lt;&gt;<span class="number">0</span> <span class="keyword">do</span> <span class="keyword">begin</span> c[i]:=b;i:=next[i] <span class="keyword">end</span>;</div><div class="line">    next[t[b]]:=h[a];t[b]:=t[a];inc(s[b],s[a]);</div><div class="line">    s[a]:=<span class="number">0</span>;h[a]:=<span class="number">0</span>;t[a]:=<span class="number">0</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'pudding.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'pudding.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n,m);ans:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(c[i]);</div><div class="line">        <span class="keyword">if</span> c[i]&lt;&gt;c[i-<span class="number">1</span>] <span class="keyword">then</span> inc(ans);</div><div class="line">        f[c[i]]:=c[i];</div><div class="line">        <span class="keyword">if</span> h[c[i]]=<span class="number">0</span> <span class="keyword">then</span> t[c[i]]:=i;</div><div class="line">        inc(s[c[i]]);next[i]:=h[c[i]];h[c[i]]:=i;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> m <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(x);</div><div class="line">        <span class="keyword">if</span> x=<span class="number">1</span> <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            <span class="keyword">read</span>(a,b);</div><div class="line">            <span class="keyword">if</span> a=b <span class="keyword">then</span> continue;</div><div class="line">            <span class="keyword">if</span> s[f[a]]&gt;s[f[b]] <span class="keyword">then</span> swap(f[a],f[b]);</div><div class="line">            a:=f[a];b:=f[b];</div><div class="line">            <span class="keyword">if</span> s[a]=<span class="number">0</span> <span class="keyword">then</span> continue;</div><div class="line">            merge(a,b);</div><div class="line">        <span class="keyword">end</span> <span class="keyword">else</span> writeln(ans);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;描述&quot;&gt;&lt;a href=&quot;#描述&quot; class=&quot;headerlink&quot; title=&quot;描述&quot;&gt;&lt;/a&gt;描述&lt;/h2&gt;&lt;p&gt;N个布丁摆成一行,进行M次操作.每次将某个颜色的布丁全部变成另一种颜色的,然后再询问当前一共有多少段颜色.例如颜色分别为1,2,2,1的四个布丁一共有3段颜色.&lt;/p&gt;
&lt;h2 id=&quot;格式&quot;&gt;&lt;a href=&quot;#格式&quot; class=&quot;headerlink&quot; title=&quot;格式&quot;&gt;&lt;/a&gt;格式&lt;/h2&gt;&lt;h3 id=&quot;输入格式&quot;&gt;&lt;a href=&quot;#输入格式&quot; class=&quot;headerlink&quot; title=&quot;输入格式&quot;&gt;&lt;/a&gt;输入格式&lt;/h3&gt;&lt;p&gt;第一行给出N,M表示布丁的个数和好友的操作次数. 第二行N个数A1,A2…An表示第i个布丁的颜色从第三行起有M行,对于每个操作,若第一个数字是1表示要对颜色进行改变，其后的两个整数X,Y表示将所有颜色为X的变为Y，X可能等于Y. 若第一个数字为2表示要进行询问当前有多少段颜色，这时你应该输出一个整数. 0&lt;/p&gt;
&lt;h3 id=&quot;输出格式&quot;&gt;&lt;a href=&quot;#输出格式&quot; class=&quot;headerlink&quot; title=&quot;输出格式&quot;&gt;&lt;/a&gt;输出格式&lt;/h3&gt;&lt;p&gt;针对第二类操作即询问，依次输出当前有多少段颜色.&lt;br&gt;
    
    </summary>
    
      <category term="Problem Set" scheme="https://cothrax.github.io/categories/Problem-Set/"/>
    
    
      <category term="OI" scheme="https://cothrax.github.io/tags/OI/"/>
    
      <category term="数据结构" scheme="https://cothrax.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="链表" scheme="https://cothrax.github.io/tags/%E9%93%BE%E8%A1%A8/"/>
    
      <category term="启发式合并" scheme="https://cothrax.github.io/tags/%E5%90%AF%E5%8F%91%E5%BC%8F%E5%90%88%E5%B9%B6/"/>
    
  </entry>
  
  <entry>
    <title>NOIP模拟赛 黑魔法师之门</title>
    <link href="https://cothrax.github.io/2016/09/10/NOIP%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E9%BB%91%E9%AD%94%E6%B3%95%E5%B8%88%E4%B9%8B%E9%97%A8/"/>
    <id>https://cothrax.github.io/2016/09/10/NOIP模拟赛-黑魔法师之门/</id>
    <published>2016-09-10T15:22:00.000Z</published>
    <updated>2016-09-10T15:36:03.902Z</updated>
    
    <content type="html"><![CDATA[<h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>经过了 16 个工作日的紧张忙碌,未来的人类终于收集到了足够的能源。然而在与 Violet星球的战争中,由于 Z 副官的愚蠢,地球的领袖 applepi 被邪恶的黑魔法师 Vani 囚禁在了Violet 星球。为了重启 Nescafé这一宏伟的科技工程,人类派出了一支由 XLk、Poet_shy 和lydrainbowcat 三人组成的精英队伍,穿越时空隧道,去往 Violet 星球拯救领袖 applepi。<br>applepi 被囚禁的地点只有一扇门,当地人称它为“黑魔法师之门”。这扇门上画着一张无向无权图,而打开这扇门的密码就是<strong>图中每个点的度数大于零且都是偶数的子图的个数对 1000000009 取模的值</strong>。此处子图 (V, E) 定义为:点集 V 和边集 E 都是原图的任意子集,其中 E 中的边的端点都在 V 中。<br>但是 Vani 认为这样的密码过于简单,因此门上的图是动态的。起初图中只有 N 个顶点而没有边。Vani 建造的门控系统共操作 M 次,每次往图中添加一条边。你必须在每次操作后都填写正确的密码,才能够打开黑魔法师的牢狱,去拯救伟大的领袖 applepi。</p>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p>第一行包含两个整数 N 和 M。<br>接下来 M 行,每行两个整数 A 和 B,代表门控系统添加了一条无向边 (A, B)。</p>
<h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p>输出一共 M 行,表示每次操作后的密码。<br><a id="more"></a></p>
<h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>4 8<br>3 1<br>3 2<br>2 1<br>2 1<br>1 3<br>1 4<br>2 4<br>2 3</p>
</blockquote>
<h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>0<br>0<br>13<br>7<br>7<br>15<br>31</p>
</blockquote>
<h2 id="提示​"><a href="#提示​" class="headerlink" title="提示​"></a>提示​</h2><h3 id="样例说明"><a href="#样例说明" class="headerlink" title="样例说明"></a>样例说明</h3><p>第三次添加之后,存在一个满足条件的子图 {1, 2, 3}(其中 1, 2, 3 是数据中边的标号)。<br>第四次添加之后,存在三个子图 {1, 2, 3},{1, 2, 4},{3, 4}。<br>„„</p>
<h3 id="数据范围与约定"><a href="#数据范围与约定" class="headerlink" title="数据范围与约定"></a>数据范围与约定</h3><p>对于 30% 的数据,N, M≤10。<br>对于 100% 的数据,N≤200000,M≤300000。</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>构造（找规律）后并查集，容易发现一个满足题意的子图是有环的，且都可以看做是多个简单环拼接起来，实际上答案=2^(简单环的个数)-1<br>有以下几种思路：</p>
<ol>
<li>考虑边e(x,y)，如果x和y已经连通，那么将e加进去会形成一个简单环，将这个环加入已有的子图中会构造出新的答案，于是ans=ans*2+1</li>
<li>或者说，由于答案的子图都是由简单环组合出来的，二项式定理可得答案是$\sum_{i=1}^{n}C(n,i)=2^n-1$，同样可以算出来</li>
<li>题解提供了一种奇怪的构造思路：<blockquote>
<p>因为一个环里每个点的度数都是大于零的偶数,我们可以这样来构造答案:每个环有选和不选两种选择,如果选择了该环,那么环上所有边的“选择次数” +1。最后取所有“选择次数”为奇数的边构成一个边集,就是一个答案。可以证明这样构造出来的解不重复且涵盖了所有情况。因此答案就是 2^(图中”元”环的个数)。实现方法非常简单,只需要一个并查集即可。</p>
</blockquote>
</li>
</ol>
<dir style="text-align:right"><a href="/2016/09/10/NOIP模拟赛-黑魔法师之门/magician.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>magician.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">const</span> z=<span class="number">1000000009</span>;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    par:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">200010</span>] <span class="keyword">of</span> int;</div><div class="line">    n,m,i,ans,x,y:int;</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">find</span><span class="params">(x:int)</span>:</span>int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">if</span> par[x]=x <span class="keyword">then</span> find:=x</div><div class="line">    <span class="keyword">else</span> <span class="keyword">begin</span> par[x]:=find(par[x]);find:=par[x] <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">union</span><span class="params">(x,y:int)</span>;</span></div><div class="line"><span class="keyword">begin</span> x:=find(x);y:=find(y);par[x]:=y <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">same</span><span class="params">(x,y:int)</span>:</span>boolean;</div><div class="line"><span class="keyword">begin</span> same:=find(x)=find(y) <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'magician.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'magician.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n,m);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> par[i]:=i;</div><div class="line">    ans:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> m <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(x,y);</div><div class="line">        <span class="keyword">if</span> same(x,y) <span class="keyword">then</span> ans:=(ans*<span class="number">2</span>+<span class="number">1</span>) <span class="keyword">mod</span> z <span class="keyword">else</span> union(x,y);</div><div class="line">        writeln(ans); </div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;描述&quot;&gt;&lt;a href=&quot;#描述&quot; class=&quot;headerlink&quot; title=&quot;描述&quot;&gt;&lt;/a&gt;描述&lt;/h2&gt;&lt;p&gt;经过了 16 个工作日的紧张忙碌,未来的人类终于收集到了足够的能源。然而在与 Violet星球的战争中,由于 Z 副官的愚蠢,地球的领袖 applepi 被邪恶的黑魔法师 Vani 囚禁在了Violet 星球。为了重启 Nescafé这一宏伟的科技工程,人类派出了一支由 XLk、Poet_shy 和lydrainbowcat 三人组成的精英队伍,穿越时空隧道,去往 Violet 星球拯救领袖 applepi。&lt;br&gt;applepi 被囚禁的地点只有一扇门,当地人称它为“黑魔法师之门”。这扇门上画着一张无向无权图,而打开这扇门的密码就是&lt;strong&gt;图中每个点的度数大于零且都是偶数的子图的个数对 1000000009 取模的值&lt;/strong&gt;。此处子图 (V, E) 定义为:点集 V 和边集 E 都是原图的任意子集,其中 E 中的边的端点都在 V 中。&lt;br&gt;但是 Vani 认为这样的密码过于简单,因此门上的图是动态的。起初图中只有 N 个顶点而没有边。Vani 建造的门控系统共操作 M 次,每次往图中添加一条边。你必须在每次操作后都填写正确的密码,才能够打开黑魔法师的牢狱,去拯救伟大的领袖 applepi。&lt;/p&gt;
&lt;h2 id=&quot;格式&quot;&gt;&lt;a href=&quot;#格式&quot; class=&quot;headerlink&quot; title=&quot;格式&quot;&gt;&lt;/a&gt;格式&lt;/h2&gt;&lt;h3 id=&quot;输入格式&quot;&gt;&lt;a href=&quot;#输入格式&quot; class=&quot;headerlink&quot; title=&quot;输入格式&quot;&gt;&lt;/a&gt;输入格式&lt;/h3&gt;&lt;p&gt;第一行包含两个整数 N 和 M。&lt;br&gt;接下来 M 行,每行两个整数 A 和 B,代表门控系统添加了一条无向边 (A, B)。&lt;/p&gt;
&lt;h3 id=&quot;输出格式&quot;&gt;&lt;a href=&quot;#输出格式&quot; class=&quot;headerlink&quot; title=&quot;输出格式&quot;&gt;&lt;/a&gt;输出格式&lt;/h3&gt;&lt;p&gt;输出一共 M 行,表示每次操作后的密码。&lt;br&gt;
    
    </summary>
    
      <category term="Problem Set" scheme="https://cothrax.github.io/categories/Problem-Set/"/>
    
    
      <category term="OI" scheme="https://cothrax.github.io/tags/OI/"/>
    
      <category term="并查集" scheme="https://cothrax.github.io/tags/%E5%B9%B6%E6%9F%A5%E9%9B%86/"/>
    
      <category term="数据结构" scheme="https://cothrax.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="图论" scheme="https://cothrax.github.io/tags/%E5%9B%BE%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title>NOIP模拟赛 2014-06-28</title>
    <link href="https://cothrax.github.io/2016/09/10/NOIP%E6%A8%A1%E6%8B%9F%E8%B5%9B-2014-06-28/"/>
    <id>https://cothrax.github.io/2016/09/10/NOIP模拟赛-2014-06-28/</id>
    <published>2016-09-10T07:05:25.000Z</published>
    <updated>2016-09-11T04:01:36.942Z</updated>
    
    <content type="html"><![CDATA[<p>三道图论题。</p>
<table>
<thead>
<tr>
<th>题目</th>
<th>思路</th>
</tr>
</thead>
<tbody>
<tr>
<td>魔术球问题弱化版</td>
<td>二分+最大流(匈牙利算法)</td>
</tr>
<tr>
<td>征兵</td>
<td>最大生成树</td>
</tr>
<tr>
<td>坑爹的GPS</td>
<td>三次最短路</td>
</tr>
</tbody>
</table>
<h1 id="P1-魔术球问题弱化版"><a href="#P1-魔术球问题弱化版" class="headerlink" title="P1 魔术球问题弱化版"></a>P1 魔术球问题弱化版</h1><p>假设有 n 根柱子,现要按下述规则在这 n 根柱子中依次放入编号为 1,2,3,…的球。</p>
<ol>
<li>每次只能在某根柱子的最上面放球。</li>
<li>在同一根柱子中,任何 2 个相邻球的编号之和为完全平方数。</li>
</ol>
<p>试设计一个算法,计算出在 n 根柱子上最多能放多少个球。例如,在 4 根柱子上最多可放 11 个球。<br>对于给定的 n,计算在 n 根柱子上最多能放多少个球。<br><a id="more"></a></p>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p>第 1 行有 1 个正整数 n,表示柱子数。</p>
<h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p>一行表示可以放的最大球数</p>
<h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>4</p>
</blockquote>
<h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>11</p>
</blockquote>
<h2 id="提示​"><a href="#提示​" class="headerlink" title="提示​"></a>提示​</h2><p>题目限制(为什么说弱化版就在这里)<br>N&lt;=60,时限为 3s;比起原题还有弱化在不用打出方案,方案太坑了</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>先二分答案，对于给定球数建图：如果i+j(i&lt;j)为完全平方数，从i向j连边。<br>然后求图上的<strong>最小路径覆盖数x</strong>，判断$x\leq n$<br>求DAG上的路径覆盖可以规约为求对应二分图的最大匹配，详见此处：<a href="http://www.cnblogs.com/justPassBy/p/5369930.html" target="_blank" rel="external">http://www.cnblogs.com/justPassBy/p/5369930.html</a><br>上述方法只适用于DAG</p>
<ol>
<li>二分图只能表示简单路径，环会被看成两条简单路径</li>
<li>连通无向图除非是树，必然有环。</li>
</ol>
<p>最好写的匈牙利算法，极限数据1.5s</p>
<dir style="text-align:right"><a href="/2016/09/10/NOIP模拟赛-2014-06-28/ball.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>ball.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">const</span> eps=<span class="number">0.00000000001</span>;</div><div class="line"><span class="keyword">type</span> </div><div class="line">    int=longint;</div><div class="line">    edge=<span class="keyword">record</span> f,t,next:int <span class="keyword">end</span>;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    g:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">200010</span>] <span class="keyword">of</span> edge;</div><div class="line">    head,match:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">4010</span>] <span class="keyword">of</span> int;</div><div class="line">    used:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">4010</span>] <span class="keyword">of</span> boolean;</div><div class="line">    n,l,r,mid,ans:int;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">add</span><span class="params">(f,t:int)</span>;</span></div><div class="line"><span class="keyword">var</span> m:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    inc(head[<span class="number">0</span>]);m:=head[<span class="number">0</span>];</div><div class="line">    g[m].f:=f;g[m].t:=t;</div><div class="line">    g[m].next:=head[f];head[f]:=m;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">dfs</span><span class="params">(v:int)</span>:</span>boolean;</div><div class="line"><span class="keyword">var</span> i,u:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    i:=head[v];</div><div class="line">    <span class="keyword">while</span> i&lt;&gt;<span class="number">0</span> <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        u:=g[i].t;</div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> used[u] <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            used[u]:=true;</div><div class="line">            <span class="keyword">if</span> (match[u]=<span class="number">0</span>) <span class="keyword">or</span> dfs(match[u]) <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">                match[u]:=v;match[v]:=u;</div><div class="line">                <span class="keyword">exit</span>(true);</div><div class="line">            <span class="keyword">end</span>;</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">        i:=g[i].next;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">exit</span>(false);</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">(x:int)</span>:</span>boolean;</div><div class="line"><span class="keyword">var</span> i,j,cnt:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    fillchar(head,sizeof(head),<span class="number">0</span>);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> x <span class="keyword">do</span></div><div class="line">        <span class="keyword">for</span> j:=i+<span class="number">1</span> <span class="keyword">to</span> x <span class="keyword">do</span></div><div class="line">            <span class="keyword">if</span> abs(sqrt(i+j)-round(sqrt(i+j)))&lt;eps <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">                add(i,j+x);add(j+x,i);</div><div class="line">            <span class="keyword">end</span>;</div><div class="line">    fillchar(match,[i]=<span class="number">0</span> <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            fillchar(used,sizeof(used),false);</div><div class="line">            <span class="keyword">if</span> dfs(i) <span class="keyword">then</span> inc(cnt);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">if</span> x-cnt&lt;=n <span class="keyword">then</span> check:=true <span class="keyword">else</span> check:=false;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'ball.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'ball.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n);</div><div class="line">    l:=<span class="number">1</span>;r:=<span class="number">2000</span>;</div><div class="line">    <span class="keyword">while</span> l&lt;=r <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        mid:=(l+r) <span class="keyword">shr</span> <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span> check(mid) <span class="keyword">then</span> <span class="keyword">begin</span> ans:=mid;l:=mid+<span class="number">1</span> <span class="keyword">end</span></div><div class="line">        <span class="keyword">else</span> r:=mid-<span class="number">1</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">write</span>(ans);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
<p>最大流比匈牙利快5倍。。。（可能是我写丑了）</p>
<dir style="text-align:right"><a href="/2016/09/10/NOIP模拟赛-2014-06-28/ball00.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>ball00.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">const</span> </div><div class="line">    eps=<span class="number">0.00000000001</span>;</div><div class="line">    inf=<span class="number">1000000000</span>;</div><div class="line"><span class="keyword">type</span> </div><div class="line">    int=longint;</div><div class="line">    edge=<span class="keyword">record</span> t,c,rev,next:int <span class="keyword">end</span>;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    g:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">200010</span>] <span class="keyword">of</span> edge;</div><div class="line">    head,d,iter,q:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">4020</span>] <span class="keyword">of</span> int;</div><div class="line">    n,l,r,mid,ans:int;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">add</span><span class="params">(f,t,c:int)</span>;</span></div><div class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">adde</span><span class="params">(f,t,c:int)</span>;</span></div><div class="line">    <span class="keyword">var</span> m:int;</div><div class="line">    <span class="keyword">begin</span></div><div class="line">        m:=head[<span class="number">0</span>];</div><div class="line">        g[m].t:=t;g[m].c:=c;</div><div class="line">        g[m].next:=head[f];head[f]:=m;</div><div class="line">        inc(head[<span class="number">0</span>]);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">begin</span> adde(f,t,c);adde(t,f,<span class="number">0</span>) <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bfs</span><span class="params">(s,t0:int)</span>:</span>boolean;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    h,t,i,v,u:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    fillchar(d,sizeof(d),<span class="number">255</span>);</div><div class="line">    h:=<span class="number">0</span>;t:=<span class="number">1</span>;q[h]:=s;d[s]:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> h&lt;&gt;t <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        v:=q[h];i:=head[v];</div><div class="line">        <span class="keyword">while</span> i&lt;&gt;<span class="number">0</span> <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">            u:=g[i].t;</div><div class="line">            <span class="keyword">if</span> (g[i].c&gt;<span class="number">0</span>) <span class="keyword">and</span> (d[u]=-<span class="number">1</span>) <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">                d[u]:=d[v]+<span class="number">1</span>;</div><div class="line">                q[t]:=u;</div><div class="line">                inc(t);<span class="keyword">if</span> t&gt;<span class="number">4020</span> <span class="keyword">then</span> t:=<span class="number">0</span>;</div><div class="line">            <span class="keyword">end</span>;</div><div class="line">            i:=g[i].next;</div><div class="line">        <span class="keyword">end</span>;    </div><div class="line">        inc(h);<span class="keyword">if</span> h&gt;<span class="number">4020</span> <span class="keyword">then</span> h:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    bfs:=d[t0]&lt;&gt;-<span class="number">1</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">dfs</span><span class="params">(v,t,f:int)</span>:</span>int;</div><div class="line"><span class="keyword">var</span> u,i,tmp:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">if</span> v=t <span class="keyword">then</span> <span class="keyword">exit</span>(f);</div><div class="line">    dfs:=<span class="number">0</span>;i:=iter[v];</div><div class="line">    <span class="keyword">while</span> i&lt;&gt;<span class="number">0</span> <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        u:=g[i].t;</div><div class="line">        <span class="keyword">if</span> (g[i].c&gt;<span class="number">0</span>) <span class="keyword">and</span> (d[u]=d[v]+<span class="number">1</span>) <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            tmp:=dfs(u,t,min(g[i].c,f-dfs));</div><div class="line">            dec(g[i].c,tmp);</div><div class="line">            <span class="keyword">if</span> g[i].c&gt;<span class="number">0</span> <span class="keyword">then</span> iter[v]:=i;</div><div class="line">            inc(g[i xor <span class="number">1</span>].c,tmp);</div><div class="line">            inc(dfs,tmp);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">        i:=g[i].next;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">if</span> dfs=<span class="number">0</span> <span class="keyword">then</span> d[i]:=-<span class="number">1</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">maxflow</span><span class="params">(s,t:int)</span>:</span>int;</div><div class="line"><span class="keyword">var</span> i:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    maxflow:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> bfs(s,t) <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> t <span class="keyword">do</span> iter[i]:=head[i];</div><div class="line">        inc(maxflow,dfs(s,t,inf));</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">(x:int)</span>:</span>boolean;</div><div class="line"><span class="keyword">var</span> i,j:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    fillchar(head,sizeof(head),<span class="number">0</span>);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> x <span class="keyword">do</span></div><div class="line">        <span class="keyword">for</span> j:=i+<span class="number">1</span> <span class="keyword">to</span> x <span class="keyword">do</span></div><div class="line">            <span class="keyword">if</span> abs(sqrt(i+j)-round(sqrt(i+j)))&lt;eps <span class="keyword">then</span></div><div class="line">                add(i,j+x,<span class="number">1</span>);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> x <span class="keyword">do</span> add(<span class="number">2</span>*x+<span class="number">1</span>,i,<span class="number">1</span>);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> x <span class="keyword">do</span> add(i+x,<span class="number">2</span>*x+<span class="number">2</span>,<span class="number">1</span>);</div><div class="line">    <span class="keyword">if</span> x-maxflow(<span class="number">2</span>*x+<span class="number">1</span>,<span class="number">2</span>*x+<span class="number">2</span>)&lt;=n <span class="keyword">then</span> check:=true </div><div class="line">    <span class="keyword">else</span> check:=false;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'ball.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'ball.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n);</div><div class="line">    l:=<span class="number">1</span>;r:=<span class="number">2000</span>;</div><div class="line">    <span class="keyword">while</span> l&lt;=r <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        mid:=(l+r) <span class="keyword">shr</span> <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span> check(mid) <span class="keyword">then</span> <span class="keyword">begin</span> ans:=mid;l:=mid+<span class="number">1</span> <span class="keyword">end</span></div><div class="line">        <span class="keyword">else</span> r:=mid-<span class="number">1</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">write</span>(ans);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
<p>其实二分图完全没有用dinic的必要，直接上ford-fulkerson就好了。</p>
<dir style="text-align:right"><a href="/2016/09/10/NOIP模拟赛-2014-06-28/ball0.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>ball0.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">const</span> </div><div class="line">    eps=<span class="number">0.00000000001</span>;</div><div class="line">    inf=<span class="number">1000000000</span>;</div><div class="line"><span class="keyword">type</span> </div><div class="line">    int=longint;</div><div class="line">    edge=<span class="keyword">record</span> f,t,c,next:int <span class="keyword">end</span>;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    g:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">200010</span>] <span class="keyword">of</span> edge;</div><div class="line">    head,flag:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">4020</span>] <span class="keyword">of</span> int;</div><div class="line">    n,l,r,cur,mid,ans:int;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">add</span><span class="params">(f,t,c:int)</span>;</span></div><div class="line">    <span class="function"><span class="keyword">procedure</span> <span class="title">adde</span><span class="params">(f,t,c:int)</span>;</span></div><div class="line">    <span class="keyword">var</span> m:int;</div><div class="line">    <span class="keyword">begin</span></div><div class="line">        m:=head[<span class="number">0</span>];</div><div class="line">        g[m].f:=f;g[m].t:=t;g[m].c:=c;</div><div class="line">        g[m].next:=head[f];head[f]:=m;</div><div class="line">        inc(head[<span class="number">0</span>]);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    adde(f,t,c);adde(t,f,<span class="number">0</span>);</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">dfs</span><span class="params">(s,t,f:int)</span>:</span>int;</div><div class="line"><span class="keyword">var</span> u,i,d:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">if</span> s=t <span class="keyword">then</span> <span class="keyword">exit</span>(f);</div><div class="line">    dfs:=<span class="number">0</span>;</div><div class="line">    flag[s]:=cur;</div><div class="line">    i:=head[s];</div><div class="line">    <span class="keyword">while</span> i&lt;&gt;<span class="number">0</span> <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        u:=g[i].t;</div><div class="line">        <span class="keyword">if</span> (flag[u]&lt;cur) <span class="keyword">and</span> (g[i].c&gt;<span class="number">0</span>) <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            d:=dfs(u,t,min(f-dfs,g[i].c));</div><div class="line">            <span class="keyword">if</span> d&gt;<span class="number">0</span> <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">                dec(g[i].c,d);</div><div class="line">                inc(g[i xor <span class="number">1</span>].c,d);</div><div class="line">                inc(dfs,d);</div><div class="line">            <span class="keyword">end</span>;</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">        i:=g[i].next;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">maxflow</span><span class="params">(s,t:int)</span>:</span>int;</div><div class="line"><span class="keyword">var</span> f:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    maxflow:=<span class="number">0</span>;</div><div class="line">    fillchar(flag,sizeof(flag),<span class="number">0</span>);cur:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> true <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        inc(cur);</div><div class="line">        f:=dfs(s,t,inf);</div><div class="line">        <span class="keyword">if</span> f=<span class="number">0</span> <span class="keyword">then</span> <span class="keyword">exit</span>(maxflow);</div><div class="line">        inc(maxflow,f);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">(x:int)</span>:</span>boolean;</div><div class="line"><span class="keyword">var</span> i,j:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    fillchar(head,sizeof(head),<span class="number">0</span>);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> x <span class="keyword">do</span></div><div class="line">        <span class="keyword">for</span> j:=i+<span class="number">1</span> <span class="keyword">to</span> x <span class="keyword">do</span></div><div class="line">            <span class="keyword">if</span> abs(sqrt(i+j)-round(sqrt(i+j)))&lt;eps <span class="keyword">then</span></div><div class="line">                add(i,j+x,<span class="number">1</span>);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> x <span class="keyword">do</span> add(<span class="number">2</span>*x+<span class="number">1</span>,i,<span class="number">1</span>);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> x <span class="keyword">do</span> add(i+x,<span class="number">2</span>*x+<span class="number">2</span>,<span class="number">1</span>);</div><div class="line">    <span class="keyword">if</span> x-maxflow(<span class="number">2</span>*x+<span class="number">1</span>,<span class="number">2</span>*x+<span class="number">2</span>)&lt;=n <span class="keyword">then</span> check:=true </div><div class="line">    <span class="keyword">else</span> check:=false;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'ball.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'ball.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n);</div><div class="line">    l:=<span class="number">1</span>;r:=<span class="number">2000</span>;</div><div class="line">    <span class="keyword">while</span> l&lt;=r <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        mid:=(l+r) <span class="keyword">shr</span> <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span> check(mid) <span class="keyword">then</span> <span class="keyword">begin</span> ans:=mid;l:=mid+<span class="number">1</span> <span class="keyword">end</span></div><div class="line">        <span class="keyword">else</span> r:=mid-<span class="number">1</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">write</span>(ans);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
<h1 id="P2-征兵"><a href="#P2-征兵" class="headerlink" title="P2 征兵"></a>P2 征兵</h1><p>一个国王,他拥有一个国家。最近他因为国库里钱太多了,闲着蛋疼要征集一只部队要保卫<br>国家。他选定了 N 个女兵和 M 个男兵,但事实上每征集一个兵他就要花 10000RMB,即使国库<br>里钱再多也伤不起啊。他发现,某男兵和某女兵之间有某种关系(往正常方面想,一共 R 种<br>关系),这种关系可以使 KING 少花一些钱就可以征集到兵,不过国王也知道,在征兵的时候,<br>每一个兵只能使用一种关系来少花钱。这时国王向你求助,问他最少要花多少的钱。</p>
<h2 id="格式-1"><a href="#格式-1" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式-1"><a href="#输入格式-1" class="headerlink" title="输入格式"></a>输入格式</h3><p>第一行:T,一共 T 组数据。<br>接下来 T 组数据,<br>第一行包括 N,M,R<br>接下来的 R 行 包括 Xi,Yi,Vi 表示如果招了第 Xi 个女兵,再招第 Yi 个男兵能省 Vi 元(同样表示如果招了第 Yi 个男兵,再招第 Xi 个女兵能也省 Vi 元)</p>
<h3 id="输出格式-1"><a href="#输出格式-1" class="headerlink" title="输出格式"></a>输出格式</h3><p>共 T 行,表示每组数据的最终花费是多少(因为国库里的钱只有 2^31-1,所以保证最终花费在 maxlongint 范围内)</p>
<h2 id="样例-1"><a href="#样例-1" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入-1"><a href="#样例输入-1" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>2<br>5 5 8<br>4 3 6831<br>1 3 4583<br>0 0 6592<br>0 1 3063<br>3 3 4975<br>1 3 2049<br>4 2 2104<br>2 2 781<br>5 5 10<br>2 4 9820<br>3 2 6236<br>3 1 8864<br>2 4 8326<br>2 0 5156<br>2 0 1463<br>4 1 2439<br>0 4 4373<br>3 4 8889<br>2 4 3133</p>
</blockquote>
<h3 id="样例输出-1"><a href="#样例输出-1" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>71071<br>54223</p>
</blockquote>
<h2 id="提示​-1"><a href="#提示​-1" class="headerlink" title="提示​"></a>提示​</h2><p>数据范围<br>数据保证 T&lt;=5 ,m,n&lt;=10000,r&lt;=50000,Xi&lt;=m,Yi&lt;=n,Vi&lt;=10000,结果&lt;=2^31-1</p>
<h2 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h2><p>最大生成树</p>
<dir style="text-align:right"><a href="/2016/09/10/NOIP模拟赛-2014-06-28/conscription.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>conscription.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> </div><div class="line">    int=longint;</div><div class="line">    edge=<span class="keyword">record</span> f,t,w:int <span class="keyword">end</span>;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    g:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">50010</span>] <span class="keyword">of</span> edge;</div><div class="line">    par:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">20010</span>] <span class="keyword">of</span> int;</div><div class="line">    n,m,r,i,t:int;ans:int64;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">qsort</span><span class="params">(l,r:int)</span>;</span></div><div class="line"><span class="keyword">var</span> i,j,x:int;tmp:edge;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    i:=l;j:=r;x:=g[random(r-l)+l].w;</div><div class="line">    <span class="keyword">repeat</span></div><div class="line">        <span class="keyword">while</span> g[i].w&gt;x <span class="keyword">do</span> inc(i);</div><div class="line">        <span class="keyword">while</span> g[j].w&lt;x <span class="keyword">do</span> dec(j);</div><div class="line">        <span class="keyword">if</span> i&lt;=j <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            tmp:=g[i];g[i]:=g[j];g[j]:=tmp;</div><div class="line">            inc(i);dec(j);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">until</span> i&gt;j;</div><div class="line">    <span class="keyword">if</span> i&lt;r <span class="keyword">then</span> qsort(i,r);</div><div class="line">    <span class="keyword">if</span> l&lt;j <span class="keyword">then</span> qsort(l,j);</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">find</span><span class="params">(x:int)</span>:</span>int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">if</span> par[x]=x <span class="keyword">then</span> find:=x</div><div class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></div><div class="line">        par[x]:=find(par[x]);</div><div class="line">        find:=par[x];</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">union</span><span class="params">(x,y:int)</span>;</span></div><div class="line"><span class="keyword">begin</span> x:=find(x);y:=find(y);par[x]:=y <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">same</span><span class="params">(x,y:int)</span>:</span>boolean;</div><div class="line"><span class="keyword">begin</span> same:=find(x)=find(y) <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">read</span>(t);</div><div class="line">    <span class="keyword">repeat</span></div><div class="line">        </div><div class="line">        <span class="keyword">read</span>(n,m,r);</div><div class="line">        <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> r <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">            <span class="keyword">read</span>(g[i].f,g[i].t,g[i].w);</div><div class="line">            inc(g[i].t,n);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">        <span class="keyword">for</span> i:=<span class="number">0</span> <span class="keyword">to</span> n+m-<span class="number">1</span> <span class="keyword">do</span> par[i]:=i;</div><div class="line">        qsort(<span class="number">1</span>,r);ans:=<span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> r <span class="keyword">do</span></div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> same(g[i].f,g[i].t) <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">                union(g[i].f,g[i].t);</div><div class="line">                inc(ans,g[i].w);</div><div class="line">            <span class="keyword">end</span>;</div><div class="line">        writeln((n+m)*<span class="number">10000</span>-ans);</div><div class="line">        dec(t);</div><div class="line">    <span class="keyword">until</span> t=<span class="number">0</span>;</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
<h1 id="P3-坑爹的-GPS"><a href="#P3-坑爹的-GPS" class="headerlink" title="P3 坑爹的 GPS"></a>P3 坑爹的 GPS</h1><p>有一天,FJ 买了一辆车,但是,他一手下载了两个 GPS 系统。好了现在麻烦的事情来了,GPS有一个功能大概大家也知道,如果 FJ 没有按照 GPS 内置地图的最短路走,GPS 就会报错来骚扰你。现在 FJ 准备从他的农舍(在 1 这个点)开车到他的谷屋(n 这个点)。FJ 给了你两个<br>GPS 系统内置地图的信息,他想知道,他最少会听到多少次报错(如果 FJ 走的路同时不满足两个 GPS,报错次数+2)</p>
<h2 id="格式-2"><a href="#格式-2" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式-2"><a href="#输入格式-2" class="headerlink" title="输入格式"></a>输入格式</h3><p>第一行:n,k;n 表示有 FJ 的谷屋在哪,同时保证 GPS 内置地图里的点没有超过 n 的点。K 表示 GPS 内置地图里的路有多少条,如果两个点没有连接则表明这不是一条通路。接下来 k 行,每行 4 个数 X,Y,A,B 分别表示从 X 到 Y 在第一个 GPS 地图里的距离是 A,在第二个 GPS 地图里的是 B。注意由于地形的其他因素 GPS 给出的边是有向边。</p>
<h3 id="输出格式-2"><a href="#输出格式-2" class="headerlink" title="输出格式"></a>输出格式</h3><p>输出:一个值,表示 FJ 最少听到的报错次数。</p>
<h2 id="样例-2"><a href="#样例-2" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入-2"><a href="#样例输入-2" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>5 7<br>3 4 7 1<br>1 3 2 20<br>1 4 17 18<br>4 5 25 3<br>1 2 10 13 5 4 14<br>2 4 6 5</p>
</blockquote>
<h3 id="样例输出-2"><a href="#样例输出-2" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>1</p>
</blockquote>
<h2 id="提示​-2"><a href="#提示​-2" class="headerlink" title="提示​"></a>提示​</h2><p>FJ 选择的路线是 1 2 4 5,但是 GPS 1 认为的最短路是 1 到 3,所以报错一次,对于剩下的2 4 5,两个 GPS 都不会报错。<br>数据范围<br>N&lt;=10000,至于路有多少条自己算吧。数据保证所有的距离都在 2^31-1 以内。</p>
<h2 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h2><p>三次最短路：</p>
<ol>
<li>第一个gps从终点反向spfa</li>
<li>第二个gps同理</li>
<li>扫一边所有边构图，边权为该边的报错次数（0..2)，从起点spfa</li>
</ol>
<dir style="text-align:right"><a href="/2016/09/10/NOIP模拟赛-2014-06-28/gpsduel.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>gpsduel.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">const</span> inf=<span class="number">1000000000</span>;</div><div class="line"><span class="keyword">type</span> </div><div class="line">    int=longint;</div><div class="line">    edge=<span class="keyword">record</span> f,t,w,next:int <span class="keyword">end</span>;</div><div class="line">    graph=<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">50010</span>] <span class="keyword">of</span> edge;</div><div class="line">    arr=<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">10010</span>] <span class="keyword">of</span> int;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    ga,gb,g:graph;</div><div class="line">    ha,hb,head,da,db,q:arr;</div><div class="line">    inq:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">10010</span>] <span class="keyword">of</span> boolean;</div><div class="line">    n,m,i,cnt,f0,t0,a0,b0:int;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">add</span><span class="params">(<span class="keyword">var</span> g:graph;<span class="keyword">var</span> head:arr;f0,t0,w0:int)</span>;</span></div><div class="line"><span class="keyword">var</span> m:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    inc(head[<span class="number">0</span>]);m:=head[<span class="number">0</span>];</div><div class="line">    g[m].f:=f0;g[m].t:=t0;g[m].w:=w0;</div><div class="line">    g[m].next:=head[f0];head[f0]:=m;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">spfa</span><span class="params">(g:graph;head:arr;x:int;<span class="keyword">var</span> d:arr)</span>;</span></div><div class="line"><span class="keyword">var</span> h,t,i,v,u:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    fillchar(inq,sizeof(inq),false);</div><div class="line">    filldword(d,sizeof(d) <span class="keyword">div</span> <span class="number">4</span>,inf);</div><div class="line">    h:=<span class="number">1</span>;t:=<span class="number">2</span>;q[h]:=x;d[x]:=<span class="number">0</span>;inq[x]:=true;</div><div class="line">    <span class="keyword">while</span> h&lt;&gt;t <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        v:=q[h];i:=head[v];</div><div class="line">        <span class="keyword">while</span> i&lt;&gt;<span class="number">0</span> <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">            u:=g[i].t;</div><div class="line">            <span class="keyword">if</span> d[u]&gt;d[v]+g[i].w <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">                d[u]:=d[v]+g[i].w;</div><div class="line">                <span class="keyword">if</span> <span class="keyword">not</span> inq[u] <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">                    inq[u]:=true;q[t]:=u;</div><div class="line">                    inc(t);<span class="keyword">if</span> t&gt;<span class="number">10010</span> <span class="keyword">then</span> t:=<span class="number">0</span>;</div><div class="line">                <span class="keyword">end</span>;</div><div class="line">            <span class="keyword">end</span>;</div><div class="line">            i:=g[i].next;</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">        inq[v]:=false;</div><div class="line">        inc(h);<span class="keyword">if</span> h&gt;<span class="number">10010</span> <span class="keyword">then</span> h:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'gpsduel.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'gpsduel.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n,m);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> m <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(f0,t0,a0,b0);</div><div class="line">        add(ga,ha,t0,f0,a0);</div><div class="line">        add(gb,hb,t0,f0,b0);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    spfa(ga,ha,n,da);spfa(gb,hb,n,db);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> m <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        cnt:=<span class="number">2</span>;</div><div class="line">        <span class="keyword">if</span> da[ga[i].t]=da[ga[i].f]+ga[i].w <span class="keyword">then</span> dec(cnt);</div><div class="line">        <span class="keyword">if</span> db[gb[i].t]=db[gb[i].f]+gb[i].w <span class="keyword">then</span> dec(cnt);</div><div class="line">        add(g,head,ga[i].t,gb[i].f,cnt);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    spfa(g,head,<span class="number">1</span>,da);</div><div class="line">    <span class="keyword">write</span>(da[n]);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;三道图论题。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;题目&lt;/th&gt;
&lt;th&gt;思路&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;魔术球问题弱化版&lt;/td&gt;
&lt;td&gt;二分+最大流(匈牙利算法)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;征兵&lt;/td&gt;
&lt;td&gt;最大生成树&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;坑爹的GPS&lt;/td&gt;
&lt;td&gt;三次最短路&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&quot;P1-魔术球问题弱化版&quot;&gt;&lt;a href=&quot;#P1-魔术球问题弱化版&quot; class=&quot;headerlink&quot; title=&quot;P1 魔术球问题弱化版&quot;&gt;&lt;/a&gt;P1 魔术球问题弱化版&lt;/h1&gt;&lt;p&gt;假设有 n 根柱子,现要按下述规则在这 n 根柱子中依次放入编号为 1,2,3,…的球。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;每次只能在某根柱子的最上面放球。&lt;/li&gt;
&lt;li&gt;在同一根柱子中,任何 2 个相邻球的编号之和为完全平方数。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;试设计一个算法,计算出在 n 根柱子上最多能放多少个球。例如,在 4 根柱子上最多可放 11 个球。&lt;br&gt;对于给定的 n,计算在 n 根柱子上最多能放多少个球。&lt;br&gt;
    
    </summary>
    
      <category term="Problem Set" scheme="https://cothrax.github.io/categories/Problem-Set/"/>
    
    
      <category term="OI" scheme="https://cothrax.github.io/tags/OI/"/>
    
      <category term="图论" scheme="https://cothrax.github.io/tags/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="最短路" scheme="https://cothrax.github.io/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF/"/>
    
      <category term="生成树" scheme="https://cothrax.github.io/tags/%E7%94%9F%E6%88%90%E6%A0%91/"/>
    
      <category term="网络流" scheme="https://cothrax.github.io/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
      <category term="最大流" scheme="https://cothrax.github.io/tags/%E6%9C%80%E5%A4%A7%E6%B5%81/"/>
    
      <category term="二分图" scheme="https://cothrax.github.io/tags/%E4%BA%8C%E5%88%86%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>NOIP模拟赛 2014-7-18</title>
    <link href="https://cothrax.github.io/2016/09/08/NOIP%E6%A8%A1%E6%8B%9F%E8%B5%9B-2014-7-18/"/>
    <id>https://cothrax.github.io/2016/09/08/NOIP模拟赛-2014-7-18/</id>
    <published>2016-09-08T07:37:45.000Z</published>
    <updated>2016-09-10T14:14:32.444Z</updated>
    
    <content type="html"><![CDATA[<p>一共五道题，有一道裸的二分和一个树形背包没有写。</p>
<table>
<thead>
<tr>
<th>题目</th>
<th>思路</th>
</tr>
</thead>
<tbody>
<tr>
<td>czy的后宫3</td>
<td>无修改莫队/各种数据结构</td>
</tr>
<tr>
<td>czy的后宫4</td>
<td>坑爹dp</td>
</tr>
<tr>
<td>蒟蒻czy又被D飞了</td>
<td>变形背包</td>
</tr>
</tbody>
</table>
<h1 id="P1-czy的后宫4"><a href="#P1-czy的后宫4" class="headerlink" title="P1 czy的后宫4"></a>P1 czy的后宫4</h1><p>上次czy在机房妥善安排了他的后宫之后，他发现可以将他的妹子分为c种，他经常会考虑这样一个问题：在[l,r]的妹子中间，能挑选出多少不同类型的妹子呢？<br>注意：由于czy非常丧尸，所以他要求在所挑选的妹子类型在[l,r]中出现次数为正偶数，你懂得。<br>问题简述:n个数，m次询问，每次问[l,r]区间有多少个数恰好出现正偶数次<br><a id="more"></a></p>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p>第一行3个整数，表示n,c,m<br>第二行n个数，每个数Ai在[1,c]之间，表示一个Ai类型的妹子<br>接下来m行，每行两个整数l,r，表示询问[l,r]这个区间的答案</p>
<h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p>有m行，表示第i次询问的答案</p>
<h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>5 5 3<br>1 1 2 2 3<br>1 5<br>3 4<br>2 3</p>
</blockquote>
<h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>2<br>1<br>0</p>
</blockquote>
<h2 id="提示​"><a href="#提示​" class="headerlink" title="提示​"></a>提示​</h2><p>共有10组测试数据<br>1-4组n,m=500，2000，5000，10000，c=1000<br>5-7组n,m=20000，30000，40000，c=10000<br>8-10组n,m=50000，80000，100000，c=100000<br>数据保证随机生成</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>离线做，裸的无修改莫队</p>
<dir style="text-align:right"><a href="/2016/09/08/NOIP模拟赛-2014-7-18/harem.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>harem.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    n,m,k,b,i,j,l,r,tot:int;</div><div class="line">    q:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">100010</span>,<span class="number">0</span>..<span class="number">3</span>] <span class="keyword">of</span> int;</div><div class="line">    a,ans,cnt:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">100010</span>] <span class="keyword">of</span> int;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">com</span><span class="params">(i,j:int)</span>:</span>boolean;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    com:=(q[i,<span class="number">3</span>]&lt;q[j,<span class="number">3</span>]) <span class="keyword">or</span> ((q[i,<span class="number">3</span>]=q[j,<span class="number">3</span>]) <span class="keyword">and</span> (q[i,<span class="number">2</span>]&lt;q[j,<span class="number">2</span>]));</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">qsort</span><span class="params">(l,r:int)</span>;</span></div><div class="line"><span class="keyword">var</span> </div><div class="line">    tmp:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">3</span>] <span class="keyword">of</span> int;</div><div class="line">    i,j:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    i:=l;j:=r;q[<span class="number">0</span>]:=q[random(r-l)+l];</div><div class="line">    <span class="keyword">repeat</span></div><div class="line">        <span class="keyword">while</span> com(i,<span class="number">0</span>) <span class="keyword">do</span> inc(i);</div><div class="line">        <span class="keyword">while</span> com(<span class="number">0</span>,j) <span class="keyword">do</span> dec(j);</div><div class="line">        <span class="keyword">if</span> i&lt;=j <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            tmp:=q[i];q[i]:=q[j];q[j]:=tmp;</div><div class="line">            inc(i);dec(j);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">until</span> i&gt;j;</div><div class="line">    <span class="keyword">if</span> i&lt;r <span class="keyword">then</span> qsort(i,r);</div><div class="line">    <span class="keyword">if</span> l&lt;j <span class="keyword">then</span> qsort(l,j);</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">update</span><span class="params">(i,x:int)</span>;</span></div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> odd(cnt[i]) <span class="keyword">and</span> (cnt[i]&lt;&gt;<span class="number">0</span>) <span class="keyword">then</span> dec(tot);</div><div class="line">    inc(cnt[i],x);</div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> odd(cnt[i]) <span class="keyword">and</span> (cnt[i]&lt;&gt;<span class="number">0</span>) <span class="keyword">then</span> inc(tot);</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'harem.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'harem.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n,k,m);b:=floor(sqrt(n));</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">read</span>(a[i]);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> m <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(q[i,<span class="number">1</span>],q[i,<span class="number">2</span>]);</div><div class="line">        q[i,<span class="number">0</span>]:=i;</div><div class="line">        q[i,<span class="number">3</span>]:=(q[i,<span class="number">1</span>]-<span class="number">1</span>) <span class="keyword">div</span> b+<span class="number">1</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    qsort(<span class="number">1</span>,m);</div><div class="line">    l:=<span class="number">1</span>;r:=<span class="number">0</span>;tot:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> m <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">for</span> j:=r+<span class="number">1</span> <span class="keyword">to</span> q[i,<span class="number">2</span>] <span class="keyword">do</span> update(a[j],<span class="number">1</span>);</div><div class="line">        <span class="keyword">for</span> j:=r <span class="keyword">downto</span> q[i,<span class="number">2</span>]+<span class="number">1</span> <span class="keyword">do</span> update(a[j],-<span class="number">1</span>);</div><div class="line">        <span class="keyword">for</span> j:=l <span class="keyword">to</span> q[i,<span class="number">1</span>]-<span class="number">1</span> <span class="keyword">do</span> update(a[j],-<span class="number">1</span>);</div><div class="line">        <span class="keyword">for</span> j:=l-<span class="number">1</span> <span class="keyword">downto</span> q[i,<span class="number">1</span>] <span class="keyword">do</span> update(a[j],<span class="number">1</span>);</div><div class="line">        l:=q[i,<span class="number">1</span>];r:=q[i,<span class="number">2</span>];</div><div class="line">        ans[q[i,<span class="number">0</span>]]:=tot;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> m <span class="keyword">do</span> writeln(ans[i]);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
<h1 id="P2-czy的后宫4"><a href="#P2-czy的后宫4" class="headerlink" title="P2 czy的后宫4"></a>P2 czy的后宫4</h1><p>czy有很多妹子，妹子虽然数量很多，但是质量不容乐观，她们的美丽值全部为负数（喜闻乐见）。<br>czy每天都要带N个妹子到机房，她们都有一个独一无二的美丽值，美丽值为-1到-N之间的整数。他想要把这些妹子排成一个波动序列，这样相对“漂亮”（美丽值的绝对值较小）的妹子可以与她旁边的两个美丽值的绝对值较大的妹子形成鲜明的对比，整个序列相对将更加“美观”（不再那么无法直视）。<br>一个序列是波动序列仅当序列中的每个数比周围的两个数都大或都小（如果有的话）。<br>现在czy希望知道，长度为N的波动序列有多少种。两种序列A和B不同当且仅当存在一个i，使得Ai≠Bi。由于这个数目可能很大，你只对它除以P的余数感兴趣。</p>
<h2 id="格式-1"><a href="#格式-1" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式-1"><a href="#输入格式-1" class="headerlink" title="输入格式"></a>输入格式</h3><p>输入文件czy.in仅含一行，两个正整数N, P。</p>
<h3 id="输出格式-1"><a href="#输出格式-1" class="headerlink" title="输出格式"></a>输出格式</h3><p>输出文件czy.out仅含一行，一个非负整数，表示你所求的答案对P取余之后的结果。<br><!--more--></p>
<h2 id="样例-1"><a href="#样例-1" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入-1"><a href="#样例输入-1" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>4 7</p>
</blockquote>
<h3 id="样例输出-1"><a href="#样例输出-1" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>3</p>
</blockquote>
<h2 id="提示​-1"><a href="#提示​-1" class="headerlink" title="提示​"></a>提示​</h2><p>说明：共有10种可能的序列，它们是：  1324 1423 2143 2314 2413  3142 3241 3412 4132 4231<br>(忽略负号)<br>【数据规模和约定】<br>对于20%的数据，满足N≤10；<br>对于40%的数据，满足N≤18；<br>对于70%的数据，满足N≤550；<br>对于100%的数据，满足3≤N≤4200，P≤10^9。</p>
<h2 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h2><p>异常坑的dp：</p>
<ol>
<li><p>$f[i,j]$：<span>$a{1..i}$</span><!-- Has MathJax -->的序列以$x\in[1..i]$开头，且<span>$a_1&lt;a_2$</span><!-- Has MathJax -->（序列第一个<strong>上升</strong>）的方案数</p>
</li>
<li><p><span>$g[i,j]$</span><!-- Has MathJax -->：<span>$a{1..i}$</span><!-- Has MathJax -->的序列以$x\in[j..i]$开头，且<span>$a_1&gt;a_2$</span><!-- Has MathJax -->（序列第一个<strong>下降</strong>）的方案数</p>
</li>
</ol>
<p>结论：$$f[i,j]=f[i,j-1]+g[i-1,j]$$</p>
<ol>
<li>$f[i,j-1]$：把$1..j-1$开头的方案加上去</li>
<li>$g[i-1,j]$：考虑序列以j开头，要求<span>$a_2&gt;j$</span><!-- Has MathJax -->，则<span>$a_2\in[j+1,i]$</span><!-- Has MathJax -->，从<span>$a_2$</span><!-- Has MathJax -->开始是上升序列，j已经用掉了，剩下<span>$\{1..j-1,j+1..i\}$</span><!-- Has MathJax -->离散为<span>$\{1..i-1\}$</span><!-- Has MathJax -->，原来的j+1离散为1..i-1中的j，所以方案数为$g[i-1,j]$</li>
</ol>
<p>f和g是对称的：考虑将f的一个序列a中的$a_i$换成$i-a_i+1$，就对应g中的一个序列。</p>
<p>于是：$$f[i,j]=f[i,j-1]+f[i-1,i-j]$$</p>
<dir style="text-align:right"><a href="/2016/09/08/NOIP模拟赛-2014-7-18/czy.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>czy.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    n,i,j,c,p:int;</div><div class="line">    f:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">1</span>,<span class="number">0</span>..<span class="number">4210</span>] <span class="keyword">of</span> int;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'czy.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'czy.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n,p);</div><div class="line">    <span class="keyword">if</span> n=<span class="number">1</span> <span class="keyword">then</span> <span class="keyword">begin</span> <span class="keyword">write</span>(<span class="number">1</span>);halt <span class="keyword">end</span>;</div><div class="line">    f[<span class="number">1</span>,<span class="number">1</span>]:=<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">2</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        c:=i <span class="keyword">and</span> <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span> j:=<span class="number">1</span> <span class="keyword">to</span> i <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">            f[c,j]:=f[c,j-<span class="number">1</span>]+f[c xor <span class="number">1</span>,i-j];</div><div class="line">            <span class="keyword">if</span> f[c,j]&gt;p <span class="keyword">then</span> f[c,j]:=f[c,j] <span class="keyword">mod</span> p;</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">write</span>(f[n <span class="keyword">and</span> <span class="number">1</span>,n]*<span class="number">2</span> <span class="keyword">mod</span> p);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
<h1 id="P5-蒟蒻czy又被D飞了"><a href="#P5-蒟蒻czy又被D飞了" class="headerlink" title="P5 蒟蒻czy又被D飞了"></a>P5 蒟蒻czy又被D飞了</h1><p>机房里的各路巨神天天D蒟蒻CZY，早已是他们的日常任务了。（今天的机房也是很和平呢）<br>这一次他们安排好了一种方式来D蒟蒻Czy。每个人每次都能把Czy D飞一个高度（让Czy的高度+a[i]），由于他们的精力有限，要保留体力应对接下来的战斗，所以他们每个人只会D Czy k[i]次。由于他们每个人的D人能力不同，各有所长，所以他们每个人都在Czy到一定高度h[i]以后良心发现，任由Czy自生自灭，回去玩达尔文进化岛了。<br>所以Czy想知道他的速度是否能达到第二宇宙速度，离开这个可怕的地方。但是Czy太弱了，所以这个问题就交给了未来集训队的你。但是你这么吊，哪里屑解答Czy蒟蒻的问题。于是你打算只告诉他最高会飞到什么高度，让他自己算自己的速度去。</p>
<h2 id="格式-2"><a href="#格式-2" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式-2"><a href="#输入格式-2" class="headerlink" title="输入格式"></a>输入格式</h3><p>第1行：1个整数N（1&lt;=N&lt;=100）N表示机房里有多少人今天要D 蒟蒻Czy<br>接下里N行，每行描述一个神犇的信息  a[i] h[i] k[i]</p>
<h3 id="输出格式-2"><a href="#输出格式-2" class="headerlink" title="输出格式"></a>输出格式</h3><p>第1行：1个整数H，表示Czy最高会被神犇们D到哪里去<br><!--more--></p>
<h2 id="样例-2"><a href="#样例-2" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入-2"><a href="#样例输入-2" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>7<br>8 35 1<br>5 35 1<br>15 35 1<br>8 35 1<br>10 35 1<br>4 35 1<br>2 35 1</p>
</blockquote>
<h3 id="样例输出-2"><a href="#样例输出-2" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>35</p>
</blockquote>
<h2 id="提示​-2"><a href="#提示​-2" class="headerlink" title="提示​"></a>提示​</h2><p>对于100%的数据  1&lt;=k[i]&lt;=30，1&lt;=h[i]&lt;=10000,  1&lt;=a[i]&lt;=200 </p>
<h2 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h2><p>带限制的背包</p>
<dir style="text-align:right"><a href="/2016/09/08/NOIP模拟赛-2014-7-18/fly.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>fly.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    f:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">15010</span>] <span class="keyword">of</span> boolean;</div><div class="line">    g:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">15010</span>] <span class="keyword">of</span> int;</div><div class="line">    a,k,h:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">110</span>] <span class="keyword">of</span> int;</div><div class="line">    n,i,j,ans:int;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">swap</span><span class="params">(<span class="keyword">var</span> a,b:int)</span>;</span></div><div class="line"><span class="keyword">var</span> tmp:int;</div><div class="line"><span class="keyword">begin</span> tmp:=a;a:=b;b:=tmp <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">qsort</span><span class="params">(l,r:int)</span>;</span></div><div class="line"><span class="keyword">var</span> i,j,x:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    i:=l;j:=r;x:=h[random(r-l)+l];</div><div class="line">    <span class="keyword">repeat</span></div><div class="line">        <span class="keyword">while</span> h[i]&lt;x <span class="keyword">do</span> inc(i);</div><div class="line">        <span class="keyword">while</span> h[j]&gt;x <span class="keyword">do</span> dec(j);</div><div class="line">        <span class="keyword">if</span> i&lt;=j <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            swap(a[i],a[j]);</div><div class="line">            swap(h[i],h[j]);</div><div class="line">            swap(k[i],k[j]);</div><div class="line">            inc(i);dec(j);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">until</span> i&gt;j;</div><div class="line">    <span class="keyword">if</span> i&lt;r <span class="keyword">then</span> qsort(i,r);</div><div class="line">    <span class="keyword">if</span> l&lt;j <span class="keyword">then</span> qsort(l,j);</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'fly.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'fly.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">read</span>(a[i],h[i],k[i]);</div><div class="line">    qsort(<span class="number">1</span>,n);</div><div class="line">    fillchar(f,sizeof(f),false);</div><div class="line">    f[<span class="number">0</span>]:=true;ans:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        fillchar(g,sizeof(g),<span class="number">0</span>);</div><div class="line">        <span class="keyword">for</span> j:=a[i] <span class="keyword">to</span> h[i] <span class="keyword">do</span></div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> f[j] <span class="keyword">and</span> f[j-a[i]] <span class="keyword">and</span> </div><div class="line">                (g[j-a[i]]&lt;k[i]) <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">                f[j]:=true;</div><div class="line">                g[j]:=g[j-a[i]]+<span class="number">1</span>;</div><div class="line">                ans:=max(ans,j);            </div><div class="line">            <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">write</span>(ans);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;一共五道题，有一道裸的二分和一个树形背包没有写。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;题目&lt;/th&gt;
&lt;th&gt;思路&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;czy的后宫3&lt;/td&gt;
&lt;td&gt;无修改莫队/各种数据结构&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;czy的后宫4&lt;/td&gt;
&lt;td&gt;坑爹dp&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;蒟蒻czy又被D飞了&lt;/td&gt;
&lt;td&gt;变形背包&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&quot;P1-czy的后宫4&quot;&gt;&lt;a href=&quot;#P1-czy的后宫4&quot; class=&quot;headerlink&quot; title=&quot;P1 czy的后宫4&quot;&gt;&lt;/a&gt;P1 czy的后宫4&lt;/h1&gt;&lt;p&gt;上次czy在机房妥善安排了他的后宫之后，他发现可以将他的妹子分为c种，他经常会考虑这样一个问题：在[l,r]的妹子中间，能挑选出多少不同类型的妹子呢？&lt;br&gt;注意：由于czy非常丧尸，所以他要求在所挑选的妹子类型在[l,r]中出现次数为正偶数，你懂得。&lt;br&gt;问题简述:n个数，m次询问，每次问[l,r]区间有多少个数恰好出现正偶数次&lt;br&gt;
    
    </summary>
    
      <category term="Problem Set" scheme="https://cothrax.github.io/categories/Problem-Set/"/>
    
    
      <category term="OI" scheme="https://cothrax.github.io/tags/OI/"/>
    
      <category term="数据结构" scheme="https://cothrax.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="DP" scheme="https://cothrax.github.io/tags/DP/"/>
    
      <category term="背包" scheme="https://cothrax.github.io/tags/%E8%83%8C%E5%8C%85/"/>
    
      <category term="离线" scheme="https://cothrax.github.io/tags/%E7%A6%BB%E7%BA%BF/"/>
    
      <category term="莫队" scheme="https://cothrax.github.io/tags/%E8%8E%AB%E9%98%9F/"/>
    
  </entry>
  
  <entry>
    <title>NOIP模拟赛 混合图</title>
    <link href="https://cothrax.github.io/2016/09/06/NOIP%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E6%B7%B7%E5%90%88%E5%9B%BE/"/>
    <id>https://cothrax.github.io/2016/09/06/NOIP模拟赛-混合图/</id>
    <published>2016-09-06T15:19:03.000Z</published>
    <updated>2016-09-06T15:30:51.730Z</updated>
    
    <content type="html"><![CDATA[<h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>Hzwer神犇最近又征服了一个国家，然后接下来却也遇见了一个难题。<br>Hzwer的国家有n个点，m条边，而作为国王，他十分喜欢游览自己的国家。他一般会从任意一个点出发，随便找边走，沿途欣赏路上的美景。但是我们的Hzwer是一个奇怪的人，他不喜欢走到自己以前走过的地方，他的国家本来有p1条有向边，p2条无向边，由于国王奇怪的爱好，他觉得整改所有无向边，使得他们变成有向边，要求整改完以后保证他的国家不可能出现从某个地点出发顺着路走一圈又回来的情况。（注:m=p1+p2.）<br>概述:给你一张混合图，要求你为无向图定向，使得图上没有环。</p>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p>第一行3个整数 n,p1,p2，分别表示点数，有向边的数量，无向边的数量。<br>第二行起输入p1行，每行2个整数 a,b 表示a到b有一条有向边。<br>接下来输入p2行,每行2个整数 a,b 表示a和b中间有一条无向边。</p>
<h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p>对于每条无向边，我们要求按输入顺序输出你定向的结果，也就是如果你输出a b，那表示你将a和b中间的无向边定向为a-&gt;b。<br>注意，也许存在很多可行的解。你只要输出其中任意一个就好。<br><a id="more"></a></p>
<h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>4 2 3<br>1 2<br>4 3<br>1 3<br>4 2<br>3 2</p>
</blockquote>
<h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>1 3<br>4 2<br>2 3</p>
</blockquote>
<h2 id="提示​"><a href="#提示​" class="headerlink" title="提示​"></a>提示​</h2><p>对于20%的数据 n&lt;=10 p1&lt;=10 p2&lt;=5<br>对于30%的数据 n&lt;=10 p1&lt;=30 p2&lt;=20<br>对于100%的数据 n&lt;=100000 p1&lt;=100000 p2&lt;=100000<br>数据保证至少有一种可行解。</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>原有向图先拓扑，记录时间戳。<br>对于一条无向边，时间早的向时间晚的连边：</p>
<ol>
<li>如果两点在同一拓扑分量，那么这是一条后向边，不会改变dag性质</li>
<li>如果处于不同分量，由于一个分量是集中遍历的，分量x的所有点的时间戳肯定都小于分量y，那么只会从x向y连边，不会出现环。</li>
</ol>
<dir style="text-align:right"><a href="/2016/09/06/NOIP模拟赛-混合图/dizzy.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>dizzy.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> </div><div class="line">    int=longint;</div><div class="line">    edge=<span class="keyword">record</span> t,next:int <span class="keyword">end</span>;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    g:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">100010</span>] <span class="keyword">of</span> edge;</div><div class="line">    head,t,ind:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">100010</span>] <span class="keyword">of</span> int;</div><div class="line">    i,n,m,k,f0,t0,tim:int;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">add</span><span class="params">(f0,t0:int)</span>;</span></div><div class="line"><span class="keyword">var</span> m:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    inc(head[<span class="number">0</span>]);m:=head[<span class="number">0</span>];</div><div class="line">    g[m].t:=t0;</div><div class="line">    g[m].next:=head[f0];head[f0]:=m;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">topo</span><span class="params">(v:int)</span>;</span></div><div class="line"><span class="keyword">var</span> i,u:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    inc(tim);t[v]:=tim;</div><div class="line">    i:=head[v];</div><div class="line">    <span class="keyword">while</span> i&lt;&gt;<span class="number">0</span> <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        u:=g[i].t;</div><div class="line">        <span class="keyword">if</span> t[u]=<span class="number">0</span> <span class="keyword">then</span> topo(u);</div><div class="line">        i:=g[i].next;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'dizzy.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'dizzy.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n,m,k);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> m <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(f0,t0);add(f0,t0);inc(ind[t0]);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    tim:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span></div><div class="line">        <span class="keyword">if</span> ind[i]=<span class="number">0</span> <span class="keyword">then</span> topo(i);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> k <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(f0,t0);</div><div class="line">        <span class="keyword">if</span> t[f0]&lt;t[t0] <span class="keyword">then</span> writeln(f0,<span class="string">' '</span>,t0)</div><div class="line">        <span class="keyword">else</span> writeln(t0,<span class="string">' '</span>,f0);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;描述&quot;&gt;&lt;a href=&quot;#描述&quot; class=&quot;headerlink&quot; title=&quot;描述&quot;&gt;&lt;/a&gt;描述&lt;/h2&gt;&lt;p&gt;Hzwer神犇最近又征服了一个国家，然后接下来却也遇见了一个难题。&lt;br&gt;Hzwer的国家有n个点，m条边，而作为国王，他十分喜欢游览自己的国家。他一般会从任意一个点出发，随便找边走，沿途欣赏路上的美景。但是我们的Hzwer是一个奇怪的人，他不喜欢走到自己以前走过的地方，他的国家本来有p1条有向边，p2条无向边，由于国王奇怪的爱好，他觉得整改所有无向边，使得他们变成有向边，要求整改完以后保证他的国家不可能出现从某个地点出发顺着路走一圈又回来的情况。（注:m=p1+p2.）&lt;br&gt;概述:给你一张混合图，要求你为无向图定向，使得图上没有环。&lt;/p&gt;
&lt;h2 id=&quot;格式&quot;&gt;&lt;a href=&quot;#格式&quot; class=&quot;headerlink&quot; title=&quot;格式&quot;&gt;&lt;/a&gt;格式&lt;/h2&gt;&lt;h3 id=&quot;输入格式&quot;&gt;&lt;a href=&quot;#输入格式&quot; class=&quot;headerlink&quot; title=&quot;输入格式&quot;&gt;&lt;/a&gt;输入格式&lt;/h3&gt;&lt;p&gt;第一行3个整数 n,p1,p2，分别表示点数，有向边的数量，无向边的数量。&lt;br&gt;第二行起输入p1行，每行2个整数 a,b 表示a到b有一条有向边。&lt;br&gt;接下来输入p2行,每行2个整数 a,b 表示a和b中间有一条无向边。&lt;/p&gt;
&lt;h3 id=&quot;输出格式&quot;&gt;&lt;a href=&quot;#输出格式&quot; class=&quot;headerlink&quot; title=&quot;输出格式&quot;&gt;&lt;/a&gt;输出格式&lt;/h3&gt;&lt;p&gt;对于每条无向边，我们要求按输入顺序输出你定向的结果，也就是如果你输出a b，那表示你将a和b中间的无向边定向为a-&amp;gt;b。&lt;br&gt;注意，也许存在很多可行的解。你只要输出其中任意一个就好。&lt;br&gt;
    
    </summary>
    
      <category term="Problem Set" scheme="https://cothrax.github.io/categories/Problem-Set/"/>
    
    
      <category term="OI" scheme="https://cothrax.github.io/tags/OI/"/>
    
      <category term="图论" scheme="https://cothrax.github.io/tags/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="拓扑排序" scheme="https://cothrax.github.io/tags/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>NOIP模拟赛 教主的魔法</title>
    <link href="https://cothrax.github.io/2016/09/06/NOIP%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E6%95%99%E4%B8%BB%E7%9A%84%E9%AD%94%E6%B3%95/"/>
    <id>https://cothrax.github.io/2016/09/06/NOIP模拟赛-教主的魔法/</id>
    <published>2016-09-06T15:13:22.000Z</published>
    <updated>2016-09-10T13:48:32.661Z</updated>
    
    <content type="html"><![CDATA[<h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>教主最近学会了一种神奇的魔法，能够使人长高。于是他准备演示给XMYZ信息组每个英雄看。于是N个英雄们又一次聚集在了一起，这次他们排成了一列，被编号为1、2、……、N。<br>每个人的身高一开始都是不超过1000的正整数。教主的魔法每次可以把闭区间[L, R]（1≤L≤R≤N）内的英雄的身高全部加上一个整数W。（虽然L=R时并不符合区间的书写规范，但我们可以认为是单独增加第L（R）个英雄的身高）<br>CYZ、光哥和ZJQ等人不信教主的邪，于是他们有时候会问WD闭区间 [L, R] 内有多少英雄身高大于等于C，以验证教主的魔法是否真的有效。<br>WD巨懒，于是他把这个回答的任务交给了你。</p>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p> 第1行为两个整数N、Q。Q为问题数与教主的施法数总和。<br> 第2行有N个正整数，第i个数代表第i个英雄的身高。<br> 第3到第Q+2行每行有一个操作：</p>
<ol>
<li>若第一个字母为“M”，则紧接着有三个数字L、R、W。表示对闭区间 [L, R] 内所有英雄的身高加上W。</li>
<li>若第一个字母为“A”，则紧接着有三个数字L、R、C。询问闭区间 [L, R] 内有多少英雄的身高大于等于C。</li>
</ol>
<h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p>对每个“A”询问输出一行，仅含一个整数，表示闭区间 [L, R] 内身高大于等于C的英雄数。<br><a id="more"></a></p>
<h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>5 3<br>1 2 3 4 5<br>A 1 5 4<br>M 3 5 1<br>A 1 5 4</p>
</blockquote>
<h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>2<br>3</p>
</blockquote>
<h2 id="提示​"><a href="#提示​" class="headerlink" title="提示​"></a>提示​</h2><p>【输入输出样例说明】<br>原先5个英雄身高为1、2、3、4、5，此时[1, 5]间有2个英雄的身高大于等于4。教主施法后变为1、2、4、5、6，此时[1, 5]间有3个英雄的身高大于等于4。<br>【数据范围】<br>对30%的数据，N≤1000，Q≤1000。<br>对100%的数据，N≤1000000，Q≤3000，1≤W≤1000，1≤C≤1,000,000,000</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>首先想到<strong>归并树</strong>，但由于每个节点维护数列，存在mle风险，但最重要的是<strong>它不支持修改</strong>。<br>本题是<strong>数列分块</strong>。</p>
<dir style="text-align:right"><a href="/2016/09/06/NOIP模拟赛-教主的魔法/magic0.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>magic.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    a,b,bl,t:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">10000010</span>] <span class="keyword">of</span> int;</div><div class="line">    n,q,k,i,l,r,x:int;c:char;</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">swap</span><span class="params">(<span class="keyword">var</span> a,b:int)</span>;</span></div><div class="line"><span class="keyword">var</span> tmp:int;</div><div class="line"><span class="keyword">begin</span> tmp:=a;a:=b;b:=tmp <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">qsort</span><span class="params">(l,r:int)</span>;</span></div><div class="line"><span class="keyword">var</span> i,j,x:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    i:=l;j:=r;x:=b[random(r-l)+l];</div><div class="line">    <span class="keyword">repeat</span></div><div class="line">        <span class="keyword">while</span> b[i]&lt;x <span class="keyword">do</span> inc(i);</div><div class="line">        <span class="keyword">while</span> b[j]&gt;x <span class="keyword">do</span> dec(j);</div><div class="line">        <span class="keyword">if</span> i&lt;=j <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            swap(b[i],b[j]);</div><div class="line">            inc(i);dec(j);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">until</span> i&gt;j;</div><div class="line">    <span class="keyword">if</span> i&lt;r <span class="keyword">then</span> qsort(i,r);</div><div class="line">    <span class="keyword">if</span> l&lt;j <span class="keyword">then</span> qsort(l,j);</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">sort</span><span class="params">(i:int)</span>;</span></div><div class="line"><span class="keyword">var</span> j,l,r:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    l:=(i-<span class="number">1</span>)*k+<span class="number">1</span>;r:=min(i*k,n);</div><div class="line">    <span class="keyword">for</span> j:=l <span class="keyword">to</span> r <span class="keyword">do</span> b[j]:=a[j];</div><div class="line">    qsort(l,r);</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bin</span><span class="params">(i,x:int)</span>:</span>int; <span class="comment">//max&#123;i|b[i]&lt;x&#125;</span></div><div class="line"><span class="keyword">var</span> l,r,mid:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    l:=(i-<span class="number">1</span>)*k+<span class="number">1</span>;r:=min(i*k,n);</div><div class="line">    bin:=l-<span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> l&lt;=r <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        mid:=(l+r) <span class="keyword">shr</span> <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span> b[mid]+t[i]&lt;x <span class="keyword">then</span> <span class="keyword">begin</span> bin:=mid;l:=mid+<span class="number">1</span> <span class="keyword">end</span></div><div class="line">        <span class="keyword">else</span> r:=mid-<span class="number">1</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">query</span><span class="params">(l,r,x:int)</span>:</span>int;</div><div class="line"><span class="keyword">var</span> i:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    query:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=l <span class="keyword">to</span> min(r,bl[l]*k) <span class="keyword">do</span></div><div class="line">        <span class="keyword">if</span> a[i]+t[bl[l]]&gt;=x <span class="keyword">then</span> inc(query);</div><div class="line">    <span class="keyword">if</span> bl[l]&lt;&gt;bl[r] <span class="keyword">then</span></div><div class="line">        <span class="keyword">for</span> i:=(bl[r]-<span class="number">1</span>)*k+<span class="number">1</span> <span class="keyword">to</span> r <span class="keyword">do</span></div><div class="line">            <span class="keyword">if</span> a[i]+t[bl[r]]&gt;=x <span class="keyword">then</span> inc(query);</div><div class="line">    <span class="keyword">for</span> i:=bl[l]+<span class="number">1</span> <span class="keyword">to</span> bl[r]-<span class="number">1</span> <span class="keyword">do</span></div><div class="line">        inc(query,min(i*k,n)-bin(i,x));</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">modify</span><span class="params">(l,r,x:int)</span>;</span></div><div class="line"><span class="keyword">var</span> i:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">for</span> i:=l <span class="keyword">to</span> min(r,bl[l]*k) <span class="keyword">do</span> inc(a[i],x);</div><div class="line">    sort(bl[l]);</div><div class="line">    <span class="keyword">if</span> bl[l]&lt;&gt;bl[r] <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">for</span> i:=(bl[r]-<span class="number">1</span>)*k+<span class="number">1</span> <span class="keyword">to</span> r <span class="keyword">do</span> inc(a[i],x);</div><div class="line">        sort(bl[r]);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">for</span> i:=bl[l]+<span class="number">1</span> <span class="keyword">to</span> bl[r]-<span class="number">1</span> <span class="keyword">do</span> inc(t[i],x);</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'magic.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'magic.out'</span>);rewrite(output);</div><div class="line">    readln(n,q);k:=floor(sqrt(n));</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">read</span>(a[i]);readln;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> bl[i]:=(i-<span class="number">1</span>) <span class="keyword">div</span> k+<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> bl[n] <span class="keyword">do</span> sort(i);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> q <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(c);readln(l,r,x);</div><div class="line">        <span class="keyword">case</span> c <span class="keyword">of</span> </div><div class="line">            <span class="string">'A'</span>:writeln(query(l,r,x));</div><div class="line">            <span class="string">'M'</span>:modify(l,r,x);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;描述&quot;&gt;&lt;a href=&quot;#描述&quot; class=&quot;headerlink&quot; title=&quot;描述&quot;&gt;&lt;/a&gt;描述&lt;/h2&gt;&lt;p&gt;教主最近学会了一种神奇的魔法，能够使人长高。于是他准备演示给XMYZ信息组每个英雄看。于是N个英雄们又一次聚集在了一起，这次他们排成了一列，被编号为1、2、……、N。&lt;br&gt;每个人的身高一开始都是不超过1000的正整数。教主的魔法每次可以把闭区间[L, R]（1≤L≤R≤N）内的英雄的身高全部加上一个整数W。（虽然L=R时并不符合区间的书写规范，但我们可以认为是单独增加第L（R）个英雄的身高）&lt;br&gt;CYZ、光哥和ZJQ等人不信教主的邪，于是他们有时候会问WD闭区间 [L, R] 内有多少英雄身高大于等于C，以验证教主的魔法是否真的有效。&lt;br&gt;WD巨懒，于是他把这个回答的任务交给了你。&lt;/p&gt;
&lt;h2 id=&quot;格式&quot;&gt;&lt;a href=&quot;#格式&quot; class=&quot;headerlink&quot; title=&quot;格式&quot;&gt;&lt;/a&gt;格式&lt;/h2&gt;&lt;h3 id=&quot;输入格式&quot;&gt;&lt;a href=&quot;#输入格式&quot; class=&quot;headerlink&quot; title=&quot;输入格式&quot;&gt;&lt;/a&gt;输入格式&lt;/h3&gt;&lt;p&gt; 第1行为两个整数N、Q。Q为问题数与教主的施法数总和。&lt;br&gt; 第2行有N个正整数，第i个数代表第i个英雄的身高。&lt;br&gt; 第3到第Q+2行每行有一个操作：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;若第一个字母为“M”，则紧接着有三个数字L、R、W。表示对闭区间 [L, R] 内所有英雄的身高加上W。&lt;/li&gt;
&lt;li&gt;若第一个字母为“A”，则紧接着有三个数字L、R、C。询问闭区间 [L, R] 内有多少英雄的身高大于等于C。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;输出格式&quot;&gt;&lt;a href=&quot;#输出格式&quot; class=&quot;headerlink&quot; title=&quot;输出格式&quot;&gt;&lt;/a&gt;输出格式&lt;/h3&gt;&lt;p&gt;对每个“A”询问输出一行，仅含一个整数，表示闭区间 [L, R] 内身高大于等于C的英雄数。&lt;br&gt;
    
    </summary>
    
      <category term="Problem Set" scheme="https://cothrax.github.io/categories/Problem-Set/"/>
    
    
      <category term="OI" scheme="https://cothrax.github.io/tags/OI/"/>
    
      <category term="数据结构" scheme="https://cothrax.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="二分答案" scheme="https://cothrax.github.io/tags/%E4%BA%8C%E5%88%86%E7%AD%94%E6%A1%88/"/>
    
      <category term="分块" scheme="https://cothrax.github.io/tags/%E5%88%86%E5%9D%97/"/>
    
  </entry>
  
  <entry>
    <title>NOIP模拟赛 路面修整</title>
    <link href="https://cothrax.github.io/2016/09/06/NOIP%E6%A8%A1%E6%8B%9F%E8%B5%9B-%E8%B7%AF%E9%9D%A2%E4%BF%AE%E6%95%B4/"/>
    <id>https://cothrax.github.io/2016/09/06/NOIP模拟赛-路面修整/</id>
    <published>2016-09-06T15:06:43.000Z</published>
    <updated>2016-09-06T15:31:27.289Z</updated>
    
    <content type="html"><![CDATA[<h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>FJ打算好好修一下农场中某条凹凸不平的土路。按奶牛们的要求，修好后的路面高度应当单调上升或单调下降，也就是说，高度上升与高度下降的路段不能同时出现在修好的路中。 整条路被分成了N段，N个整数A1, … , AN (1 &lt;= N &lt;= 2,000)依次描述了每一段路的高度(0 &lt;= Ai &lt;= 1,000,000,000)。FJ希望找到一个恰好含N个元素的不上升或不下降序列B1, … , BN，作为修过的路中每个路段的高度。由于将每一段路垫高或挖低一个单位的花费相同，修路的总支出可以表示为： |A1 - B1| + |A2 - B2| + … + |AN - BN| 请你计算一下，FJ在这项工程上的最小支出是多少。FJ向你保证，这个支出不会超过2^31-1。</p>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p>第1行: 输入1个整数：N<br>第2..N+1行: 第i+1行为1个整数：A_i</p>
<h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p>第1行: 输出1个正整数，表示FJ把路修成高度不上升或高度不下降的最小花费<br><a id="more"></a></p>
<h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>7<br>1<br>3<br>2<br>4<br>5<br>3<br>9</p>
</blockquote>
<h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>3</p>
</blockquote>
<h2 id="提示​"><a href="#提示​" class="headerlink" title="提示​"></a>提示​</h2><p>FJ将第一个高度为3的路段的高度减少为2，将第二个高度为3的路段的高度增加到5，总花费为|2-3|+|5-3| = 3，并且各路段的高度为一个不下降序列 1,2,2,4,5,5,9。</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p><strong>离散化+DP</strong><br>首先高度的范围比较大，先离散化。<br>然后dp，例如第一种，f[i,j]表示1..i满足要求，a[i]高度为j的最小值。<br>方程简单变形后，利用单调的思想优化一下就可以了。<br>第二种情况同理</p>
<dir style="text-align:right"><a href="/2016/09/06/NOIP模拟赛-路面修整/grading.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>grading.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">const</span> inf:int64=<span class="number">1000000000000</span>;</div><div class="line"><span class="keyword">var</span></div><div class="line">    a:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">2010</span>,<span class="number">0</span>..<span class="number">1</span>] <span class="keyword">of</span> int64;</div><div class="line">    <span class="comment">//b[i]:a[i]离散后的值;l[i]:i对应的离散值;</span></div><div class="line">    b:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">2010</span>] <span class="keyword">of</span> int; </div><div class="line">    l:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">2010</span>] <span class="keyword">of</span> int64;</div><div class="line">    f:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">1</span>,<span class="number">0</span>..<span class="number">2010</span>] <span class="keyword">of</span> int64;</div><div class="line">    i,i0,i1,j,n,m:int;p,ans:int64;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">swap</span><span class="params">(<span class="keyword">var</span> a,b:int64)</span>;</span></div><div class="line"><span class="keyword">var</span> tmp:int;</div><div class="line"><span class="keyword">begin</span> tmp:=a;a:=b;b:=tmp <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">qsort</span><span class="params">(b,e:int)</span>;</span></div><div class="line"><span class="keyword">var</span> i,j:int;x:int64;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    i:=b;j:=e;x:=a[random(e-b)+b,<span class="number">0</span>];</div><div class="line">    <span class="keyword">repeat</span></div><div class="line">        <span class="keyword">while</span> a[i,<span class="number">0</span>]&lt;x <span class="keyword">do</span> inc(i);</div><div class="line">        <span class="keyword">while</span> a[j,<span class="number">0</span>]&gt;x <span class="keyword">do</span> dec(j);</div><div class="line">        <span class="keyword">if</span> i&lt;=j <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            swap(a[i,<span class="number">0</span>],a[j,<span class="number">0</span>]);</div><div class="line">            swap(a[i,<span class="number">1</span>],a[j,<span class="number">1</span>]);</div><div class="line">            inc(i);dec(j);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">until</span> i&gt;j;</div><div class="line">    <span class="keyword">if</span> i&lt;e <span class="keyword">then</span> qsort(i,e);</div><div class="line">    <span class="keyword">if</span> b&lt;j <span class="keyword">then</span> qsort(b,j);</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'grading.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'grading.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(a[i,<span class="number">0</span>]);</div><div class="line">        a[i,<span class="number">1</span>]:=i;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    qsort(<span class="number">1</span>,n);</div><div class="line">    m:=<span class="number">0</span>;l[<span class="number">0</span>]:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">if</span> a[i,<span class="number">0</span>]&gt;l[m] <span class="keyword">then</span> <span class="keyword">begin</span> inc(m);l[m]:=a[i,<span class="number">0</span>] <span class="keyword">end</span>;</div><div class="line">        b[a[i,<span class="number">1</span>]]:=m;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="comment">//f[i,j]:=min(f[i-1,k])+a[i]-b[j]</span></div><div class="line">    ans:=inf;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">0</span> <span class="keyword">to</span> m <span class="keyword">do</span> f[<span class="number">1</span>,i]:=abs(l[b[<span class="number">1</span>]]-l[i]);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">2</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        p:=inf;i1:=i <span class="keyword">mod</span> <span class="number">2</span>;i0:=<span class="number">1</span>-i1;</div><div class="line">        <span class="keyword">for</span> j:=<span class="number">0</span> <span class="keyword">to</span> m <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">            p:=min(p,f[i0,j]);</div><div class="line">            f[i1,j]:=p+abs(l[b[i]]-l[j]);</div><div class="line">            <span class="keyword">if</span> i=n <span class="keyword">then</span> ans:=min(ans,f[i1,j]);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">2</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        p:=inf;i1:=i <span class="keyword">mod</span> <span class="number">2</span>;i0:=<span class="number">1</span>-i1;</div><div class="line">        <span class="keyword">for</span> j:=m <span class="keyword">downto</span> <span class="number">0</span> <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">            p:=min(p,f[i0,j]);</div><div class="line">            f[i1,j]:=p+abs(l[b[i]]-l[j]);</div><div class="line">            <span class="keyword">if</span> i=n <span class="keyword">then</span> ans:=min(ans,f[i1,j]);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">write</span>(ans);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;描述&quot;&gt;&lt;a href=&quot;#描述&quot; class=&quot;headerlink&quot; title=&quot;描述&quot;&gt;&lt;/a&gt;描述&lt;/h2&gt;&lt;p&gt;FJ打算好好修一下农场中某条凹凸不平的土路。按奶牛们的要求，修好后的路面高度应当单调上升或单调下降，也就是说，高度上升与高度下降的路段不能同时出现在修好的路中。 整条路被分成了N段，N个整数A1, … , AN (1 &amp;lt;= N &amp;lt;= 2,000)依次描述了每一段路的高度(0 &amp;lt;= Ai &amp;lt;= 1,000,000,000)。FJ希望找到一个恰好含N个元素的不上升或不下降序列B1, … , BN，作为修过的路中每个路段的高度。由于将每一段路垫高或挖低一个单位的花费相同，修路的总支出可以表示为： |A1 - B1| + |A2 - B2| + … + |AN - BN| 请你计算一下，FJ在这项工程上的最小支出是多少。FJ向你保证，这个支出不会超过2^31-1。&lt;/p&gt;
&lt;h2 id=&quot;格式&quot;&gt;&lt;a href=&quot;#格式&quot; class=&quot;headerlink&quot; title=&quot;格式&quot;&gt;&lt;/a&gt;格式&lt;/h2&gt;&lt;h3 id=&quot;输入格式&quot;&gt;&lt;a href=&quot;#输入格式&quot; class=&quot;headerlink&quot; title=&quot;输入格式&quot;&gt;&lt;/a&gt;输入格式&lt;/h3&gt;&lt;p&gt;第1行: 输入1个整数：N&lt;br&gt;第2..N+1行: 第i+1行为1个整数：A_i&lt;/p&gt;
&lt;h3 id=&quot;输出格式&quot;&gt;&lt;a href=&quot;#输出格式&quot; class=&quot;headerlink&quot; title=&quot;输出格式&quot;&gt;&lt;/a&gt;输出格式&lt;/h3&gt;&lt;p&gt;第1行: 输出1个正整数，表示FJ把路修成高度不上升或高度不下降的最小花费&lt;br&gt;
    
    </summary>
    
      <category term="Problem Set" scheme="https://cothrax.github.io/categories/Problem-Set/"/>
    
    
      <category term="OI" scheme="https://cothrax.github.io/tags/OI/"/>
    
      <category term="DP" scheme="https://cothrax.github.io/tags/DP/"/>
    
      <category term="离散化" scheme="https://cothrax.github.io/tags/%E7%A6%BB%E6%95%A3%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>[CodeVS] P1074 食物链</title>
    <link href="https://cothrax.github.io/2016/09/04/CodeVS-P1074/"/>
    <id>https://cothrax.github.io/2016/09/04/CodeVS-P1074/</id>
    <published>2016-09-04T07:55:44.000Z</published>
    <updated>2016-09-04T08:34:59.452Z</updated>
    
    <content type="html"><![CDATA[<h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>动物王国中有三类动物 A,B,C，这三类动物的食物链构成了有趣的环形。A吃B，B吃C，C吃A。<br>现有N个动物，以1－N编号。每个动物都是A,B,C中的一种，但是我们并不知道它到底是哪一种。<br>有人用两种说法对这N个动物所构成的食物链关系进行描述：</p>
<ol>
<li>第一种说法是“1 X Y”，表示X和Y是同类。</li>
<li>第二种说法是“2 X Y”，表示X吃Y。</li>
</ol>
<p>此人对N个动物，用上述两种说法，一句接一句地说出K句话，这K句话有的是真的，有的是假的。当一句话满足下列三条之一时，这句话就是假话，否则就是真话。</p>
<ol>
<li>当前的话与前面的某些真的话冲突，就是假话；</li>
<li>当前的话中X或Y比N大，就是假话；</li>
<li>当前的话表示X吃X，就是假话。</li>
</ol>
<p>你的任务是根据给定的N（1&lt;=N&lt;=50,000）和K句话（0&lt;=K&lt;=100,000），输出假话的总数。</p>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p>第一行是两个整数N和K，以一个空格分隔。<br>以下K行每行是三个正整数D，X，Y，两数之间用一个空格隔开，其中 D 表示说法的种类。</p>
<ol>
<li>若D=1，则表示X和Y是同类。</li>
<li>若D=2，则表示X吃Y。</li>
</ol>
<h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p>只有一个整数，表示假话的数目。<br><a id="more"></a></p>
<h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>100 7<br>1 101 1<br>2 1 2<br>2 2 3<br>2 3 3<br>1 1 3<br>2 3 1<br>1 5 5</p>
</blockquote>
<h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>3</p>
</blockquote>
<h2 id="提示​"><a href="#提示​" class="headerlink" title="提示​"></a>提示​</h2><p>输入文件<br>对7句话的分析 100 7<br>1 101 1假话<br>2 1 2  真话<br>2 2 3  真话<br>2 3 3  假话<br>1 1 3  假话<br>2 3 1  真话<br>1 5 5  真话<br>NOI 2001 食物链(eat)</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><h3 id="关系并查集"><a href="#关系并查集" class="headerlink" title="关系并查集"></a>关系并查集</h3><p>多年前在luogu上刷到，用了这种奇特的方法。<br>以<strong>命题</strong>作为元素做并查集，在同一集合中的命题同时成立</p>
<ol>
<li>i 表示i属于A</li>
<li>i+n 表示i属于B</li>
<li>i+2n 表示i属于C</li>
</ol>
<p>对于命题1 x y，合并：</p>
<ol>
<li>x和y</li>
<li>x+n和y+n</li>
<li>x+2n和y+2n</li>
</ol>
<p>对于命题2 x y，合并：</p>
<ol>
<li>x和y+n</li>
<li>x+n和y+2n</li>
<li>x+2n和y</li>
</ol>
<p>判断矛盾：</p>
<ol>
<li>超出范围、2 x x命题</li>
<li>第一种命题，如果same(x,y+n)或same(x+n,x)则矛盾</li>
<li>第二中命题，如果same(x,y)或same(x+n,y)则矛盾</li>
</ol>
<dir style="text-align:right"><a href="/2016/09/04/CodeVS-P1074/p2024.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>p2024.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    n,k,ans,i,t,a,b:longint;</div><div class="line">    par,rank:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">150010</span>] <span class="keyword">of</span> longint;</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">find</span><span class="params">(x:longint)</span>:</span>longint;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">if</span> par[x]=x <span class="keyword">then</span> find:=x</div><div class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></div><div class="line">        par[x]:=find(par[x]);</div><div class="line">        find:=par[x];</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">unite</span><span class="params">(x,y:longint)</span>;</span></div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">if</span> x=y <span class="keyword">then</span> <span class="keyword">exit</span>;</div><div class="line">    <span class="keyword">if</span> rank[x]&gt;rank[y] <span class="keyword">then</span> par[y]:=x</div><div class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></div><div class="line">        par[x]:=y;</div><div class="line">        <span class="keyword">if</span> rank[x]=rank[y] <span class="keyword">then</span> inc(rank[y]);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">same</span><span class="params">(x,y:longint)</span>:</span>boolean;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    same:=(find(x)=find(y));</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">read</span>(n,k);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> <span class="number">3</span>*n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        par[i]:=i;</div><div class="line">        rank[i]:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    ans:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> k <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(t,a,b);</div><div class="line">        <span class="keyword">if</span> (max(a,b)&gt;n) <span class="keyword">or</span> (min(a,b)&lt;<span class="number">1</span>) <span class="keyword">then</span> continue;</div><div class="line">        <span class="keyword">if</span> t=<span class="number">1</span> <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            <span class="keyword">if</span> same(a,b+n) <span class="keyword">or</span> same(a,b+<span class="number">2</span>*n) <span class="keyword">then</span> continue;</div><div class="line">            unite(a,b);</div><div class="line">            unite(a+n,b+n);</div><div class="line">            unite(a+<span class="number">2</span>*n,b+<span class="number">2</span>*n);</div><div class="line">        <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span></div><div class="line">            <span class="keyword">if</span> same(a,b) <span class="keyword">or</span> same(a,b+<span class="number">2</span>*n) <span class="keyword">then</span> continue;</div><div class="line">            unite(a,b+n);</div><div class="line">            unite(a+n,b+<span class="number">2</span>*n);</div><div class="line">            unite(a+<span class="number">2</span>*n,b);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">        inc(ans);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">write</span>(k-ans);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
<h3 id="带权并查集"><a href="#带权并查集" class="headerlink" title="带权并查集"></a>带权并查集</h3><p>今天再看这道题，发现带权并查集的方法更通用一些。<br>我们定义向量$\overrightarrow{xy}$表示动物x和动物y的关系（<strong>模3意义下</strong>）：</p>
<ol>
<li>$\overrightarrow{xy}=0$：同类</li>
<li>$\overrightarrow{xy}=1$：x吃y</li>
<li>$\overrightarrow{xy}=2$：y吃x</li>
</ol>
<p>这样定义是满足向量性质的，比如$\overrightarrow{xy}=1,\overrightarrow{yz}=1$<br>那么$\overrightarrow{xz}=\overrightarrow{xy}+\overrightarrow{yz}=2$<br>表示x吃y，y吃z，那么x被z吃<br>我们定义并查集元素的权：$d[x]=\overrightarrow{p[x]y}$，其中p[x]为x的父亲</p>
<p>路径压缩时维护权值：记r为当前子树的根，我们把x接到r上，此时的d[x]变成：<br>$d[x]=\overrightarrow{rx}=\overrightarrow{rp[x]}+\overrightarrow{p[x]x}=d[p[x]]+d[x]$<br>（此时p[x]已经递归处理过了，于是已经满足p[p[x]]=r）</p>
<p>合并时维护权值：已知$f=\overrightarrow{xy}$，把p[x]接到p[y]上：<br>$d[p[x]]=\overrightarrow{p[y]p[x]}=\overrightarrow{p[y]y}-\overrightarrow{xy}-\overrightarrow{p[x]x}=d[y]-f-d[x]$</p>
<p>并查集初始化为$p[i]=i,d[i]=0$<br>然后处理命题：</p>
<ol>
<li>如果not same(x,y)，将它们合并$union(x,y,\overrightarrow{xy})$</li>
<li>如果same(x,y)那么判断：<ol>
<li>命题1：$d[y]\not\equiv d[x]\ (mod\ 3)$则矛盾</li>
<li>命题2：由于$\overrightarrow{xy}=1=\overrightarrow{py}-\overrightarrow{px}=d[y]-d[x]$，所以$d[y]-d[x]\not\equiv 1\ (mod\ 3)$则矛盾</li>
</ol>
</li>
</ol>
<dir style="text-align:right"><a href="/2016/09/04/CodeVS-P1074/1074.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>1074.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    n,k,i,a,b,c,ans:int;</div><div class="line">    par,d:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">50010</span>] <span class="keyword">of</span> int;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">find</span><span class="params">(x:int)</span>:</span>int;</div><div class="line"><span class="keyword">var</span> old:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">if</span> par[x]=x <span class="keyword">then</span> <span class="keyword">exit</span>(x)</div><div class="line">    <span class="keyword">else</span> <span class="keyword">begin</span></div><div class="line">        old:=par[x];</div><div class="line">        par[x]:=find(par[x]);</div><div class="line">        d[x]:=(d[x]+d[old]) <span class="keyword">mod</span> <span class="number">3</span>;</div><div class="line">        find:=par[x];</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">union</span><span class="params">(x,y,f:int)</span>;</span></div><div class="line"><span class="keyword">var</span> px,py:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    px:=find(x);py:=find(y);</div><div class="line">    par[px]:=py;</div><div class="line">    d[px]:=(d[y]-f-d[x]+<span class="number">3</span>) <span class="keyword">mod</span> <span class="number">3</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">same</span><span class="params">(x,y:int)</span>:</span>boolean;</div><div class="line"><span class="keyword">begin</span> same:=find(x)=find(y) <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">read</span>(n,k);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        par[i]:=i;</div><div class="line">        d[i]:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    ans:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> k <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(a,b,c);</div><div class="line">        <span class="keyword">if</span> (b&gt;n) <span class="keyword">or</span> (c&gt;n) <span class="keyword">then</span> inc(ans)</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (a=<span class="number">2</span>) <span class="keyword">and</span> (b=c) <span class="keyword">then</span> inc(ans)</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> same(b,c) <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            <span class="keyword">if</span> (a=<span class="number">1</span>) <span class="keyword">and</span> (d[b]&lt;&gt;d[c]) <span class="keyword">then</span> inc(ans);</div><div class="line">            <span class="keyword">if</span> (a=<span class="number">2</span>) <span class="keyword">and</span> ((d[c]-d[b]+<span class="number">3</span>) <span class="keyword">mod</span> <span class="number">3</span>&lt;&gt;<span class="number">1</span>) <span class="keyword">then</span> inc(ans);</div><div class="line">        <span class="keyword">end</span> <span class="keyword">else</span> union(b,c,a-<span class="number">1</span>);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">write</span>(ans);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;描述&quot;&gt;&lt;a href=&quot;#描述&quot; class=&quot;headerlink&quot; title=&quot;描述&quot;&gt;&lt;/a&gt;描述&lt;/h2&gt;&lt;p&gt;动物王国中有三类动物 A,B,C，这三类动物的食物链构成了有趣的环形。A吃B，B吃C，C吃A。&lt;br&gt;现有N个动物，以1－N编号。每个动物都是A,B,C中的一种，但是我们并不知道它到底是哪一种。&lt;br&gt;有人用两种说法对这N个动物所构成的食物链关系进行描述：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;第一种说法是“1 X Y”，表示X和Y是同类。&lt;/li&gt;
&lt;li&gt;第二种说法是“2 X Y”，表示X吃Y。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;此人对N个动物，用上述两种说法，一句接一句地说出K句话，这K句话有的是真的，有的是假的。当一句话满足下列三条之一时，这句话就是假话，否则就是真话。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;当前的话与前面的某些真的话冲突，就是假话；&lt;/li&gt;
&lt;li&gt;当前的话中X或Y比N大，就是假话；&lt;/li&gt;
&lt;li&gt;当前的话表示X吃X，就是假话。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;你的任务是根据给定的N（1&amp;lt;=N&amp;lt;=50,000）和K句话（0&amp;lt;=K&amp;lt;=100,000），输出假话的总数。&lt;/p&gt;
&lt;h2 id=&quot;格式&quot;&gt;&lt;a href=&quot;#格式&quot; class=&quot;headerlink&quot; title=&quot;格式&quot;&gt;&lt;/a&gt;格式&lt;/h2&gt;&lt;h3 id=&quot;输入格式&quot;&gt;&lt;a href=&quot;#输入格式&quot; class=&quot;headerlink&quot; title=&quot;输入格式&quot;&gt;&lt;/a&gt;输入格式&lt;/h3&gt;&lt;p&gt;第一行是两个整数N和K，以一个空格分隔。&lt;br&gt;以下K行每行是三个正整数D，X，Y，两数之间用一个空格隔开，其中 D 表示说法的种类。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;若D=1，则表示X和Y是同类。&lt;/li&gt;
&lt;li&gt;若D=2，则表示X吃Y。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;输出格式&quot;&gt;&lt;a href=&quot;#输出格式&quot; class=&quot;headerlink&quot; title=&quot;输出格式&quot;&gt;&lt;/a&gt;输出格式&lt;/h3&gt;&lt;p&gt;只有一个整数，表示假话的数目。&lt;br&gt;
    
    </summary>
    
      <category term="Problem Set" scheme="https://cothrax.github.io/categories/Problem-Set/"/>
    
    
      <category term="OI" scheme="https://cothrax.github.io/tags/OI/"/>
    
      <category term="并查集" scheme="https://cothrax.github.io/tags/%E5%B9%B6%E6%9F%A5%E9%9B%86/"/>
    
      <category term="数据结构" scheme="https://cothrax.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="NOI" scheme="https://cothrax.github.io/tags/NOI/"/>
    
  </entry>
  
  <entry>
    <title>欢乐赛 2014-5-31</title>
    <link href="https://cothrax.github.io/2016/09/04/%E6%AC%A2%E4%B9%90%E8%B5%9B-2014-5-31/"/>
    <id>https://cothrax.github.io/2016/09/04/欢乐赛-2014-5-31/</id>
    <published>2016-09-04T03:45:17.000Z</published>
    <updated>2016-09-04T06:56:22.155Z</updated>
    
    <content type="html"><![CDATA[<table>
<thead>
<tr>
<th style="text-align:center">题目名称</th>
<th style="text-align:center">水灾</th>
<th style="text-align:center">某种数列问题</th>
<th style="text-align:center">密码锁</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">源文件</td>
<td style="text-align:center">sliker.cpp/c/pas</td>
<td style="text-align:center">jx.cpp/c/pas</td>
<td style="text-align:center">password.cpp/c/pas</td>
</tr>
<tr>
<td style="text-align:center">输入文件</td>
<td style="text-align:center">sliker.in</td>
<td style="text-align:center">jx.in</td>
<td style="text-align:center">password.in</td>
</tr>
<tr>
<td style="text-align:center">输出文件</td>
<td style="text-align:center">sliker.out</td>
<td style="text-align:center">jx.out</td>
<td style="text-align:center">password.out</td>
</tr>
</tbody>
</table>
<blockquote>
<p>来源：hzwer.com</p>
</blockquote>
<h1 id="P1-水灾"><a href="#P1-水灾" class="headerlink" title="P1 水灾"></a>P1 水灾</h1><p>大雨应经下了几天雨，却还是没有停的样子。土豪CCY刚从外地赚完1e元回来，知道不久除了自己别墅，其他的地方都将会被洪水淹没。<br>CCY所在的城市可以用一个N*M(N,M&lt;=50)的地图表示，地图上有五种符号：“. * X D S”。其中“X”表示石头，水和人都不能从上面经过。“.”表示平原，CCY和洪水都可以经过。“*”表示洪水开始地方（可能有多个地方开始发生洪水）。“D”表示CCY的别墅。“S”表示CCY现在的位置。<br>CCY每分钟可以向相邻位置移动，而洪水将会在CCY移动之后把相邻的没有的土地淹没（从已淹没的土地）。<br>求CCY回到别墅的最少时间。如果聪哥回不了家，就很可能会被淹死，那么他就要膜拜黄金大神涨RP来呼叫直升飞机，所以输出“ORZ hzwer!!!”。<br><a id="more"></a></p>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p>输入文件 sliker.in </p>
<h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p>输出文件 sliker.out</p>
<h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><p>样例1</p>
<blockquote>
<p>3 3<br>D.*<br>…<br>.S.</p>
</blockquote>
<p>样例2</p>
<blockquote>
<p>3 3<br>D.*<br>…<br>..S</p>
</blockquote>
<p>样例3</p>
<blockquote>
<p>3 6<br>D…*.<br>.X.X..<br>….S.</p>
</blockquote>
<h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><p>样例1</p>
<blockquote>
<p>3</p>
</blockquote>
<p>样例2</p>
<blockquote>
<p>ORZ hzwer!!!</p>
</blockquote>
<p>样例3</p>
<blockquote>
<p>6</p>
</blockquote>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>比洪水到达时间早就可以走，bfs两次就可以了。<br>审题：洪水不能通过别墅D</p>
<dir style="text-align:right"><a href="/2016/09/04/欢乐赛-2014-5-31/sliker.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>sliker.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">type</span> </div><div class="line">    int=longint;</div><div class="line">    arr=<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">51</span>,<span class="number">0</span>..<span class="number">51</span>] <span class="keyword">of</span> int;</div><div class="line"><span class="keyword">const</span> </div><div class="line">    dir:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">3</span>,<span class="number">0</span>..<span class="number">1</span>] <span class="keyword">of</span> int=((<span class="number">0</span>,<span class="number">1</span>),(<span class="number">1</span>,<span class="number">0</span>),(<span class="number">0</span>,-<span class="number">1</span>),(-<span class="number">1</span>,<span class="number">0</span>));</div><div class="line">    inf=<span class="number">100000000</span>;</div><div class="line"><span class="keyword">var</span></div><div class="line">    map:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">51</span>,<span class="number">0</span>..<span class="number">51</span>] <span class="keyword">of</span> char;</div><div class="line">    s:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">2510</span>,<span class="number">0</span>..<span class="number">1</span>] <span class="keyword">of</span> int;</div><div class="line">    n,m,k,i,j,sx,sy,tx,ty:int;</div><div class="line">    f,d:arr;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">bfs</span><span class="params">(sx,sy:int;<span class="keyword">var</span> d:arr;b:boolean)</span>;</span></div><div class="line"><span class="keyword">var</span> </div><div class="line">    h,t,i,nx,ny,x,y:int;</div><div class="line">    q:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">2510</span>,<span class="number">0</span>..<span class="number">1</span>] <span class="keyword">of</span> int;</div><div class="line">    used:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">51</span>,<span class="number">0</span>..<span class="number">51</span>] <span class="keyword">of</span> boolean;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    fillchar(used,sizeof(used),false);</div><div class="line">    h:=<span class="number">0</span>;t:=<span class="number">1</span>;</div><div class="line">    q[h,<span class="number">0</span>]:=sx;q[h,<span class="number">1</span>]:=sy;</div><div class="line">    d[sx,sy]:=<span class="number">0</span>;used[sx,sy]:=true;</div><div class="line">    <span class="keyword">while</span> h&lt;&gt;t <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        x:=q[h,<span class="number">0</span>];y:=q[h,<span class="number">1</span>];</div><div class="line">        <span class="keyword">for</span> i:=<span class="number">0</span> <span class="keyword">to</span> <span class="number">3</span> <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">            nx:=q[h,<span class="number">0</span>]+dir[i,<span class="number">0</span>];ny:=q[h,<span class="number">1</span>]+dir[i,<span class="number">1</span>];</div><div class="line">            <span class="keyword">if</span> (nx&lt;<span class="number">1</span>) <span class="keyword">or</span>(nx&gt;n) <span class="keyword">or</span> (ny&lt;<span class="number">1</span>) <span class="keyword">or</span> (ny&gt;m) <span class="keyword">then</span> continue;</div><div class="line">            <span class="keyword">if</span> used[nx,ny] <span class="keyword">or</span> (map[nx,ny]=<span class="string">'X'</span>) <span class="keyword">then</span> continue;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> b <span class="keyword">and</span> (map[nx,ny]=<span class="string">'D'</span>) <span class="keyword">then</span> continue;</div><div class="line">            used[nx,ny]:=true;</div><div class="line">            d[nx,ny]:=min(d[nx,ny],d[x,y]+<span class="number">1</span>);</div><div class="line">            <span class="keyword">if</span> b <span class="keyword">and</span> (d[nx,ny]&gt;=f[nx,ny]) <span class="keyword">then</span> continue;</div><div class="line">            q[t,<span class="number">0</span>]:=nx;q[t,<span class="number">1</span>]:=ny;inc(t);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">        inc(h);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'sliker.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'sliker.out'</span>);rewrite(output);</div><div class="line">    readln(n,m);k:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span></div><div class="line">        <span class="keyword">for</span> j:=<span class="number">1</span> <span class="keyword">to</span> m <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">            <span class="keyword">read</span>(map[i,j]);</div><div class="line">            <span class="keyword">case</span> map[i,j] <span class="keyword">of</span> </div><div class="line">                <span class="string">'S'</span>:<span class="keyword">begin</span> sx:=i;sy:=j <span class="keyword">end</span>;</div><div class="line">                <span class="string">'D'</span>:<span class="keyword">begin</span> tx:=i;ty:=j <span class="keyword">end</span>;</div><div class="line">                <span class="string">'*'</span>:<span class="keyword">begin</span> inc(k);s[k,<span class="number">0</span>]:=i;s[k,<span class="number">1</span>]:=j <span class="keyword">end</span>;</div><div class="line">            <span class="keyword">end</span>;</div><div class="line">            <span class="keyword">if</span> j=m <span class="keyword">then</span> readln;</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    filldword(f,sizeof(f) <span class="keyword">div</span> <span class="number">4</span>,inf);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> k <span class="keyword">do</span> bfs(s[i,<span class="number">0</span>],s[i,<span class="number">1</span>],f,false);</div><div class="line">    filldword(d,sizeof(d) <span class="keyword">div</span> <span class="number">4</span>,inf);</div><div class="line">    bfs(sx,sy,d,true);</div><div class="line">    <span class="keyword">if</span> d[tx,ty]&lt;&gt;inf <span class="keyword">then</span> <span class="keyword">write</span>(d[tx,ty])</div><div class="line">    <span class="keyword">else</span> <span class="keyword">write</span>(<span class="string">'ORZ hzwer!!!'</span>);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
<h1 id="P2-某种数列问题"><a href="#P2-某种数列问题" class="headerlink" title="P2 某种数列问题"></a>P2 某种数列问题</h1><p>众所周知，chenzeyu97有无数的妹子(阿掉！&gt;_&lt;)，而且他还有很多恶趣味的问题，继上次纠结于一排妹子的排法以后，今天他有非(chi)常(bao)认(cheng)真(zhe)去研究一个奇怪的问题。有一堆他的妹子站成一排，然后对于每个妹子有一个美丽度，当然美丽度越大越好，chenzeyu97妹子很多，但是质量上不容乐观，经常出现很多美丽度为负数的妹子(喜闻乐见)，chenzeyu97希望从一排妹子里找出3队连续的妹子，使她们的美丽度和最大。注意，一个妹子不能被编入多个队伍而且一定要拿出三队，不然czy会闲着没事做~。<br>简单滴说就是：<br>给定一个数列，从中找到3个无交集的连续子数列使其和最大。</p>
<h2 id="格式-1"><a href="#格式-1" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式-1"><a href="#输入格式-1" class="headerlink" title="输入格式"></a>输入格式</h3><p>第一行一个数n，表示数列长度。<br>接下来有n行，每行一个数，第i行为第i个数。</p>
<h3 id="输出格式-1"><a href="#输出格式-1" class="headerlink" title="输出格式"></a>输出格式</h3><p>仅有一个数，表示最大和。<br><!--more--></p>
<h2 id="样例-1"><a href="#样例-1" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入-1"><a href="#样例输入-1" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>10<br>-1<br>2<br>3<br>-4<br>0<br>1<br>-6<br>-1<br>1<br>-2</p>
</blockquote>
<h3 id="样例输出-1"><a href="#样例输出-1" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>7</p>
</blockquote>
<h2 id="提示"><a href="#提示" class="headerlink" title="提示"></a>提示</h2><p>【样例说明】<br>第一队妹子取2，3。<br>第二队妹子取0，1。<br>第三队妹子取1。</p>
<p>【数据范围】<br>请大家放心，虽然chenzeyu97妹子无数，但是这次他叫来的个数n是有限的。=v=<br>对于30%的数据，妹子数不大于200。<br>对于60%的数据，妹子数不大于2000。<br>对于100%的数据，妹子数1000000。<br>而且，由于chenzeyu97没有CCR那样的影响力，所以他的妹子选完的最大美丽度和不超过maxlongint。</p>
<h2 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h2><p>dp就好，f[i,j] 1..j的mz分i组的最大和，sum[i]前缀和<br><span>$f[i,j]=max\{f[i-1,k]+sum[j]-sum[k]\}$</span><!-- Has MathJax --></p>
<p>每次计算完f[i]，此时f[i,j]指的是第i段数<strong>以a[j]结尾</strong>的最大和，于是还要2..n扫一遍：<br><span>$f[i,j]=max(f[i,j],f[i,j-1])$</span><!-- Has MathJax --></p>
<p>复杂度$O(3N^2)$，尝试优化，我们变形一下：<br><span>$f[i,j]=max\{f[i-1,k]-sum[k]\}+sum[j]$</span><!-- Has MathJax --></p>
<p>然后用<strong>单调栈</strong>维护即可。<br>此外注意一下端点。</p>
<dir style="text-align:right"><a href="/2016/09/04/欢乐赛-2014-5-31/jx.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>jx.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">var</span></div><div class="line">    n,i,j,t:int;</div><div class="line">    sum,s:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">1000010</span>] <span class="keyword">of</span> int;</div><div class="line">    f:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">1000010</span>,<span class="number">0</span>..<span class="number">3</span>] <span class="keyword">of</span> int;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">push</span><span class="params">(x:int)</span>;</span></div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">while</span> (t&gt;<span class="number">0</span>) <span class="keyword">and</span> (s[t]&lt;=x) <span class="keyword">do</span> dec(t);</div><div class="line">    inc(t);s[t]:=x;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'jx.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'jx.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n);</div><div class="line">    sum[<span class="number">0</span>]:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(j);</div><div class="line">        sum[i]:=sum[i-<span class="number">1</span>]+j;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="comment">//f[i,j]=max(f[k,j-1]-sum[k])+sum[i]</span></div><div class="line">    f[<span class="number">0</span>,<span class="number">0</span>]:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> <span class="number">3</span> <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        t:=<span class="number">0</span>;</div><div class="line">        push(f[i-<span class="number">1</span>,i-<span class="number">1</span>]-sum[i-<span class="number">1</span>]);</div><div class="line">        <span class="keyword">for</span> j:=i <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">            f[j,i]:=s[<span class="number">1</span>]+sum[j];</div><div class="line">            push(f[j,i-<span class="number">1</span>]-sum[j]);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">        <span class="keyword">for</span> j:=i+<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span></div><div class="line">            f[j,i]:=max(f[j,i],f[j-<span class="number">1</span>,i]);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">write</span>(f[n,<span class="number">3</span>]);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
<h1 id="P2-密码锁"><a href="#P2-密码锁" class="headerlink" title="P2 密码锁"></a>P2 密码锁</h1><p>hzwer有一把密码锁，由N个开关组成。一开始的时候，所有开关都是关上的。当且仅当开关x1,x2,x3,…xk为开，其他开关为关时，密码锁才会打开。<br>他可以进行M种的操作，每种操作有一个size[i]，表示，假如他选择了第i种的操作的话，他可以任意选择连续的size[i]个格子，把它们全部取反。（注意，由于黄金大神非常的神，所以操作次数可以无限&gt;_&lt;）<br>本来这是一个无关紧要的问题，但是，黄金大神不小心他的钱丢进去了，没有的钱他哪里能逃过被chenzeyu97 NTR的命运？&gt;_&lt;  于是，他为了虐爆czy，也为了去泡更多的妹子，决定打开这把锁。但是他那么神的人根本不屑这种”水题”。于是，他找到了你。<br>你的任务很简单，求出最少需要多少步才能打开密码锁，或者如果无解的话，请输出-1。</p>
<h2 id="格式-2"><a href="#格式-2" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式-2"><a href="#输入格式-2" class="headerlink" title="输入格式"></a>输入格式</h3><p>第1行，三个正整数N，K，M，如题目所述。<br>第2行，K个正整数，表示开关x1,x2,x3..xk必须为开，保证x两两不同。<br>第三行，M个正整数，表示size[i]，size[]可能有重复元素。</p>
<h3 id="输出格式-2"><a href="#输出格式-2" class="headerlink" title="输出格式"></a>输出格式</h3><p>输出答案，无解输出-1。<br><!--more--></p>
<h2 id="样例-2"><a href="#样例-2" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入-2"><a href="#样例输入-2" class="headerlink" title="样例输入"></a>样例输入</h3><p>样例1</p>
<blockquote>
<p>10 8 2<br>1 2 3 5 6 7 8 9<br>3 5</p>
</blockquote>
<p>样例2</p>
<blockquote>
<p>3 2 1<br>1 2<br>3</p>
</blockquote>
<h3 id="样例输出-2"><a href="#样例输出-2" class="headerlink" title="样例输出"></a>样例输出</h3><p>样例1</p>
<blockquote>
<p>2</p>
</blockquote>
<p>样例2</p>
<blockquote>
<p>-1</p>
</blockquote>
<h2 id="提示-1"><a href="#提示-1" class="headerlink" title="提示"></a>提示</h2><p>【数据规模】<br>对于50%的数据，1≤N≤20，1≤k≤5，1≤m≤3;<br>对于另外20%的数据，1≤N≤10000，1≤k≤5,1≤m≤30;<br>对于100%的数据，1≤N≤10000，1≤k≤10，1≤m≤100。</p>
<h2 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h2><p>第一眼看成反转问题，贪心想了好久没有结果。其实是<strong>差分序列+图论建模+bfs+状压DP</strong><br>先把目标序列a变成模2意义下的差分序列b。<br>差分序列b中的元素1最多2k个。题目变成了<strong>把b中的所有元素全变成0的最小操作数</strong><br>每次操作相当于把b[i]和b[size[j]+i]取反：</p>
<ol>
<li>当两个值都是0时，这个操作是多余的</li>
<li>有一个0，一个1时，相当于把1移到0所在的位置</li>
<li>两个都是1时，相当于两个元素1匹配，抵消了。</li>
</ol>
<p>所以b中的所有元素1都要<strong>两两匹配</strong>，把所有元素1作为顶点建图，边权可以用bfs计算出来（g[i,j]=把i移到j的最小操作数）。<br>然后题目就抽象为<strong>一个完全图上的最小权匹配</strong>。<br>因为<strong>顶点数2k≤20</strong>，可以状压DP解决：</p>
<span>$f[S]=min\{f[S-lowbit-j]+g[lowbit,j]\ \ |\ \ j\ \in\ S-lowbit\}$</span><!-- Has MathJax -->
<p>当然闲的蛋疼可以写带花树。</p>
<dir style="text-align:right"><a href="/2016/09/04/欢乐赛-2014-5-31/password.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>password.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">uses</span> math;</div><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">const</span></div><div class="line">    inf=<span class="number">100000000</span>;</div><div class="line">    maxn=<span class="number">1</span> <span class="keyword">shl</span> <span class="number">20</span>;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    n,k,m,i,j,sz,ans:int;</div><div class="line">    a,b:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">10010</span>] <span class="keyword">of</span> int;</div><div class="line">    s:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">110</span>] <span class="keyword">of</span> int;</div><div class="line">    g:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">21</span>,<span class="number">0</span>..<span class="number">21</span>] <span class="keyword">of</span> int;</div><div class="line">    f:<span class="keyword">array</span>[<span class="number">0</span>..maxn+<span class="number">10</span>] <span class="keyword">of</span> int;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">bfs</span><span class="params">(x:int)</span>;</span></div><div class="line"><span class="keyword">var</span> </div><div class="line">    h,t,i,v,u:int;</div><div class="line">    q,d:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">10010</span>] <span class="keyword">of</span> int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    filldword(d,sizeof(d) <span class="keyword">div</span> <span class="number">4</span>,inf);</div><div class="line">    h:=<span class="number">1</span>;t:=<span class="number">2</span>;d[x]:=<span class="number">0</span>;q[h]:=x;</div><div class="line">    <span class="keyword">while</span> h&lt;&gt;t <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        v:=q[h];</div><div class="line">        <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> m <span class="keyword">do</span> </div><div class="line">            <span class="keyword">for</span> j:=-<span class="number">1</span> <span class="keyword">to</span> <span class="number">1</span> <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">                u:=v+s[i]*j;</div><div class="line">                <span class="keyword">if</span> (u&lt;<span class="number">1</span>) <span class="keyword">or</span> (u&gt;n) <span class="keyword">then</span> continue;</div><div class="line">                <span class="keyword">if</span> d[u]&lt;&gt;inf <span class="keyword">then</span> continue;</div><div class="line">                d[u]:=d[v]+<span class="number">1</span>;q[t]:=u;</div><div class="line">                inc(t);<span class="keyword">if</span> t&gt;<span class="number">10010</span> <span class="keyword">then</span> t:=<span class="number">0</span>;</div><div class="line">            <span class="keyword">end</span>;</div><div class="line">        inc(h);<span class="keyword">if</span> h&gt;<span class="number">10010</span> <span class="keyword">then</span> h:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span></div><div class="line">        <span class="keyword">if</span> b[i]&lt;&gt;<span class="number">0</span> <span class="keyword">then</span></div><div class="line">            g[b[x],b[i]]:=d[i];</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">dp</span><span class="params">(s:int)</span>:</span>int;</div><div class="line"><span class="keyword">var</span> x,li,i,lj,j:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">if</span> s=<span class="number">0</span> <span class="keyword">then</span> <span class="keyword">exit</span>(<span class="number">0</span>);</div><div class="line">    <span class="keyword">if</span> f[s]&lt;&gt;-<span class="number">1</span> <span class="keyword">then</span> <span class="keyword">exit</span>(f[s]);</div><div class="line">    f[s]:=inf;</div><div class="line">    li:=s <span class="keyword">and</span> (-s);</div><div class="line">    i:=round(ln(li)/ln(<span class="number">2</span>)+<span class="number">1</span>);</div><div class="line">    x:=s-li;</div><div class="line">    <span class="keyword">while</span> x&lt;&gt;<span class="number">0</span> <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        lj:=x <span class="keyword">and</span> (-x);</div><div class="line">        j:=round(ln(lj)/ln(<span class="number">2</span>)+<span class="number">1</span>);</div><div class="line">        <span class="keyword">if</span> g[i,j]&lt;&gt;inf <span class="keyword">then</span></div><div class="line">            f[s]:=min(f[s],dp(s-li-lj)+g[i,j]);</div><div class="line">        dec(x,lj);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">exit</span>(f[s]);</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'password.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'password.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n,k,m);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> k <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(j);</div><div class="line">        a[j]:=<span class="number">1</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> m <span class="keyword">do</span> <span class="keyword">read</span>(s[i]);</div><div class="line">    inc(n);sz:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=n <span class="keyword">downto</span> <span class="number">1</span> <span class="keyword">do</span> b[i]:=a[i] xor a[i-<span class="number">1</span>];</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span></div><div class="line">        <span class="keyword">if</span> b[i]=<span class="number">1</span> <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            inc(sz);b[i]:=sz;</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span></div><div class="line">        <span class="keyword">if</span> b[i]&lt;&gt;<span class="number">0</span> <span class="keyword">then</span> bfs(i);</div><div class="line">    <span class="comment">//f[S]=min&#123;f[S-lowbit-(1 shl j)]+d[lb,j]&#125;</span></div><div class="line">    fillchar(f,sizeof(f),<span class="number">255</span>);</div><div class="line">    ans:=dp(<span class="number">1</span> <span class="keyword">shl</span> sz-<span class="number">1</span>);</div><div class="line">    <span class="keyword">if</span> ans=inf <span class="keyword">then</span> <span class="keyword">write</span>(-<span class="number">1</span>) <span class="keyword">else</span> <span class="keyword">write</span>(ans);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:center&quot;&gt;题目名称&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;水灾&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;某种数列问题&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;密码锁&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;源文件&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;sliker.cpp/c/pas&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;jx.cpp/c/pas&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;password.cpp/c/pas&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;输入文件&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;sliker.in&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;jx.in&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;password.in&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;输出文件&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;sliker.out&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;jx.out&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;password.out&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;来源：hzwer.com&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;P1-水灾&quot;&gt;&lt;a href=&quot;#P1-水灾&quot; class=&quot;headerlink&quot; title=&quot;P1 水灾&quot;&gt;&lt;/a&gt;P1 水灾&lt;/h1&gt;&lt;p&gt;大雨应经下了几天雨，却还是没有停的样子。土豪CCY刚从外地赚完1e元回来，知道不久除了自己别墅，其他的地方都将会被洪水淹没。&lt;br&gt;CCY所在的城市可以用一个N*M(N,M&amp;lt;=50)的地图表示，地图上有五种符号：“. * X D S”。其中“X”表示石头，水和人都不能从上面经过。“.”表示平原，CCY和洪水都可以经过。“*”表示洪水开始地方（可能有多个地方开始发生洪水）。“D”表示CCY的别墅。“S”表示CCY现在的位置。&lt;br&gt;CCY每分钟可以向相邻位置移动，而洪水将会在CCY移动之后把相邻的没有的土地淹没（从已淹没的土地）。&lt;br&gt;求CCY回到别墅的最少时间。如果聪哥回不了家，就很可能会被淹死，那么他就要膜拜黄金大神涨RP来呼叫直升飞机，所以输出“ORZ hzwer!!!”。&lt;br&gt;
    
    </summary>
    
      <category term="Problem Set" scheme="https://cothrax.github.io/categories/Problem-Set/"/>
    
    
      <category term="OI" scheme="https://cothrax.github.io/tags/OI/"/>
    
      <category term="数据结构" scheme="https://cothrax.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="DP" scheme="https://cothrax.github.io/tags/DP/"/>
    
      <category term="BFS" scheme="https://cothrax.github.io/tags/BFS/"/>
    
      <category term="图论" scheme="https://cothrax.github.io/tags/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="差分序列" scheme="https://cothrax.github.io/tags/%E5%B7%AE%E5%88%86%E5%BA%8F%E5%88%97/"/>
    
      <category term="状压DP" scheme="https://cothrax.github.io/tags/%E7%8A%B6%E5%8E%8BDP/"/>
    
      <category term="搜索" scheme="https://cothrax.github.io/tags/%E6%90%9C%E7%B4%A2/"/>
    
      <category term="单调栈" scheme="https://cothrax.github.io/tags/%E5%8D%95%E8%B0%83%E6%A0%88/"/>
    
  </entry>
  
  <entry>
    <title>NOIP模拟赛 2014-5-24</title>
    <link href="https://cothrax.github.io/2016/09/03/NOIP%E6%A8%A1%E6%8B%9F%E8%B5%9B-2014-5-24/"/>
    <id>https://cothrax.github.io/2016/09/03/NOIP模拟赛-2014-5-24/</id>
    <published>2016-09-03T14:32:15.000Z</published>
    <updated>2016-09-04T04:36:56.186Z</updated>
    
    <content type="html"><![CDATA[<p>三道USACO的题目</p>
<table>
<thead>
<tr>
<th style="text-align:center">题目名</th>
<th style="text-align:center">护花</th>
<th style="text-align:center">修建草坪</th>
<th style="text-align:center">虫洞</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">源文件</td>
<td style="text-align:center">flower.cpp/c/pas</td>
<td style="text-align:center">mowlawn.cpp/c/pas</td>
<td style="text-align:center">wormhole.cpp/c/pas</td>
</tr>
<tr>
<td style="text-align:center">输入文件</td>
<td style="text-align:center">flower.in</td>
<td style="text-align:center">mowlawn.in</td>
<td style="text-align:center">wormhole.in</td>
</tr>
<tr>
<td style="text-align:center">输出文件</td>
<td style="text-align:center">flower.out</td>
<td style="text-align:center">mowlawn.out</td>
<td style="text-align:center">Wormhole.out</td>
</tr>
<tr>
<td style="text-align:center">时间限制</td>
<td style="text-align:center">1000MS</td>
<td style="text-align:center">1000MS</td>
<td style="text-align:center">1000MS</td>
</tr>
<tr>
<td style="text-align:center">内存限制</td>
<td style="text-align:center">256MB</td>
<td style="text-align:center">256MB</td>
<td style="text-align:center">256MB</td>
</tr>
<tr>
<td style="text-align:center">测试点</td>
<td style="text-align:center">10</td>
<td style="text-align:center">10</td>
<td style="text-align:center">10</td>
</tr>
<tr>
<td style="text-align:center">测试点分值</td>
<td style="text-align:center">10</td>
<td style="text-align:center">10</td>
<td style="text-align:center">10</td>
</tr>
</tbody>
</table>
<h1 id="P1-护花"><a href="#P1-护花" class="headerlink" title="P1 护花"></a>P1 护花</h1><p>约翰留下他的N(N&lt;=100000)只奶牛上山采木．他离开的时候，她们像往常一样悠闲地在草场里吃草．可是，当他回来的时候，他看到了一幕惨剧：牛们正躲在他的花园里，啃食着他心爱的美丽花朵！为了使接下来花朵的损失最小，约翰赶紧采取行动，把牛们送回牛棚． 牛们从1到N编号．第i只牛所在的位置距离牛棚Ti(1≤Ti≤2000000)分钟的路程，而在约翰开始送她回牛棚之前，她每分钟会啃食Di(1≤Di≤100)朵鲜花．无论多么努力，约翰一次只能送一只牛回棚．而运送第第i只牛事实上需要2Ti分钟，因为来回都需要时间．<br>写一个程序来决定约翰运送奶牛的顺序，使最终被吞食的花朵数量最小．<br><a id="more"></a></p>
<h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p>第1行输入N，之后N行每行输入两个整数Ti和Di</p>
<h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p>一个整数，表示最小数量的花朵被吞食</p>
<h2 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>6<br>3 1<br>2 5<br>2 3<br>3 2<br>4 1<br>1 6</p>
</blockquote>
<h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>86</p>
</blockquote>
<h2 id="提示​"><a href="#提示​" class="headerlink" title="提示​"></a>提示​</h2><p>约翰用6，2，3，4，1，5的顺序来运送他的奶牛 </p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>贪心：考虑牛i和j，如果满足：$$2\times d[i]\cdot t[j]&gt;2\times d[j]\cdot t[i]$$，那么先搬走牛i<br>按这个二元关系qsort就好了。</p>
<dir style="text-align:right"><a href="/2016/09/03/NOIP模拟赛-2014-5-24/flower.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>flower.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    a:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">100010</span>,<span class="number">0</span>..<span class="number">1</span>] <span class="keyword">of</span> qword; <span class="comment">//0:t;1:d</span></div><div class="line">    n,i:int;ans,sum:qword;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">com</span><span class="params">(i,j:int)</span>:</span>boolean;</div><div class="line"><span class="keyword">begin</span> com:=a[j,<span class="number">0</span>]*a[i,<span class="number">1</span>]&gt;a[i,<span class="number">0</span>]*a[j,<span class="number">1</span>] <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">swap</span><span class="params">(<span class="keyword">var</span> a,b:qword)</span>;</span></div><div class="line"><span class="keyword">var</span> tmp:int;</div><div class="line"><span class="keyword">begin</span> tmp:=a;a:=b;b:=tmp <span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">qsort</span><span class="params">(b,e:int)</span>;</span></div><div class="line"><span class="keyword">var</span> i,j:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    i:=b;j:=e;a[<span class="number">0</span>]:=a[random(e-b)+b];</div><div class="line">    <span class="keyword">repeat</span></div><div class="line">        <span class="keyword">while</span> com(i,<span class="number">0</span>) <span class="keyword">do</span> inc(i);</div><div class="line">        <span class="keyword">while</span> com(<span class="number">0</span>,j) <span class="keyword">do</span> dec(j);</div><div class="line">        <span class="keyword">if</span> i&lt;=j <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">            swap(a[i,<span class="number">0</span>],a[j,<span class="number">0</span>]);swap(a[i,<span class="number">1</span>],a[j,<span class="number">1</span>]);</div><div class="line">            inc(i);dec(j);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">until</span> i&gt;j;</div><div class="line">    <span class="keyword">if</span> i&lt;e <span class="keyword">then</span> qsort(i,e);</div><div class="line">    <span class="keyword">if</span> b&lt;j <span class="keyword">then</span> qsort(b,j);</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'flower.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'flower.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        <span class="keyword">read</span>(a[i,<span class="number">0</span>],a[i,<span class="number">1</span>]);</div><div class="line">        a[i,<span class="number">0</span>]:=a[i,<span class="number">0</span>]*<span class="number">2</span>;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    qsort(<span class="number">1</span>,n);</div><div class="line">    sum:=<span class="number">0</span>;ans:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> sum:=sum+a[i,<span class="number">1</span>];</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        sum:=sum-a[i,<span class="number">1</span>];</div><div class="line">        ans:=ans+sum*a[i,<span class="number">0</span>];</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">write</span>(ans);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
<h1 id="P2-修剪草坪"><a href="#P2-修剪草坪" class="headerlink" title="P2 修剪草坪"></a>P2 修剪草坪</h1><p>在一年前赢得了小镇的最佳草坪比赛后，FJ变得很懒，再也没有修剪过草坪。现在，新一轮的最佳草坪比赛又开始了，FJ希望能够再次夺冠。<br>然而，FJ的草坪非常脏乱，因此，FJ只能够让他的奶牛来完成这项工作。FJ有N<br>(1 &lt;= N &lt;= 100,000)只排成一排的奶牛，编号为1…N。每只奶牛的效率是不同的，奶牛i的效率为E_i(0 &lt;= E_i &lt;= 1,000,000,000)。<br>靠近的奶牛们很熟悉，因此，如果FJ安排超过K（1&lt;=K&lt;=N）只连续的奶牛，那么，这些奶牛就会罢工去开派对:)。<br>因此，现在FJ需要你的帮助，计算FJ可以得到的最大效率，并且该方案中没有连续的超过K只奶牛。</p>
<h2 id="格式-1"><a href="#格式-1" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式-1"><a href="#输入格式-1" class="headerlink" title="输入格式"></a>输入格式</h3><ul>
<li>第一行：空格隔开的两个整数N和K</li>
<li>第二到N+1行：第i+1行有一个整数E_i</li>
</ul>
<h3 id="输出格式-1"><a href="#输出格式-1" class="headerlink" title="输出格式"></a>输出格式</h3><ul>
<li>第一行：一个值，表示FJ可以得到的最大的效率值。<!--more-->
</li>
</ul>
<h2 id="样例-1"><a href="#样例-1" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入-1"><a href="#样例输入-1" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>5 2<br>1<br>2<br>3<br>4<br>5</p>
</blockquote>
<h3 id="样例输出-1"><a href="#样例输出-1" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>86</p>
</blockquote>
<h2 id="提示​-1"><a href="#提示​-1" class="headerlink" title="提示​"></a>提示​</h2><p>输入解释：<br>FJ有5只奶牛，他们的效率为1，2，3，4，5。他们希望选取效率总和最大的奶牛，但是他不能选取超过2只连续的奶牛<br>【样例输出】<br>12<br>FJ可以选择出了第三只以外的其他奶牛，总的效率为1+2+4+5=12。</p>
<h2 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h2><p><strong>划分dp</strong>很容易想：<br>f[i]前i头牛的最大值，sum[i]前缀和<br><span>$f[i]=max\{ f[j-1]+sum[i]-sum[j] \ \ |\ \ i-j\leq m\}$</span><!-- Has MathJax --></p>
<p>注意预处理i=1..m的$f[i]=sum[i]$<br>复杂度$O(N^2)$，n有些大，我们变形：<br><span>$f[i]=max\{f[j-1]-sum[j]\}+sum[i]$</span><!-- Has MathJax --></p>
<p>这样用递减的<strong>单调队列</strong>维护值对$(i,f[i-1]-sum[i])$即可</p>
<dir style="text-align:right"><a href="/2016/09/03/NOIP模拟赛-2014-5-24/mowlawn.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>mowlawn.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> int=longint;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    n,m,i,h,t:int;</div><div class="line">    a,sum,f:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">100010</span>] <span class="keyword">of</span> int64;</div><div class="line">    q:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">200010</span>,<span class="number">0</span>..<span class="number">1</span>] <span class="keyword">of</span> int64;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">push</span><span class="params">(i,x:int64)</span>;</span></div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">while</span> (h&lt;=t) <span class="keyword">and</span> (q[t,<span class="number">1</span>]&lt;=x) <span class="keyword">do</span> dec(t);</div><div class="line">    inc(t);q[t,<span class="number">0</span>]:=i;q[t,<span class="number">1</span>]:=x;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">pop</span><span class="params">(i:int64)</span>;</span></div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="keyword">while</span> (h&lt;=t) <span class="keyword">and</span> (i-q[h,<span class="number">0</span>]&gt;m) <span class="keyword">do</span> inc(h);</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'mowlawn.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'mowlawn.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(n,m);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">read</span>(a[i]);</div><div class="line">    sum[<span class="number">0</span>]:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> sum[i]:=sum[i-<span class="number">1</span>]+a[i];</div><div class="line">    h:=<span class="number">1</span>;t:=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> m <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        f[i]:=sum[i];</div><div class="line">        push(i,f[i-<span class="number">1</span>]-sum[i]);</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="comment">//f[i]:=max&#123;f[j-1]-sum[j]&#125;+sum[i]</span></div><div class="line">    <span class="keyword">for</span> i:=m+<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        push(i,f[i-<span class="number">1</span>]-sum[i]);</div><div class="line">        pop(i);</div><div class="line">        f[i]:=q[h,<span class="number">1</span>]+sum[i];</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    <span class="keyword">write</span>(f[i]);</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
<h1 id="P3-虫洞"><a href="#P3-虫洞" class="headerlink" title="P3 虫洞"></a>P3 虫洞</h1><p>John在他的农场中闲逛时发现了许多虫洞。虫洞可以看作一条十分奇特的有向边，并可以使你返回到过去的一个时刻（相对你进入虫洞之前）。John的每个农场有M条小路（无向边）连接着N （从1..N标号）块地，并有W个虫洞（有向边）。其中1&lt;=N&lt;=500,1&lt;=M&lt;=2500,1&lt;=W&lt;=200。 现在John想借助这些虫洞来回到过去（出发时刻之前），请你告诉他能办到吗。 John将向你提供F(1&lt;=F&lt;=5)个农场的地图。没有小路会耗费你超过10000秒的时间，当然也没有虫洞回帮你回到超过10000秒以前。</p>
<h2 id="格式-2"><a href="#格式-2" class="headerlink" title="格式"></a>格式</h2><h3 id="输入格式-2"><a href="#输入格式-2" class="headerlink" title="输入格式"></a>输入格式</h3><ul>
<li>Line 1: 一个整数 F, 表示农场个数。</li>
<li>Line 1 of each farm: 三个整数 N, M, W。</li>
<li>Lines 2..M+1 of each farm: 三个数（S, E, T）。表示在标号为S的地与标号为E的地中间有一条用时T秒的小路。</li>
<li>Lines M+2..M+W+1 of each farm: 三个数（S, E, T）。表示在标号为S的地与标号为E的地中间有一条可以使John到达T秒前的虫洞。</li>
</ul>
<h3 id="输出格式-2"><a href="#输出格式-2" class="headerlink" title="输出格式"></a>输出格式</h3><ul>
<li>Lines 1..F: 如果John能在这个农场实现他的目标，输出”YES”,否则输出”NO”。<!--more-->
</li>
</ul>
<h2 id="样例-2"><a href="#样例-2" class="headerlink" title="样例"></a>样例</h2><h3 id="样例输入-2"><a href="#样例输入-2" class="headerlink" title="样例输入"></a>样例输入</h3><blockquote>
<p>2<br>3 3 1<br>1 2 2<br>1 3 4<br>2 3 1<br>3 1 3<br>3 2 1<br>1 2 3<br>2 3 4<br>3 1 8</p>
</blockquote>
<h3 id="样例输出-2"><a href="#样例输出-2" class="headerlink" title="样例输出"></a>样例输出</h3><blockquote>
<p>NO<br>YES</p>
</blockquote>
<h2 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h2><p>spfa判个负环就可以了，注意审题，小路是无向边。</p>
<dir style="text-align:right"><a href="/2016/09/03/NOIP模拟赛-2014-5-24/wormhole.pas" title="复制代码">复制代码</a></dir>

<figure class="highlight delphi"><figcaption><span>wormhole.pas</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> </div><div class="line">    int=longint;</div><div class="line">    edge=<span class="keyword">record</span> t,w,next:int <span class="keyword">end</span>;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    g:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">6010</span>] <span class="keyword">of</span> edge;</div><div class="line">    head:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">510</span>] <span class="keyword">of</span> int;</div><div class="line">    n,m,k,t,i,f0,t0,w0:int;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">procedure</span> <span class="title">add</span><span class="params">(f,t,w:int)</span>;</span></div><div class="line"><span class="keyword">var</span> m:int;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    inc(head[<span class="number">0</span>]);m:=head[<span class="number">0</span>];</div><div class="line">    g[m].t:=t;g[m].w:=w;</div><div class="line">    g[m].next:=head[f];head[f]:=m;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">spfa</span><span class="params">()</span>:</span>boolean;</div><div class="line"><span class="keyword">var</span> </div><div class="line">    i,v,u,h,t:int;</div><div class="line">    cnt,q,d:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">510</span>] <span class="keyword">of</span> int;</div><div class="line">    inq:<span class="keyword">array</span>[<span class="number">0</span>..<span class="number">510</span>] <span class="keyword">of</span> boolean;</div><div class="line"><span class="keyword">begin</span></div><div class="line">    fillchar(d,sizeof(d),<span class="number">0</span>);</div><div class="line">    filldword(cnt,sizeof(cnt) <span class="keyword">div</span> <span class="number">4</span>,<span class="number">1</span>);</div><div class="line">    fillchar(inq,sizeof(inq),true);</div><div class="line">    <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> n <span class="keyword">do</span> q[i]:=i;</div><div class="line">    h:=<span class="number">1</span>;t:=n+<span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> h&lt;&gt;t <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">        v:=q[h];</div><div class="line">        i:=head[v];</div><div class="line">        <span class="keyword">while</span> i&lt;&gt;<span class="number">0</span> <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">            u:=g[i].t;</div><div class="line">            <span class="keyword">if</span> d[u]&gt;d[v]+g[i].w <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">                d[u]:=d[v]+g[i].w;</div><div class="line">                <span class="keyword">if</span> <span class="keyword">not</span> inq[u] <span class="keyword">then</span> <span class="keyword">begin</span></div><div class="line">                    inc(cnt[u]);</div><div class="line">                    <span class="keyword">if</span> cnt[u]&gt;n <span class="keyword">then</span> <span class="keyword">exit</span>(true);</div><div class="line">                    q[t]:=u;inq[u]:=true;</div><div class="line">                    inc(t);<span class="keyword">if</span> t&gt;<span class="number">510</span> <span class="keyword">then</span> t:=<span class="number">0</span>;</div><div class="line">                <span class="keyword">end</span>;</div><div class="line">            <span class="keyword">end</span>;</div><div class="line">            i:=g[i].next;</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">        inc(h);<span class="keyword">if</span> h&gt;<span class="number">510</span> <span class="keyword">then</span> h:=<span class="number">0</span>;</div><div class="line">        inq[v]:=false;</div><div class="line">    <span class="keyword">end</span>;</div><div class="line">    spfa:=false;</div><div class="line"><span class="keyword">end</span>;</div><div class="line"></div><div class="line"><span class="keyword">begin</span></div><div class="line">    assign(input,<span class="string">'wormhole.in'</span>);reset(input);</div><div class="line">    assign(output,<span class="string">'wormhole.out'</span>);rewrite(output);</div><div class="line">    <span class="keyword">read</span>(t);</div><div class="line">    <span class="keyword">repeat</span></div><div class="line">        fillchar(head,sizeof(head),<span class="number">0</span>);</div><div class="line">        <span class="keyword">read</span>(n,m,k);</div><div class="line">        <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> m <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">            <span class="keyword">read</span>(f0,t0,w0);</div><div class="line">            add(f0,t0,w0);add(t0,f0,w0);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">        <span class="keyword">for</span> i:=<span class="number">1</span> <span class="keyword">to</span> k <span class="keyword">do</span> <span class="keyword">begin</span></div><div class="line">            <span class="keyword">read</span>(f0,t0,w0);add(f0,t0,-w0);</div><div class="line">        <span class="keyword">end</span>;</div><div class="line">        <span class="keyword">if</span> spfa <span class="keyword">then</span> writeln(<span class="string">'YES'</span>) <span class="keyword">else</span> writeln(<span class="string">'NO'</span>);</div><div class="line">        dec(t);</div><div class="line">    <span class="keyword">until</span> t=<span class="number">0</span>;</div><div class="line">    close(input);close(output);</div><div class="line"><span class="keyword">end</span>.</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;三道USACO的题目&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:center&quot;&gt;题目名&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;护花&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;修建草坪&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;虫洞&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;源文件&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;flower.cpp/c/pas&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;mowlawn.cpp/c/pas&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;wormhole.cpp/c/pas&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;输入文件&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;flower.in&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;mowlawn.in&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;wormhole.in&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;输出文件&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;flower.out&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;mowlawn.out&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;Wormhole.out&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;时间限制&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;1000MS&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;1000MS&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;1000MS&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;内存限制&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;256MB&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;256MB&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;256MB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;测试点&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;10&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;10&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;10&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;测试点分值&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;10&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;10&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;10&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&quot;P1-护花&quot;&gt;&lt;a href=&quot;#P1-护花&quot; class=&quot;headerlink&quot; title=&quot;P1 护花&quot;&gt;&lt;/a&gt;P1 护花&lt;/h1&gt;&lt;p&gt;约翰留下他的N(N&amp;lt;=100000)只奶牛上山采木．他离开的时候，她们像往常一样悠闲地在草场里吃草．可是，当他回来的时候，他看到了一幕惨剧：牛们正躲在他的花园里，啃食着他心爱的美丽花朵！为了使接下来花朵的损失最小，约翰赶紧采取行动，把牛们送回牛棚． 牛们从1到N编号．第i只牛所在的位置距离牛棚Ti(1≤Ti≤2000000)分钟的路程，而在约翰开始送她回牛棚之前，她每分钟会啃食Di(1≤Di≤100)朵鲜花．无论多么努力，约翰一次只能送一只牛回棚．而运送第第i只牛事实上需要2Ti分钟，因为来回都需要时间．&lt;br&gt;写一个程序来决定约翰运送奶牛的顺序，使最终被吞食的花朵数量最小．&lt;br&gt;
    
    </summary>
    
      <category term="Problem Set" scheme="https://cothrax.github.io/categories/Problem-Set/"/>
    
    
      <category term="OI" scheme="https://cothrax.github.io/tags/OI/"/>
    
      <category term="数据结构" scheme="https://cothrax.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="DP" scheme="https://cothrax.github.io/tags/DP/"/>
    
      <category term="单调队列" scheme="https://cothrax.github.io/tags/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/"/>
    
      <category term="图论" scheme="https://cothrax.github.io/tags/%E5%9B%BE%E8%AE%BA/"/>
    
      <category term="贪心" scheme="https://cothrax.github.io/tags/%E8%B4%AA%E5%BF%83/"/>
    
      <category term="负环" scheme="https://cothrax.github.io/tags/%E8%B4%9F%E7%8E%AF/"/>
    
  </entry>
  
</feed>
